if(window.convertflow==undefined){(function(){function defineApp(){window.convertflow={};var app={actions:{},admin:{},campaigns:{},cart:{},ctas:{},api:{ctas:{},areas:{}},elements:{},fields:{},field_options:{},helpers:{},sections:{},steps:{},variants:{},visitors:{},website:{id:38306,data:{"currency":"USD","terms-link":"https://www.theiia.org/en/terms-of-service/","sms-consent":"By checking this box, you agree to receive recurring automated promotional and personalized marketing text messages (e.g. cart reminders) from {BRAND} at the cell number used when signing up. Consent is not a condition of any purchase. Reply HELP for help and STOP to cancel. Msg frequency varies. Msg \u0026 data rates may apply.","privacy-link":"https://www.theiia.org/en/Privacy-Policy/","business_type":"ecommerce","form-tracking":"true","ip-geolocation":"true","last_published":"2022-10-19 20:01:22 +0000","default-country":"US","privacy-message":"Accept privacy policy and terms of service","terms-link-text":"Terms of Service","brand_color_dark":"#006198","traffic_estimate":"100,000 - 250,000","brand_color_light":"#00abe6","marketing-consent":"Yes, I'd like to receive email communications","privacy-link-text":"Privacy Policy","url-identification":"true","brand_color_vibrant":"#9aca3c","brand_font_headline":"inherit","brand_font_paragraph":"inherit","cart-value-threshold":"50","google-analytics-track":"true","past_free_visitor_limit":"true","google-analytics-category":"ConvertFlow","google-analytics-data-layer":"false","google-analytics-tracking-id":"","google-analytics-cross-domain":"false","google-analytics-data-layer-variable":""},brand:"The IIA",privacy_message:"Accept privacy policy and terms of service",privacy_link:"https://www.theiia.org/en/Privacy-Policy/",privacy_link_text:"Privacy Policy",terms_link:"https://www.theiia.org/en/terms-of-service/",terms_link_text:"Terms of Service",marketing_consent:"Yes, I&#39;d like to receive email communications",sms_consent:"By checking this box, you agree to receive recurring automated promotional and personalized marketing text messages (e.g. cart reminders) from {BRAND} at the cell number used when signing up. Consent is not a condition of any purchase. Reply HELP for help and STOP to cancel. Msg frequency varies. Msg &amp; data rates may apply.",form_tracking:"true",url_identification:"true",brand_style:{'brand_color_dark':"#006198",'brand_color_light':"#00abe6",'brand_color_vibrant':"#9aca3c"},profiles:{},powered_by:false,currency_character:"$",actions:{},conditions:{},broadcasts:{},ctas:{},integrations:{},conditions_groups:{}}}
app.visitors.uid_cookie='cf_'+app.website.id+'_id';app.visitors.expiration_cookie='cf_'+app.website.id+'_person_time';app.visitors.localstorage_prevent='cf_'+app.website.id+'_person_storage_prevent';app.visitors.localstorage_last_update='cf_'+app.website.id+'_person_last_update';app.visitors.enrichment_status={};app.visitors.targeting_sync_status={};app.local_person='cf_'+app.website.id+'_person';app.interface_root="https://app.convertflow.com/websites/"+app.website.id+"/";app.api_root="https://app.convertflow.co/websites/"+app.website.id+"/";app.api_contacts_validate='https://convertflow.co/email-validation/';app.api_contacts=app.api_root+'contacts/create';app.api_events=app.api_root+'events/create';app.api_visitors=app.api_root+'visitors/';app.powered_by_link="https://www.convertflow.com/?utm_source=poweredby&utm_medium=cf_referral&utm_campaign=default&utm_term=The%20IIA";app.geotargeting=false;app.timed=(app.interface_root.indexOf('localhost')>-1||location.search.indexOf('cfTime=true'))>-1;app.services=["activecampaign","attentive","autopilot","aweber","campaignmonitor","convertkit","customerio","drip","getresponse","googletagmanager","intercom","hubspot","infusionsoft","klaviyo","leadsquared","mailchimp","ontraport","postscript","segment","sendinblue","shopify","tatango","wordpress"];app.live=(window.location.search.indexOf('iframe=true&variant=')==-1);app.use_cdn=true;if((app.live==true&&app.use_cdn==true)||(""=='true'&&app.website.id!==0)){app.assets_root='https://js.convertflow.co/production/websites/'+app.website.id+'/';}else{app.assets_root=app.interface_root;}
var website=app.website;var cta={"id":117577,"name":"IC Registration","options":{"published_at":"2022-07-16T00:45:36+00:00"},"cta_type":"overlay"};website.ctas[117577]=cta;var cta={"id":119008,"name":"2022 IIA Canada National Conference","options":{"published_at":"2022-04-27T14:18:48+00:00"},"cta_type":"overlay"};website.ctas[119008]=cta;var cta={"id":119016,"name":"Conf√©rence nationale 2022 de l'IAI Canada","options":{"published_at":"2022-04-27T14:20:39+00:00"},"cta_type":"overlay"};website.ctas[119016]=cta;var cta={"id":119212,"name":"In-Person Seminars","options":{"published_at":"2022-05-11T01:52:00+00:00"},"cta_type":"overlay"};website.ctas[119212]=cta;var cta={"id":121381,"name":"Executive Membership","options":{"published_at":"2022-06-02T16:01:45+00:00"},"cta_type":"overlay"};website.ctas[121381]=cta;var cta={"id":122940,"name":"event","options":{"published_at":"2022-06-23T19:08:24+00:00"},"cta_type":"page"};website.ctas[122940]=cta;var cta={"id":123126,"name":"IC Promo (Virtual Offer)","options":{"published_at":"2022-06-30T02:09:39+00:00"},"cta_type":"overlay"};website.ctas[123126]=cta;var cta={"id":123797,"name":"25% Off Seminar Promotions","options":{"published_at":"2022-09-08T13:37:21+00:00"},"cta_type":"overlay"};website.ctas[123797]=cta;var cta={"id":124894,"name":"Vision University","options":{"published_at":"2022-07-25T14:37:46+00:00"},"cta_type":"overlay"};website.ctas[124894]=cta;var cta={"id":125377,"name":"2022 ESG Virtual Conference","options":{"published_at":"2022-08-01T19:28:44+00:00"},"cta_type":"overlay"};website.ctas[125377]=cta;var cta={"id":125466,"name":"2022 Financial Services Exchange","options":{"published_at":"2022-08-03T14:30:45+00:00"},"cta_type":"overlay"};website.ctas[125466]=cta;var cta={"id":128398,"name":"2022 Ignite","options":{"published_at":"2022-09-13T18:16:06+00:00"},"cta_type":"overlay"};website.ctas[128398]=cta;var cta={"id":129546,"name":"HurricaneIan","options":{"published_at":"2022-09-27T12:48:05+00:00"},"cta_type":"overlay"};website.ctas[129546]=cta;var cta={"id":129552,"name":"Hurricane Ian V02","options":{"published_at":"2022-09-27T14:00:45+00:00"},"cta_type":"bar"};website.ctas[129552]=cta;var conditions_group={"id":1734,"name":"United States - Location","website_id":38306,"created_at":"2022-04-25T15:48:15.431Z","updated_at":"2022-04-25T15:48:54.150Z"};conditions_group.conditions={};website.conditions_groups[1734]=conditions_group;var broadcast={"id":72743,"name":"Executive Membership","quick":true,"timezone":null,"range_start":null,"range_end":null,"timeframe":false};broadcast.conditions={};broadcast.ctas=[121381];broadcast.conditions[345974]={"condition_type":"If page is","url":"https://www.theiia.org/en/resources/knowledge-centers/executive/","tag_id":null,"keyword":null,"count":0,"data_name":null,"area_id":null,"cta_id":null,"data":null,"operator":"or","condition_cta":0,"country":null};website.broadcasts[72743]=broadcast;var broadcast={"id":74394,"name":"25% Off Seminar Promotions","quick":true,"timezone":null,"range_start":null,"range_end":null,"timeframe":false};broadcast.conditions={};broadcast.ctas=[123797];broadcast.conditions[354291]={"condition_type":"If page is","url":"https://www.theiia.org/en/promotions/learning/learning-locations/","tag_id":null,"keyword":null,"count":0,"data_name":null,"area_id":null,"cta_id":null,"data":null,"operator":"or","condition_cta":0,"country":null};broadcast.conditions[352691]={"condition_type":"If URL contains","url":null,"tag_id":null,"keyword":"/products/learning-solutions/course/","count":0,"data_name":null,"area_id":null,"cta_id":null,"data":null,"operator":"or","condition_cta":0,"country":null};broadcast.conditions[352690]={"condition_type":"If page is","url":"https://www.theiia.org/en/learning/in-person/seminars/","tag_id":null,"keyword":null,"count":0,"data_name":null,"area_id":null,"cta_id":null,"data":null,"operator":"or","condition_cta":0,"country":null};broadcast.conditions[352689]={"condition_type":"If page is","url":"https://www.theiia.org/en/learning/online/","tag_id":null,"keyword":null,"count":0,"data_name":null,"area_id":null,"cta_id":null,"data":null,"operator":"or","condition_cta":0,"country":null};website.broadcasts[74394]=broadcast;var broadcast={"id":75049,"name":"2022 ESG Virtual Conference","quick":true,"timezone":null,"range_start":null,"range_end":null,"timeframe":false};broadcast.conditions={};broadcast.ctas=[125377];broadcast.conditions[355450]={"condition_type":"If page is","url":"https://www.theiia.org/en/content/articles/global-knowledge-brief/2022/march/global-knowledge-brief-the-esg-risk-landscape-part-3-evaluating-esg-risk/","tag_id":null,"keyword":null,"count":0,"data_name":null,"area_id":null,"cta_id":null,"data":null,"operator":"or","condition_cta":0,"country":null};broadcast.conditions[355449]={"condition_type":"If page is","url":"https://www.theiia.org/en/content/articles/global-knowledge-brief/2022/february/the-esg-landscape-part-1/","tag_id":null,"keyword":null,"count":0,"data_name":null,"area_id":null,"cta_id":null,"data":null,"operator":"or","condition_cta":0,"country":null};broadcast.conditions[355448]={"condition_type":"If page is","url":"https://www.theiia.org/en/content/articles/global-knowledge-brief/2020/july/board-engagement-on-esg/","tag_id":null,"keyword":null,"count":0,"data_name":null,"area_id":null,"cta_id":null,"data":null,"operator":"or","condition_cta":0,"country":null};broadcast.conditions[355447]={"condition_type":"If page is","url":"https://www.theiia.org/en/resources/topics/risk/","tag_id":null,"keyword":null,"count":0,"data_name":null,"area_id":null,"cta_id":null,"data":null,"operator":"or","condition_cta":0,"country":null};broadcast.conditions[355446]={"condition_type":"If page is","url":"https://www.theiia.org/en/resources/knowledge-centers/environmental-social-and-governance/","tag_id":null,"keyword":null,"count":0,"data_name":null,"area_id":null,"cta_id":null,"data":null,"operator":"or","condition_cta":0,"country":null};website.broadcasts[75049]=broadcast;var broadcast={"id":76689,"name":"2022 Ignite","quick":true,"timezone":null,"range_start":null,"range_end":null,"timeframe":false};broadcast.conditions={};broadcast.ctas=[128398];broadcast.conditions[365488]={"condition_type":"If page is","url":"https://www.theiia.org/en/about-us/advocacy/promoting-the-profession/emerging-leaders-mentoring-program/","tag_id":null,"keyword":null,"count":0,"data_name":null,"area_id":null,"cta_id":null,"data":null,"operator":"or","condition_cta":0,"country":null};broadcast.conditions[365487]={"condition_type":"If page is","url":"https://internalauditor.theiia.org/en/articles/2021/october/emerging-leaders-2021/","tag_id":null,"keyword":null,"count":0,"data_name":null,"area_id":null,"cta_id":null,"data":null,"operator":"or","condition_cta":0,"country":null};broadcast.conditions[365486]={"condition_type":"If page is","url":"https://www.theiia.org/en/about-us/advocacy/promoting-the-profession/emerging-leaders/","tag_id":null,"keyword":null,"count":0,"data_name":null,"area_id":null,"cta_id":null,"data":null,"operator":"or","condition_cta":0,"country":null};broadcast.conditions[365485]={"condition_type":"If page is","url":"https://www.theiia.org/en/learning/conferences/","tag_id":null,"keyword":null,"count":0,"data_name":null,"area_id":null,"cta_id":null,"data":null,"operator":"or","condition_cta":0,"country":null};website.broadcasts[76689]=broadcast;app.website=website;return app;}
var app=defineApp();app.actions.mapEventToActions=function(event){var eventTypes={'Complete':['element_id'],'Completion':['broadcast_id']}
var foreign_keys=eventTypes[event.event_type];if(foreign_keys){foreign_keys.forEach(function(foreign_key){if(event[foreign_key]){var contactable_type=foreign_key.replace('_id','');var actions=$cf.map(app.website.actions,function(action){if(action.contactable_type.toLowerCase()==contactable_type&&action.contactable_id==event[foreign_key])return action});actions.forEach(function(action){app.actions.run(action,event);});}})}}
app.actions.run=function(action,event){var integration_type;if(action.action_type.indexOf(' - ')>0){var integration_type=action.action_type.split(' - ')[0];}
if(!integration_type){if(action.action_type=='Add a tag'){convertflow.person.data.tags=convertflow.person.data.tags||[];if(!convertflow.person.data.tags.includes(action.tag_id)){convertflow.person.data.tags.push(action.tag_id);}
app.helpers.compressAndStore(app.local_person,convertflow.person);}
if(action.action_type=='Remove a tag'){convertflow.person.data.tags=convertflow.person.data.tags||[];if(convertflow.person.data.tags&&convertflow.person.data.tags.includes(action.tag_id)){var tag_index=convertflow.person.data.tags.indexOf(action.tag_id);if(tag_index>-1){convertflow.person.data.tags.splice(tag_index,1);}}
app.helpers.compressAndStore(app.local_person,convertflow.person);}
if(action.action_type=='Update custom field'&&action.data){var custom_field=action.data['field'];var value=action.data['value'];if(custom_field&&value){convertflow.person.extra=convertflow.person.extra||{};convertflow.person.extra[custom_field]=value;app.helpers.compressAndStore(app.local_person,convertflow.person);$cf('span[data-merge="'+custom_field+'"]').text(value);}}
if(action.action_type=='Update score'&&action.data){var custom_field=action.data['field'];var value=action.data['number']&&app.helpers.isNumeric(action.data['number'])?parseInt(action.data['number']):action.data['number'];if(custom_field&&custom_field!=='CURRENT_SCORE'&&value!==undefined){convertflow.person.extra=convertflow.person.extra||{};convertflow.person.extra[custom_field]=value;app.helpers.compressAndStore(app.local_person,convertflow.person);$cf('span[data-merge="'+custom_field+'"]').text(value);}
if(custom_field=='CURRENT_SCORE'&&value!==undefined){var cta=convertflow.ctas[event.contactable_id];var variant;if(cta){variant=cta.variants[event.variant_id];variant.score=value;$cf("div[data-cta-id='"+cta.id+"']").find('span[data-merge="CURRENT_SCORE"]').text(value);}}}
if((action.action_type=='Add to score'||action.action_type=='Subtract from score')&&action.data){var custom_field=action.data['field'];var value=action.data['number']&&app.helpers.isNumeric(action.data['number'])?parseInt(action.data['number']):undefined;if(custom_field&&custom_field!=='CURRENT_SCORE'&&value!==undefined){convertflow.person.extra=convertflow.person.extra||{};var current_value=convertflow.person.extra[custom_field];var isNumeric=current_value!==undefined?app.helpers.isNumeric(current_value):false;if(current_value&&isNumeric==true){if(action.action_type=='Add to score'){convertflow.person.extra[custom_field]=parseInt(convertflow.person.extra[custom_field])+value;}else if(action.action_type=='Subtract from score'){convertflow.person.extra[custom_field]=parseInt(convertflow.person.extra[custom_field])-value;}}else if(!current_value||isNumeric==false){convertflow.person.extra[custom_field]=value;}
app.helpers.compressAndStore(app.local_person,convertflow.person);$cf('span[data-merge="'+custom_field+'"]').text(convertflow.person.extra[custom_field]);}
if(custom_field=='CURRENT_SCORE'&&value!==undefined){var cta=convertflow.ctas[event.contactable_id];var variant;if(cta){variant=cta.variants[event.variant_id];variant.score=variant.score||0;if(action.action_type=='Add to score'){variant.score=variant.score+value;}else if(action.action_type=='Subtract from score'){variant.score=variant.score-value;}
$cf("div[data-cta-id='"+cta.id+"']").find('span[data-merge="CURRENT_SCORE"]').text(variant.score);}}}}
if(integration_type){var integration=$cf.map(app.website.integrations,function(integration){if(integration.integration_type==integration_type)return integration})[0];if(integration){if(integration.action_types&&integration.action_types.length>0){const actionType=integration.action_types.filter((actionType)=>actionType.action_type==action.action_type)[0];if(actionType&&actionType.settings){actionType.settings.filter((setting)=>setting.localstorage).forEach((setting)=>{const array_name=setting.options_source;const value=action.data[setting.attribute];const targeting_data_key=integration_type.toLowerCase();const targeting_data=convertflow.person.data[targeting_data_key]||{};targeting_data[array_name]=targeting_data[array_name]||[];const existingItem=targeting_data[array_name].filter((item)=>item['id']==value+'')[0]
if(setting.localstorage=='add'&&!existingItem){const newItem={id:value};targeting_data[array_name].push(newItem);}else if(setting.localstorage=='remove'&&existingItem){targeting_data[array_name]=targeting_data[array_name].filter((item)=>item['id']!=value+'');}
convertflow.person.data[targeting_data_key]=targeting_data;app.helpers.compressAndStore(app.local_person,convertflow.person);})}}
if(action.action_type.indexOf('Shopify')>-1){function updateCart(){$cf.get("/cart.js",function(data){app.visitors.updateShopifyCart(data);});}
if(action.action_type=='Shopify - Add to cart'){if(typeof window.Shopify=='object'){setTimeout(function(){try{jQuery.post('/cart/add.js',{items:[{quantity:1,id:action.data['variant_id']}]},function(){updateCart();});}catch(err){console.log(err);}},200);}else if(integration.cms_url){setTimeout(function(){window.location.href=integration.cms_url+"/cart/add?id="+action.data['variant_id'];},100);}}
if(action.action_type=='Shopify - Remove from cart'){if(typeof window.Shopify=='object'){setTimeout(function(){try{jQuery.post('/cart/change.js',{quantity:0,id:action.data['variant_id']},function(){updateCart();});}catch(err){console.log(err);}},200);}else if(integration.cms_url){setTimeout(function(){window.location.href=integration.cms_url+"/cart/change?id="+action.data['variant_id']+"&quantity=0";},100);}}
if(action.action_type=='Shopify - Clear cart'){if(typeof window.Shopify=='object'){setTimeout(function(){try{jQuery.post('/cart/clear.js',{},function(){updateCart();});}catch(err){console.log(err);}},200);}else if(integration.cms_url){setTimeout(function(){window.location.href=integration.cms_url+"/cart/clear";},100);}}}
if(action.action_type.indexOf('Intercom')>-1){if(action.action_type=='Intercom - Trigger messenger'){if(typeof window.Intercom=='function'){Intercom('showNewMessage');}}}}}};app.campaigns.initialize=function(website,admin_widget){if(app.timed==true)console.timeEnd('Person load');if(window.convertflow.snippetsLoaded==undefined){app.ctas.findSnippets();}
if($cf.isEmptyObject(website.conditions)||app.campaigns.checkConditions(website.conditions)==true){website.status=true;$cf.each(website.broadcasts,function(id,broadcast){var conditions=$cf.map(broadcast.conditions,function(condition){if(condition.cta_id==null&&condition.condition_type!=='If area is')return condition})
if(broadcast.quick==false&&(app.campaigns.checkConditions(conditions)==true||$cf.isEmptyObject(conditions))&&(broadcast.timeframe==false||(parseInt(broadcast.range_start)<$cf.now()&&$cf.now()<parseInt(broadcast.range_end)))){broadcast.status=true;broadcast.campaign_type='broadcast'
$cf.each(broadcast.ctas,function(index,cta_id){var cta_conditions=$cf.map(broadcast.conditions,function(condition){if(condition.cta_id==cta_id&&condition.condition_type!=='If area is')return condition})
var area_conditions=$cf.map(broadcast.conditions,function(condition){if(condition.cta_id==cta_id&&condition.condition_type=='If area is')return condition})
if(($cf.isEmptyObject(cta_conditions)||app.campaigns.checkConditions(cta_conditions)==true)&&(app.website.ctas[cta_id].cta_type!=='inline'||$cf.isEmptyObject(area_conditions)==false)){app.website.ctas[cta_id].status=true;app.website.ctas[cta_id].broadcast_id=broadcast.id;var cta=app.website.ctas[cta_id]
if(cta.cta_type=='inline'){$cf.each(area_conditions,function(index,condition){if(convertflow['areas'][condition.area_id]==undefined){convertflow['areas'][condition.area_id]=cta_id}})}
app.ctas.load(cta_id,broadcast)}})}})
$cf.each(website.broadcasts,function(id,standalone){var cta_id=standalone.ctas[0]
if(standalone.quick==true&&app.campaigns.checkConditions(standalone.conditions)==true&&cta_id!==undefined){standalone.status=true;if(app.website.ctas[cta_id].cta_type!=='inline'||$cf.map(standalone.conditions,function(condition){if(condition.condition_type=='If area is')return condition}).length>0){if(app.website.ctas[cta_id].cta_type=='inline'){var area_conditions=$cf.map(standalone.conditions,function(condition){if(condition.cta_id==cta_id&&condition.condition_type=='If area is')return condition})
$cf.each(area_conditions,function(index,condition){if(convertflow['areas'][condition.area_id]==undefined){convertflow['areas'][condition.area_id]=cta_id}})}
$cf.each(standalone.ctas,function(index,cta_id){app.ctas.load(cta_id,standalone)})}}})}
if(admin_widget!==false){app.admin.initialize(website)}}
app.campaigns.checkConditions=function(conditions,person,payload){if(window.convertflow!==undefined&&window.convertflow.person!==undefined){var person=window.convertflow.person;}else if(person!==undefined){var person=person;}else{var person={data:{}};}
var results=[];var outcome=false;$cf.each(conditions,function(id,condition){if(condition.condition_type&&condition.condition_type!==null&&condition.condition_type!=="null"&&condition.condition_type!=="If area is"){var operator=condition.operator;var result=false;var description={id:id,condition_type:condition.condition_type,value:condition_url,current_page:current_page,operator:operator,};var fullurl=window.location+window.location.search;var service=condition.condition_type.split(" ").splice(-1)[0].toLowerCase();if(condition.url!==null){var condition_url=app.helpers.cleanURL(condition.url);var current_page=app.helpers.cleanURL($cf(location).attr("href"));}
if(condition.condition_type=="Everywhere"){var result=true;}
if(condition.condition_type=="If page is"){if(condition_url==current_page){var result=true;}
condition.value=condition_url;description["current_page"]=current_page;}
if(condition.condition_type=="If page is NOT"){if(condition_url!==current_page){var result=true;}
condition.value=condition_url;description["current_page"]=current_page;}
if(condition.condition_type=="If URL contains"){if(fullurl.indexOf(condition.keyword)>-1){var result=true;}
condition.value=condition.keyword;}
if(condition.condition_type=="If URL does NOT contain"){if(fullurl.indexOf(condition.keyword)==-1){var result=true;}
condition.value=condition.keyword;}
if(condition.condition_type=="If visiting from city"){if(person.data.location!==undefined&&person.data.location["city"]!==undefined&&person.data.location["city"].toLowerCase().indexOf(condition.keyword.toLowerCase())>-1){var result=true;}
condition.value=condition.keyword;}
if(condition.condition_type=="If NOT visiting from city"){if(person.data.location==undefined||person.data.location["city"]==undefined||person.data.location["city"].toLowerCase().indexOf(condition.keyword.toLowerCase())==-1){var result=true;}
condition.value=condition.keyword;}
if(condition.condition_type=="If visiting from region"){if(person.data.location!==undefined&&person.data.location["regionName"]!==undefined&&person.data.location["regionName"].toLowerCase().indexOf(condition.keyword.toLowerCase())>-1){var result=true;}
condition.value=condition.keyword;}
if(condition.condition_type=="If NOT visiting from region"){if(person.data.location==undefined||person.data.location["regionName"]==undefined||person.data.location["regionName"].toLowerCase().indexOf(condition.keyword.toLowerCase())==-1){var result=true;}
condition.value=condition.keyword;}
if(condition.condition_type=="If visiting from country"){if(person.data.location!==undefined&&person.data.location["countryCode"]!==undefined&&person.data.location["countryCode"].indexOf(condition.country)>-1){var result=true;}
condition.value=condition.country;}
if(condition.condition_type=="If NOT visiting from country"){if(person.data.location==undefined||person.data.location["countryCode"]==undefined||person.data.location["countryCode"].indexOf(condition.country)==-1){var result=true;}
condition.value=condition.country;}
if(condition.condition_type=="If visiting ConvertFlow landing page"){var pageCtaOuter=$cf('.convertflow-cta.cf-page').parent();var pageCtaId=$cf(pageCtaOuter).attr('data-cta-id')||$cf(pageCtaOuter).attr('cta-id');if(!condition.condition_cta||condition.condition_cta==pageCtaId){var result=true;}
condition.value=condition.condition_cta;}
if(condition.condition_type=="If person has viewed CTA"||condition.condition_type=="If person has viewed campaign"){var count=condition.count||0;if(person.data.campaigns!==undefined&&person.data.campaigns.ctas!==undefined&&person.data.campaigns.ctas[condition.condition_cta]!==undefined&&person.data.campaigns.ctas[condition.condition_cta]["stats"]!==undefined&&person.data.campaigns.ctas[condition.condition_cta]["stats"]["View"]!==undefined&&typeof person.data.campaigns.ctas[condition.condition_cta]["stats"]["View"]=='number'&&person.data.campaigns.ctas[condition.condition_cta]["stats"]["View"]>=count){var result=true;}
condition.value="\""+condition.condition_cta+"\" more than "+count+" times";}
if(condition.condition_type=="If person has NOT viewed CTA"||condition.condition_type=="If person has NOT viewed campaign"){var count=condition.count||0;if(person.data.campaigns==undefined||person.data.campaigns.ctas==undefined||person.data.campaigns.ctas[condition.condition_cta]==undefined||person.data.campaigns.ctas[condition.condition_cta]["stats"]==undefined||person.data.campaigns.ctas[condition.condition_cta]["stats"]["View"]==undefined||typeof person.data.campaigns.ctas[condition.condition_cta]["stats"]["View"]!=='number'||person.data.campaigns.ctas[condition.condition_cta]["stats"]["View"]<count){var result=true;}
condition.value="\""+condition.condition_cta+"\" ";if(count>0){condition.value+=count+" times";}}
if(condition.condition_type=="If person has engaged with CTA"||condition.condition_type=="If person has converted with CTA"||condition.condition_type=="If person has converted with campaign"){if(person.data.campaigns!==undefined&&person.data.campaigns.ctas!==undefined&&person.data.campaigns.ctas[condition.condition_cta]!==undefined&&person.data.campaigns.ctas[condition.condition_cta]["stats"]!==undefined&&person.data.campaigns.ctas[condition.condition_cta]["stats"]["Complete"]!==undefined){var result=true;}
condition.value=condition.condition_cta;}
if(condition.condition_type=="If person has NOT engaged with CTA"||condition.condition_type=="If person has NOT converted with CTA"||condition.condition_type=="If person has NOT converted with campaign"){if(person.data.campaigns==undefined||person.data.campaigns.ctas==undefined||person.data.campaigns.ctas[condition.condition_cta]==undefined||person.data.campaigns.ctas[condition.condition_cta]["stats"]==undefined||person.data.campaigns.ctas[condition.condition_cta]["stats"]["Complete"]==undefined){var result=true;}
condition.value=condition.condition_cta;}
if(condition.condition_type=="If person has completed CTA"||condition.condition_type=="If person has completed campaign"){if(person.data.campaigns!==undefined&&person.data.campaigns.ctas!==undefined&&person.data.campaigns.ctas[condition.condition_cta]!==undefined&&person.data.campaigns.ctas[condition.condition_cta]["stats"]!==undefined&&person.data.campaigns.ctas[condition.condition_cta]["stats"]["Completion"]!==undefined){var result=true;}
condition.value=condition.condition_cta;}
if(condition.condition_type=="If person has NOT completed CTA"||condition.condition_type=="If person has NOT completed campaign"){if(person.data.campaigns==undefined||person.data.campaigns.ctas==undefined||person.data.campaigns.ctas[condition.condition_cta]==undefined||person.data.campaigns.ctas[condition.condition_cta]["stats"]==undefined||person.data.campaigns.ctas[condition.condition_cta]["stats"]["Completion"]==undefined){var result=true;}
condition.value=condition.condition_cta;}
if(condition.condition_type=="If person is in visitor segment"){var conditions_group;if(condition.data["conditions_group_id"]){var conditions_group=app.website.conditions_groups[condition.data["conditions_group_id"]];}
if(conditions_group&&conditions_group.conditions&&app.campaigns.checkConditions(conditions_group.conditions)==true){var result=true;}
if(conditions_group){condition.value=conditions_group.name;}else{condition.value=condition.data["conditions_group_id"];}}
if(condition.condition_type=="If person is NOT in visitor segment"){var conditions_group;if(condition.data["conditions_group_id"]){var conditions_group=app.website.conditions_groups[condition.data["conditions_group_id"]];}
if(!conditions_group||!conditions_group.conditions||app.campaigns.checkConditions(conditions_group.conditions)==false){var result=true;}
if(conditions_group){condition.value=conditions_group.name;}else{condition.value=condition.data["conditions_group_id"];}}
if(condition.condition_type=="If person is an identified contact"){if(person.email){var result=true;}}
if(condition.condition_type=="If person is NOT an identified contact"){if(!person.email){var result=true;}}
if(condition.condition_type=="If device type is"){if(condition.data.device=="desktop"){if($cf(window).width()>1024){var result=true;}}else if(condition.data.device.indexOf("mobile")>-1||condition.data.device.indexOf("tablet")>-1){if($cf(window).width()<1025){var result=true;}}
condition.value=condition.data.device;}
if(condition.condition_type=="If contact has tag"||condition.condition_type=="If person has tag"){if(person.data.tags!==undefined&&$cf.grep(person.data.tags,function(s){return s==condition.tag_id;}).length>0){var result=true;}
condition.value=condition.tag_id;}
if(condition.condition_type=="If contact does NOT have tag"||condition.condition_type=="If person does NOT have tag"){if(person.data.tags==undefined||$cf.grep(person.data.tags,function(s){return s==condition.tag_id;}).length==0){var result=true;}
condition.value=condition.tag_id;}
if(condition.condition_type=="If person has visited"){var count=condition.count||0;if(condition_url&&person.data.visits&&person.data.visits[condition_url]&&typeof person.data.visits[condition_url]=='number'&&person.data.visits[condition_url]>=count){var result=true;}
condition.value=condition_url;if(count>0){condition.value+=" "+count+" times";}}
if(condition.condition_type=="If person has NOT visited"){var count=condition.count||0;if(!condition_url||!person.data.visits||!person.data.visits[condition_url]||typeof person.data.visits[condition_url]!=='number'||person.data.visits[condition_url]<count){var result=true;}
condition.value=condition_url;if(count>0){condition.value+=" "+count+" times";}}
if(condition.condition_type=="If person has more than X page views"){if(person.data.visits!==undefined&&person.data.visits.pages!==undefined&&person.data.visits.pages>condition.count){var result=true;}
condition.value=condition.count;}
if(condition.condition_type=="If person has less than X page views"){if(person.data.visits==undefined||person.data.visits.pages==undefined||person.data.visits.pages<condition.count){var result=true;}
condition.value=condition.count;}
if(condition.condition_type=="If person has more than X sessions"){if(person.data.visits!==undefined&&person.data.visits.session!==undefined&&person.data.visits.session.sessions!==undefined&&person.data.visits.session.sessions>condition.count){var result=true;}
condition.value=condition.count;}
if(condition.condition_type=="If person has fewer than X sessions"){if(person.data.visits==undefined||person.data.visits.session==undefined||person.data.visits.session.sessions==undefined||person.data.visits.session.sessions<condition.count){var result=true;}
condition.value=condition.count;}
if(condition.condition_type=="If person has more than X page views in current session"){if(person.data.visits!==undefined&&person.data.visits.session!==undefined&&person.data.visits.session.pages!==undefined&&person.data.visits.session.pages>condition.count){var result=true;}
condition.value=condition.count;}
if(condition.condition_type=="If person has fewer than X page views in current session"){if(person.data.visits==undefined||person.data.visits.session==undefined||person.data.visits.session.pages==undefined||person.data.visits.session.pages<condition.count){var result=true;}
condition.value=condition.count;}
if(condition.condition_type=="If person had session within last X days"){if(person.data.visits!==undefined&&person.data.visits.session!==undefined&&person.data.visits.session.previous!==undefined&&app.helpers.parseDate(person.data.visits.session.previous)>=Date.parse(new Date())-condition.count*24*60*60*1000){var result=true;}
condition.value=condition.count;}
if(condition.condition_type=="If person has NOT had session within last X days"){if(person.data.visits==undefined||person.data.visits.session==undefined||person.data.visits.session.previous==undefined||app.helpers.parseDate(person.data.visits.session.previous)<=Date.parse(new Date())-condition.count*24*60*60*1000){var result=true;}
condition.value=condition.count;}
if(condition.condition_type=="If current session is more than X minutes"){if(person.data.visits!==undefined&&person.data.visits.session!==undefined&&person.data.visits.session.current!==undefined&&app.helpers.parseDate(person.data.visits.session.current)<=Date.parse(new Date())-condition.count*60*1000){var result=true;}
condition.value=condition.count;}
if(condition.condition_type=="If current session is less than X minutes"){if(person.data.visits==undefined||person.data.visits.session==undefined||person.data.visits.session.current==undefined||app.helpers.parseDate(person.data.visits.session.current)>=Date.parse(new Date())-condition.count*60*1000){var result=true;}
condition.value=condition.count;}
if(condition.condition_type=="If cookie value contains keyword"){if(app.helpers.getCookie(condition.url)&&condition.keyword&&app.helpers.getCookie(condition.url).indexOf(condition.keyword)>-1){var result=true;}
condition.value=condition.url+" ? "+condition.keyword;}
if(condition.condition_type=="If cookie value does NOT contain keyword"){if(!app.helpers.getCookie(condition.url)||!condition.keyword||app.helpers.getCookie(condition.url).indexOf(condition.keyword)==-1){var result=true;}
condition.value=condition.url+" ? "+condition.keyword;}
if(condition.condition_type=="If global variable value contains keyword"){if(condition.url&&condition.keyword&&(app.helpers.nestedGet(window,condition.url,"")+"").indexOf(condition.keyword)>-1){var result=true;}
condition.value=condition.url+" ? "+condition.keyword;}
if(condition.condition_type=="If global variable value does NOT contain keyword"){if(!condition.url||!condition.keyword||!app.helpers.nestedGet(window,condition.url)||(app.helpers.nestedGet(window,condition.url,"")+"").indexOf(condition.keyword)==-1){var result=true;}
condition.value=condition.url+" ? "+condition.keyword;}
if(condition.condition_type=="If person has visited with URL parameter"){if(person.data.params!==undefined&&(person.data.params[condition.url]==condition.keyword||fullurl.indexOf(condition.url+"="+condition.keyword)>-1)){var result=true;}
condition.value="'"+condition.url+"' = '"+condition.keyword+"'";}
if(condition.condition_type=="If person has NOT visited with URL parameter"){if(person.data.params==undefined||(person.data.params[condition.url]!==condition.keyword&&fullurl.indexOf(condition.url+"="+condition.keyword)==-1)){var result=true;}
condition.value="'"+condition.url+"' = '"+condition.keyword+"'";}
if(condition.condition_type=="If referral source contains"){if(person.data.sources!==undefined&&$cf.grep(person.data.sources,function(s){return(s!==undefined&&s!==null&&s.indexOf(condition.keyword)>-1);}).length>0){var result=true;}
condition.value=condition.keyword;}
if(condition.condition_type=="If referral source does NOT contain"){if(person.data.sources==undefined||$cf.grep(person.data.sources,function(s){return(s!==undefined&&s!==null&&s.indexOf(condition.keyword)>-1);}).length==0){var result=true;}
condition.value=condition.keyword;}
if(condition.condition_type=="If contact field value contains"){if(person[condition.data["attribute"]]&&person[condition.data["attribute"]].indexOf(condition.keyword)>-1){var result=true;}
condition.value=condition.data["attribute"]+" ? "+condition.keyword;}
if(condition.condition_type=="If contact field value does NOT contain"){if(!person[condition.data["attribute"]]||person[condition.data["attribute"]].indexOf(condition.keyword)==-1){var result=true;}
condition.value=condition.data["attribute"]+" ? "+condition.keyword;}
if(condition.condition_type=="If custom field value contains"){if(person.extra!==undefined&&person.extra!==null&&person.extra[condition.data.slug]!==undefined&&person.extra[condition.data.slug].indexOf(condition.keyword)>-1){var result=true;}
condition.value=condition.data.slug+" ? "+condition.keyword;}
if(condition.condition_type=="If custom field value does NOT contain"){if(person.extra==undefined||person.extra[condition.data.slug]==undefined||person.extra[condition.data.slug].indexOf(condition.keyword)==-1){var result=true;}
condition.value=condition.data.slug+" ? "+condition.keyword;}
if(condition.condition_type=="If custom field is greater than"){if(person.extra!==undefined&&person.extra!==null&&person.extra[condition.data.slug]!==undefined&&app.helpers.isNumeric(person.extra[condition.data.slug])&&app.helpers.isNumeric(condition.keyword)&&parseInt(person.extra[condition.data.slug])>parseInt(condition.keyword)){var result=true;}
condition.value=condition.data.slug+" > "+condition.keyword;}
if(condition.condition_type=="If custom field is less than"){if(person.extra!==undefined&&person.extra!==null&&person.extra[condition.data.slug]!==undefined&&app.helpers.isNumeric(person.extra[condition.data.slug])&&app.helpers.isNumeric(condition.keyword)&&parseInt(person.extra[condition.data.slug])<parseInt(condition.keyword)){var result=true;}
condition.value=condition.data.slug+" < "+condition.keyword;}
if(condition.condition_type.indexOf("If person has tag in")>-1||condition.condition_type.indexOf("If person has tag value in")>-1){if(person.data[service]!==undefined&&person.data[service]["tags"]!==undefined&&$cf.grep(person.data[service]["tags"],function(s){return(s.id==condition.data.tag_id.replace("&#39;","'").toString());}).length>0){var result=true;}
condition.value=condition.data.tag_id.toString();}
if(condition.condition_type.indexOf("If person doesn't have tag in")>-1||condition.condition_type.indexOf("If person doesn't have tag value in")>-1){if(person.data[service]==undefined||person.data[service]["tags"]==undefined||$cf.grep(person.data[service]["tags"],function(s){return(s.id==condition.data.tag_id.replace("&#39;","'").toString());}).length==0){var result=true;}
condition.value=condition.data.tag_id.toString();}
if(condition.condition_type.indexOf("If person is subscribed to list in")>-1||condition.condition_type.indexOf("If person is subscribed to campaign in")>-1){if(person.data[service]!==undefined&&person.data[service]["lists"]!==undefined&&$cf.grep(person.data[service]["lists"],function(s){return s.id==condition.data.list_id.toString();}).length>0){var result=true;}
condition.value=condition.data.list_id.toString();}
if(condition.condition_type.indexOf("If person is NOT subscribed to list in")>-1||condition.condition_type.indexOf("If person is NOT subscribed to campaign in")>-1){if(person.data[service]==undefined||person.data[service]["lists"]==undefined||$cf.grep(person.data[service]["lists"],function(s){return s.id==condition.data.list_id.toString();}).length==0){var result=true;}
condition.value=condition.data.list_id.toString();}
if(condition.condition_type.indexOf("If person is in group in")>-1){var group_id=condition.data.group_id||condition.data.tag_id;if(person.data[service]!==undefined&&person.data[service]["groups"]!==undefined&&$cf.grep(person.data[service]["groups"],function(s){return s.id==group_id.replace("&#39;","'").toString();}).length>0){var result=true;}
condition.value=group_id.toString();}
if(condition.condition_type.indexOf("If person is NOT in group in")>-1){var group_id=condition.data.group_id||condition.data.tag_id;if(person.data[service]==undefined||person.data[service]["groups"]==undefined||$cf.grep(person.data[service]["groups"],function(s){return s.id==group_id.replace("&#39;","'").toString();}).length==0){var result=true;}
condition.value=group_id.toString();}
if(condition.condition_type.indexOf("If person is a member of segment")>-1){if(person.data[service]!==undefined&&person.data[service]["segments"]!==undefined&&$cf.grep(person.data[service]["segments"],function(s){return s.id==condition.data.segment_id.toString();}).length>0){var result=true;}
condition.value=condition.data.segment_id.toString();}
if(condition.condition_type.indexOf("If person is NOT a member of segment")>-1){if(person.data[service]==undefined||person.data[service]["segments"]==undefined||$cf.grep(person.data[service]["segments"],function(s){return s.id==condition.data.segment_id.toString();}).length==0){var result=true;}
condition.value=condition.data.segment_id.toString();}
if(condition.condition_type.indexOf("If person is in workflow in")>-1){if(person.data[service]!==undefined&&person.data[service]["workflows"]!==undefined&&$cf.grep(person.data[service]["workflows"],function(s){return s.id==condition.data.workflow.toString();}).length>0){var result=true;}
condition.value=condition.data.workflow.toString();}
if(condition.condition_type.indexOf("If person is NOT in workflow in")>-1){if(person.data[service]==undefined||person.data[service]["workflows"]==undefined||$cf.grep(person.data[service]["workflows"],function(s){return s.id==condition.data.workflow.toString();}).length==0){var result=true;}
condition.value=condition.data.workflow.toString();}
if(condition.condition_type.indexOf("If person is in lifecycle stage in")>-1){if(person.data[service]!==undefined&&person.data[service]["properties"]!==undefined&&$cf.grep(person.data[service]["properties"],function(p){return(p.property=="lifecyclestage"&&p.value==condition.data.lifecycle_stage.toString());}).length>0){var result=true;}
condition.value=condition.data.lifecycle_stage.toString();}
if(condition.condition_type.indexOf("If person is NOT in lifecycle stage in")>-1){if(person.data[service]==undefined||person.data[service]["properties"]==undefined||$cf.grep(person.data[service]["properties"],function(p){return(p.property=="lifecyclestage"&&p.value==condition.data.lifecycle_stage.toString());}).length==0){var result=true;}
condition.value=condition.data.lifecycle_stage.toString();}
if(condition.condition_type.indexOf("If person has submitted form in")>-1){if(person.data[service]!==undefined&&person.data[service]["forms"]!==undefined&&$cf.grep(person.data[service]["forms"],function(f){return f.name==condition.data.form.toString();}).length>0){var result=true;}
condition.value=condition.data.form.toString();}
if(condition.condition_type.indexOf("If person did NOT submit form in")>-1){if(person.data[service]==undefined||person.data[service]["forms"]==undefined||$cf.grep(person.data[service]["forms"],function(f){return f.name==condition.data.form.toString();}).length==0){var result=true;}
condition.value=condition.data.form.toString();}
if(condition.condition_type.indexOf("If contact property value matches in")>-1||condition.condition_type.indexOf("If person has custom field value in")>-1){if(person.data[service]!==undefined&&person.data[service]["properties"]!==undefined&&$cf.grep(person.data[service]["properties"],function(p){return(p.property==condition.data.property_type&&p.value==condition.data.property);}).length>0){var result=true;}
condition.value=condition.data.property_type+" = "+condition.data.property;}
if(condition.condition_type.indexOf("If contact property value does NOT match in")>-1||condition.condition_type.indexOf("If person doesn't have custom field value in")>-1){if(person.data[service]==undefined||person.data[service]["properties"]==undefined||$cf.grep(person.data[service]["properties"],function(p){return(p.property==condition.data.property_type&&p.value==condition.data.property);}).length==0){var result=true;}
condition.value=condition.data.property_type+" != "+condition.data.property;}
if(condition.condition_type.indexOf("If contact property value contains in")>-1){if(person.data[service]!==undefined&&person.data[service]["properties"]!==undefined&&$cf.grep(person.data[service]["properties"],function(p){return(p.property==condition.data.property_type&&p.value.indexOf(condition.data.property)>-1);}).length>0){var result=true;}
condition.value=condition.data.property_type+" ? "+condition.data.property;}
if(condition.condition_type.indexOf("If contact property value does NOT contain in")>-1){if(person.data[service]==undefined||person.data[service]["properties"]==undefined||$cf.grep(person.data[service]["properties"],function(p){return(p.property==condition.data.property_type&&p.value.indexOf(condition.data.property)>-1);}).length==0){var result=true;}
condition.value=condition.data.property_type+" ? "+condition.data.property;}
if(condition.condition_type.indexOf("If person has field value in")>-1){if(person.data[service]!==undefined&&person.data[service]["properties"]!==undefined&&$cf.grep(person.data[service]["properties"],function(p){return(p.id==condition.data.property_type&&p.value==condition.data.property);}).length>0){var result=true;}
condition.value=condition.data.property_type+" = "+condition.data.property;}
if(condition.condition_type.indexOf("If person doesn't have field value in")>-1){if(person.data[service]==undefined||person.data[service]["properties"]==undefined||$cf.grep(person.data[service]["properties"],function(p){return(p.id==condition.data.property_type&&p.value==condition.data.property);}).length==0){var result=true;}
condition.value=condition.data.property_type+" != "+condition.data.property;}
if(condition.condition_type.indexOf("If custom field contains value in")>-1){if((person.data[service]!==undefined&&person.data[service]["fields"]!==undefined&&$cf.grep(person.data[service]["fields"],function(field){return(field.id==condition.data.field&&field.value&&field.value.indexOf(condition.data.value)>-1);}).length>0)||(person.data[service]!==undefined&&person.data[service]["properties"]!==undefined&&$cf.grep(person.data[service]["properties"],function(p){return(p.id==condition.data.property_type&&p.value&&p.value.indexOf(condition.data.property)>-1);}).length>0)){var result=true;}
condition.value=(condition.data.field||condition.data.property_type)+" ? "+(condition.data.value||condition.data.property);}
if(condition.condition_type.indexOf("If custom field does NOT contain value in")>-1){if((person.data[service]==undefined||person.data[service]["fields"]==undefined||$cf.grep(person.data[service]["fields"],function(field){return(field.id==condition.data.field&&field.value&&field.value.indexOf(condition.data.value)>-1);}).length==0)&&(person.data[service]==undefined||person.data[service]["properties"]==undefined||$cf.grep(person.data[service]["properties"],function(p){return(p.id==condition.data.property_type&&p.value&&p.value.indexOf(condition.data.property)>-1);}).length==0)){var result=true;}
condition.value=(condition.data.field||condition.data.property_type)+" ? "+(condition.data.value||condition.data.property);}
if(condition.condition_type=="If visiting WordPress page"){if($cf("body").hasClass("page")&&(condition.data.page_id=="All"||$cf("body").hasClass("page-id-"+condition.data.page_id))){var result=true;}
condition.value=condition.data.page_id;}
if(condition.condition_type=="If NOT visiting WordPress page"){if($cf("body").hasClass("page")==false||(condition.data.page_id!=="All"&&$cf("body").hasClass("page-id-"+condition.data.page_id)==false)){var result=true;}
condition.value=condition.data.page_id;}
if(condition.condition_type=="If visiting WordPress post"){if($cf("body").hasClass("single-post")&&(condition.data.post_id=="All"||$cf("body").hasClass("postid-"+condition.data.post_id))){var result=true;}
condition.value=condition.data.post_id;}
if(condition.condition_type=="If NOT visiting WordPress post"){if($cf("body").hasClass("single-post")==false||(condition.data.post_id!=="All"&&$cf("body").hasClass("postid-"+condition.data.post_id)==false)){var result=true;}
condition.value=condition.data.post_id;}
if(condition.condition_type=="If visiting WordPress category"){if($cf("body").hasClass("category-"+condition.data.category_id)||($cf("body").hasClass("single-post")&&$cf(".post").first().hasClass("category-"+condition.data.category_id))){var result=true;}
condition.value=condition.data.category_id;}
if(condition.condition_type=="If NOT visiting WordPress category"){if($cf("body").hasClass("category-"+condition.data.category_id)==false&&($cf("body").hasClass("single-post")&&$cf(".post").first().hasClass("category-"+condition.data.category_id))==false){var result=true;}
condition.value=condition.data.category_id;}
if(condition.condition_type=="If WordPress post has tag"){if($cf("body").hasClass("tag-"+condition.data.tag_id)||($cf("body").hasClass("single-post")&&$cf(".post").first().hasClass("tag-"+condition.data.tag_id))){var result=true;}
condition.value=condition.data.tag_id;}
if(condition.condition_type=="If WordPress post does NOT have tag"){if($cf("body").hasClass("tag-"+condition.data.tag_id)==false&&($cf("body").hasClass("single-post")&&$cf(".post").first().hasClass("tag-"+condition.data.tag_id))==false){var result=true;}
condition.value=condition.data.tag_id;}
if(condition.condition_type=="If person is logged into WordPress"){if($cf("body").hasClass("logged-in")){var result=true;}}
if(condition.condition_type=="If person is NOT logged into WordPress"){if($cf("body").hasClass("logged-in")==false){var result=true;}}
if(condition.condition_type.indexOf("If CTA custom field contains")>-1||condition.condition_type.indexOf("If form custom field contains")>-1){if(person.extra!==undefined&&condition.data!==null&&condition.data.slug!==undefined&&condition.keyword!==null&&person.extra[condition.data.slug]!==undefined&&person.extra[condition.data.slug].indexOf(condition.keyword)>-1){var result=true;}
if(condition.data!==null){condition.value=condition.data.slug+" ? "+condition.keyword;}}
if(condition.condition_type.indexOf("If CTA custom field does NOT contain")>-1||condition.condition_type.indexOf("If form custom field does NOT contain")>-1){if(person.extra==undefined||condition.data==undefined||condition.data.slug==undefined||condition.keyword==undefined||person.extra[condition.data.slug]==undefined||person.extra[condition.data.slug].indexOf(condition.keyword)==-1){var result=true;}
if(condition.data!==null){condition.value=condition.data.slug+" ? "+condition.keyword;}}
if(condition.condition_type.indexOf("If CTA survey selection matches")>-1||condition.condition_type.indexOf("If survey selection matches")>-1){if(person.extra!==undefined&&condition.data!==null&&condition.data.slug!==undefined&&condition.keyword!==null&&person.extra[condition.data.slug]!==undefined&&(person.extra[condition.data.slug]==condition.keyword||(person.extra[condition.data.slug].split(', ').includes(condition.keyword)))){var result=true;}
if(condition.data!==null){condition.value=condition.data.slug+" == "+condition.keyword;}}
if(condition.condition_type.indexOf("If CTA survey selection does NOT match")>-1||condition.condition_type.indexOf("If survey selection does NOT match")>-1){if(person.extra==undefined||condition.data==undefined||condition.data.slug==undefined||condition.keyword==undefined||person.extra[condition.data.slug]==undefined||(person.extra[condition.data.slug]!==condition.keyword&&person.extra[condition.data.slug].split(', ').includes(condition.keyword)==false)){var result=true;}
if(condition.data!==null){condition.value=condition.data.slug+" != "+condition.keyword;}}
if(condition.condition_type=="If current score is greater than"){if(payload&&payload.variant&&payload.variant.score!==undefined&&app.helpers.isNumeric(condition.keyword)&&payload.variant.score>parseInt(condition.keyword)){var result=true;}
condition.value="Current score > "+condition.keyword;}
if(condition.condition_type=="If current score is less than"){if(payload&&payload.variant&&payload.variant.score!==undefined&&app.helpers.isNumeric(condition.keyword)&&payload.variant.score<parseInt(condition.keyword)){var result=true;}
condition.value="Current score < "+condition.keyword;}
if(condition.condition_type.indexOf("If person has purchased product in")>-1){if(person.data[service]!==undefined&&person.data[service]["purchases"]!==undefined&&$cf.grep(person.data[service]["purchases"],function(s){return s.id==condition.data.product_variant_id;}).length>0){var result=true;}
condition.value=condition.data.product_variant_id;}
if(condition.condition_type.indexOf("If person has NOT purchased product in")>-1){if(person.data[service]==undefined||person.data[service]["purchases"]==undefined||$cf.grep(person.data[service]["purchases"],function(s){return s.id==condition.data.product_variant_id;}).length==0){var result=true;}
condition.value=condition.data.product_variant_id;}
if(condition.condition_type=="If current step has been completed"){if(person.data!==undefined&&person.data["campaigns"]!==undefined&&person.data["campaigns"]["ctas"]!==undefined&&person.data["campaigns"]["ctas"]!==undefined&&person.data["campaigns"]["ctas"][condition.data["cta_id"]]!==undefined&&person.data["campaigns"]["ctas"][condition.data["cta_id"]]["variants"]!==undefined&&person.data["campaigns"]["ctas"][condition.data["cta_id"]]["variants"][condition.data["variant_id"]]!==undefined&&person.data["campaigns"]["ctas"][condition.data["cta_id"]]["variants"][condition.data["variant_id"]]["steps"]!==undefined&&person.data["campaigns"]["ctas"][condition.data["cta_id"]]["variants"][condition.data["variant_id"]]["steps"][condition.data["step_id"]]!==undefined&&person.data["campaigns"]["ctas"][condition.data["cta_id"]]["variants"][condition.data["variant_id"]]["steps"][condition.data["step_id"]]["stats"]!==undefined&&person.data["campaigns"]["ctas"][condition.data["cta_id"]]["variants"][condition.data["variant_id"]]["steps"][condition.data["step_id"]]["stats"]["Complete"]!==undefined){var result=true;}}
if(condition.condition_type.indexOf("in Segment")>-1){var ajs_traits;var personas_traits;if(window.analytics&&typeof analytics.user=="function"&&analytics.user()&&analytics.user().traits()){var ajs_traits=analytics.user().traits();}
if(person.data["segment"]&&person.data["segment"]&&person.data["segment"]["properties"]){var personas_traits=person.data["segment"]["properties"];}
if(condition.condition_type=="If trait matches in Segment"){if((ajs_traits&&typeof ajs_traits=="object"&&ajs_traits[condition.data.trait]&&ajs_traits[condition.data.trait].toString()==condition.data.value)||(personas_traits&&$cf.grep(personas_traits,function(p){return(p.id==condition.data.trait&&p.value.toString()==condition.data.value);}).length>0)){var result=true;}
condition.value=condition.data.trait+" ? "+condition.data.value;}
if(condition.condition_type=="If trait does NOT match in Segment"){if((!ajs_traits||typeof ajs_traits!=="object"||!ajs_traits[condition.data.trait]||ajs_traits[condition.data.trait].toString()!==condition.data.value)&&(!personas_traits||$cf.grep(personas_traits,function(p){return(p.id==condition.data.trait&&p.value.toString()==condition.data.value);}).length==0)){var result=true;}
condition.value=condition.data.trait+" ? "+condition.data.value;}
if(condition.condition_type=="If trait contains keyword in Segment"){if(ajs_traits&&typeof ajs_traits=="object"&&ajs_traits[condition.data.trait]&&ajs_traits[condition.data.trait].toString().indexOf(condition.data.value)>-1){var result=true;}
if(result!==true&&personas_traits&&$cf.grep(personas_traits,function(p){return(p.id==condition.data.trait&&p.value.toString().indexOf(condition.data.value)>-1);}).length>0){var result=true;}
condition.value=condition.data.trait+" ? "+condition.data.value;}
if(condition.condition_type=="If trait does NOT contain keyword in Segment"){if(!ajs_traits||typeof ajs_traits!=="object"||!ajs_traits[condition.data.trait]||ajs_traits[condition.data.trait].toString().indexOf(condition.data.value)==-1){var result=true;if(!personas_traits||$cf.grep(personas_traits,function(p){return(p.id==condition.data.trait&&p.value.toString().indexOf(condition.data.value)>-1);}).length==0){var result=true;}else{var result=false;}}
condition.value=condition.data.trait+" ? "+condition.data.value;}
if(condition.condition_type=="If trait integer is greater than in Segment"){if((ajs_traits&&typeof ajs_traits=="object"&&ajs_traits[condition.data.trait]&&typeof ajs_traits[condition.data.trait]=="number"&&ajs_traits[condition.data.trait]>parseInt(condition.data.value))||(personas_traits&&$cf.grep(personas_traits,function(p){return(p.id==condition.data.trait&&typeof p.value=="number"&&parseInt(p.value)>condition.data.value);}).length>0)){var result=true;}
condition.value=condition.data.trait+" ? "+condition.data.value;}
if(condition.condition_type=="If trait integer is less than in Segment"){if((ajs_traits&&typeof ajs_traits=="object"&&ajs_traits[condition.data.trait]&&typeof ajs_traits[condition.data.trait]=="number"&&ajs_traits[condition.data.trait]<parseInt(condition.data.value))||(personas_traits&&$cf.grep(personas_traits,function(p){return(p.id==condition.data.trait&&typeof p.value=="number"&&parseInt(p.value)<condition.data.value);}).length>0)){var result=true;}
condition.value=condition.data.trait+" ? "+condition.data.value;}}
if(condition.condition_type.indexOf("Shopify")>-1){var cart;var total_price;var integration=$cf.map(app.website.integrations,function(integration){if(integration.integration_type=="Shopify")return integration;})[0];if(integration&&integration.cart){cart=integration.cart;total_price=cart.original_total_price||cart.total_price;}
if(condition.condition_type=="If visiting Shopify product"){if(window.location.href.indexOf("products/"+condition.data["product_id"])>-1){var result=true;}
condition.value=condition.data["product_id"];}
if(condition.condition_type=="If NOT visiting Shopify product"){if(window.location.href.indexOf("products/"+condition.data["product_id"])==-1){var result=true;}
condition.value=condition.data["product_id"];}
if(condition.condition_type=="If visiting Shopify collection"){if(window.location.href.indexOf("collections/"+condition.data["collection_id"])>-1||(condition.data["collection_id"]=="frontpage"&&window.location.pathname=="/")){var result=true;}
condition.value=condition.data["collection_id"];}
if(condition.condition_type=="If NOT visiting Shopify collection"){if(window.location.href.indexOf("collections/"+condition.data["collection_id"])==-1&&(condition.data["collection_id"]=="frontpage"&&window.location.pathname=="/")==false){var result=true;}
condition.value=condition.data["collection_id"];}
if(condition.condition_type=="If Shopify cart contains product"){if(cart&&cart.items&&$cf.map(cart.items,function(item){if(item["handle"]==condition.data["product_id"])return item;}).length>0){var result=true;}
condition.value=condition.data["product_id"];}
if(condition.condition_type=="If Shopify cart does NOT contain product"){if(!cart||!cart.items||$cf.map(cart.items,function(item){if(item["handle"]==condition.data["product_id"])return item;}).length==0){var result=true;}
condition.value=condition.data["product_id"];}
if(condition.condition_type=="If Shopify cart contains greater than X items"){if(cart&&cart.item_count&&cart.item_count>parseInt(condition.data["value"])){var result=true;}
condition.value=condition.data["value"];}
if(condition.condition_type=="If Shopify cart contains less than X items"){if(!cart||!cart.item_count||cart.item_count<parseInt(condition.data["value"])){var result=true;}
condition.value=condition.data["value"];}
if(condition.condition_type=="If Shopify cart value is greater than"){if(cart&&total_price&&total_price/100>parseInt(condition.data["value"])){var result=true;}
condition.value=condition.data["value"];}
if(condition.condition_type=="If Shopify cart value is less than"){if(!cart||!total_price||total_price/100<parseInt(condition.data["value"])){var result=true;}
condition.value=condition.data["value"];}}
condition[operator]=result;description[operator]=result;results.push(description);}});if(($cf.isEmptyObject(conditions)!==true&&($cf.grep(results,function(s){return s.and!==undefined;}).length==0||$cf.grep(results,function(s){return s.and==false;}).length==0)&&$cf.grep(results,function(s){return s.or!==undefined;}).length==0)||(($cf.grep(results,function(s){return s.and!==undefined;}).length==0||$cf.grep(results,function(s){return s.and==false;}).length==0)&&$cf.grep(results,function(s){return s.or==true;}).length>0)){var outcome=true;}
return outcome;};app.ctas.locallystored=function(){if(app.localstorage){var locallystored=localStorage.getItem('cf_ctas')
if(locallystored==undefined||locallystored=="undefined"||locallystored==null){localStorage.setItem('cf_ctas',JSON.stringify({}))
var data={}}else{var locallystored=JSON.parse(locallystored);var data={}
if(location.search.indexOf('cfTime=true')>-1){console.log(locallystored)}
$cf.each(locallystored,function(cta_id,last_updated){if(location.search.indexOf('cfTime=true')>-1){console.log(app.website.ctas[parseInt(cta_id)])
console.log(app.website.ctas[parseInt(cta_id)]==undefined||app.website.ctas[parseInt(cta_id)].options['published_at']==undefined||(last_updated<app.helpers.parseDate(app.website.ctas[parseInt(cta_id)].options['published_at']))||(last_updated<=Date.parse(new Date())-(7*24*60*60*1000)))}
if(app.website.ctas[parseInt(cta_id)]==undefined||app.website.ctas[parseInt(cta_id)].options['published_at']==undefined||(last_updated<app.helpers.parseDate(app.website.ctas[parseInt(cta_id)].options['published_at']))||(last_updated<=Date.parse(new Date())-(7*24*60*60*1000))){localStorage.removeItem('cta'+cta_id)}else{data[cta_id]=last_updated}
return data})
localStorage.setItem('cf_ctas',JSON.stringify(data))}
return data;}else{return{}}}
app.ctas.load=function(cta_id,campaign,snippet,callback){var can_load_campaign=campaign&&((campaign.campaign_type=='broadcast'&&app.website.ctas[cta_id]['broadcast_id']==campaign.id)||app.website.ctas[cta_id]['broadcast_id']==undefined)
var can_load_if_landing_page=campaign&&($cf('body').hasClass('convertflow-page')==false||snippet||$cf.map(campaign.conditions,function(condition){var pageCtaOuter=$cf('.convertflow-cta.cf-page').parent();var pageCtaId=$cf(pageCtaOuter).attr('data-cta-id')||$cf(pageCtaOuter).attr('cta-id');if(condition.condition_type=='If visiting ConvertFlow landing page'&&(!condition.condition_cta||condition.condition_cta==pageCtaId)){return condition}}).length>0||window.Shopify!==undefined)
if(campaign==undefined||(can_load_campaign&&can_load_if_landing_page)){var cta_path=app.assets_root+'cta/'+cta_id+'.js';if(app.live==false){var cta_path=cta_path+'?preview=true';}
var local=app.helpers.decompressAndGet("cta"+cta_id)
if(local!==null&&local!=="undefined"){var cta=JSON.parse(local)}else{var cta=null;}
var selectors=[];var conditions=undefined
if(campaign!==undefined){var conditions=$cf.map(campaign.conditions,function(condition){if(condition.cta_id==cta_id&&condition.condition_type=='If area is'&&condition.area_id!==null)return condition})}
if(conditions!==undefined){$cf.each(conditions,function(index,condition){var area_selector='cf-'+app.website.id+'-area-'+condition.area_id;selectors.push('.'+area_selector+' , '+'#'+area_selector);})}
if(snippet!==undefined){var cta_id=$cf(snippet).attr('cta-id')||$cf(snippet).attr('data-cta-id')
var website_id=$cf(snippet).attr('website-id')||$cf(snippet).attr('data-website-id')
if(website_id==app.website.id){selectors.push(snippet)}}
if(campaign!==undefined&&campaign.campaign_type=='broadcast'&&campaign.quick==false){app.website.ctas[cta_id][campaign.campaign_type+'_id']=campaign.id}
var startInject=function(callback){if(campaign!==undefined&&campaign.campaign_type=='broadcast'&&campaign.quick==false){convertflow.ctas[cta_id]['broadcast_id']=campaign.id}
var cta=convertflow.ctas[cta_id];if(cta!==undefined){app.ctas.inject(cta,campaign,selectors,callback);}}
if(cta==null||(app.website.ctas[cta_id]!==undefined&&app.helpers.parseDate(cta.options.published_at)<app.helpers.parseDate(app.website.ctas[cta_id].options.published_at))){var async=app.website.ctas[cta_id]&&app.website.ctas[cta_id].cta_type!=='page';app.helpers.loadScript(cta_path,function(){var cta=convertflow.ctas[cta_id]
if(app.live==true&&cta.cta_type=='inline'){var locallystored=app.ctas.locallystored();app.helpers.compressAndStore("cta"+cta_id,JSON.stringify(cta))
locallystored[cta_id]=Date.parse(new Date())
if(app.localstorage){localStorage.setItem('cf_ctas',JSON.stringify(locallystored));}}
startInject(callback)},async);}else{convertflow.ctas[cta_id]=cta;startInject(callback)}}
if($cf('body').hasClass('convertflow-page')&&campaign&&can_load_if_landing_page==false){campaign.status=false}}
app.ctas.inject=function(cta,campaign,selectors,callback){if($cf('body').length>0){var variant=app.ctas.test(cta);if(variant){if(cta.cta_type!=='inline'&&cta.cta_type!=='page'&&app.live==true){if($cf('#'+'cta'+cta.id).length==0){if(variant.options['trigger_type']!=='click'&&campaign!==undefined&&campaign.campaign_type=='broadcast'){var supression=cta.cta_type+'Triggered'
if(convertflow[supression]==undefined){convertflow[supression]=campaign.id;if(variant.options['trigger_type']=='prehook'){convertflow.hookTriggered=campaign.id;}}}
var div=document.createElement('div');$cf(div).attr('id','cta'+cta.id).css('display','none');var classname="convertflow-cta";if(app.website.ctas[cta.id]!==undefined){var classname=classname+' cf-'+app.website.ctas[cta.id].cta_type;}
div.className=classname;div.innerHTML=variant.html;var component=$cf(div).children('[data-react-class]')[0];if(component){$cf(component).removeAttr('data-react-props');$cf(component).removeAttr('data-react-class');$cf(component).removeAttr('data-hydrate');$cf(component).removeAttr('data-react-cache-id');}
$cf(document.body).append(div);app.ctas.initialize(cta,variant,$cf('#'+'cta'+cta.id),callback);}}else{$cf(selectors).each(function(index,selector){var isArea=(typeof selector==="string"&&selector.indexOf('area')>-1)?true:false;if(isArea==true){var area_id=selector.split("-").pop()}else{var area_id=undefined}
var checkForEmbed=function(selector){if($cf(selector).length>0){$cf(selector).each(function(){if($cf(this).find('.convertflow-cta').length==0&&((isArea==true&&area_id!==undefined&&convertflow['areas'][area_id]==cta.id)||isArea==false)){$cf(this).attr('broadcast-id',convertflow.ctas[cta.id]['broadcast_id'])
if(app.timed==true){console.timeEnd('CTA inject')}
var div=document.createElement('div');$cf(div).addClass('cta'+cta.id).css('display','block')
var classname="convertflow-cta";if(app.website.ctas[cta.id]!==undefined){var classname=classname+' cf-'+app.website.ctas[cta.id].cta_type;}
div.className=classname;div.innerHTML=variant.html;$cf(div).find('div[id="cta_'+cta.id+'"]').css({'margin-left':'auto','margin-right':'auto'})
$cf(div).attr('injected','true');var component=$cf(div).children('[data-react-class]')[0];if(component){$cf(component).removeAttr('data-react-props');$cf(component).removeAttr('data-react-class');$cf(component).removeAttr('data-hydrate');$cf(component).removeAttr('data-react-cache-id');}
$cf(this).html(div);app.ctas.initialize(cta,variant,this,callback);if(cta.cta_type=='page'){app.ctas.findSnippets()
if(convertflow.person){app.campaigns.initialize(app.website,false)}}}})}else if(document.readyState!=='complete'){setTimeout(function(){checkForEmbed(selector)},10)}}
checkForEmbed(selector)})}}}else{setTimeout(function(){app.ctas.inject(cta,campaign,selectors);},50)}}
app.ctas.findSnippets=function(){window.convertflow.snippetsLoaded=true;if($cf('.cf-cta-snippet[website-id="'+app.website.id+'"]').length>0||$cf('.cf-cta-snippet[data-website-id="'+app.website.id+'"]').length>0){$cf('.cf-cta-snippet[website-id="'+app.website.id+'"], .cf-cta-snippet[data-website-id="'+app.website.id+'"]').each(function(index,snippet){if($cf(snippet).children().length==0){var cta_id=$cf(snippet).attr('cta-id')||$cf(snippet).attr('data-cta-id')
var campaign;var broadcast_id=$cf(snippet).attr('data-broadcast-id')
if(broadcast_id){campaign=app.website.broadcasts[broadcast_id];}
app.ctas.load(cta_id,campaign,snippet)}})}else if(document.readyState!=='complete'){setTimeout(function(){app.ctas.findSnippets()},50)}}
app.ctas.splitTest=function(variations,weights){var rand=function(min,max){return Math.floor(Math.random()*(max-min+1))+min;};var generateWeighedList=function(list,weight){var weighed_list=[];for(var i=0;i<weight.length;i++){var multiples=weight[i]*100;for(var j=0;j<multiples;j++){weighed_list.push(list[i]);}}
return weighed_list;};var weighed_list=generateWeighedList(variations,weights);var random_num=rand(0,weighed_list.length-1);var variant=weighed_list[random_num];return variant;}
app.ctas.test=function(cta){if(app.live==true){var variants={}
var variations=[]
var weights=[]
$cf.each(cta.variants,function(variant_id,variant){var weight=variant.percentage*0.01;variants[variant_id]=weight;variations.push(variant_id);weights.push(weight)})
var cookie=app.helpers.getCookie("cf_"+app.website.id+"_cta_"+cta.id)
if(cta.test_type!=="cookie"||cookie==null||variants[cookie]==undefined||variants[cookie]==0){var variant=app.ctas.splitTest(variations,weights);if(cta.test_type=='cookie'&&Object.values(cta.variants).length>1){app.helpers.setCookie("cf_"+app.website.id+"_cta_"+cta.id,variant,20*365*24*60);}}else{var variant=app.helpers.getCookie("cf_"+app.website.id+"_cta_"+cta.id)}
var variantToShow=cta.variants[parseInt(variant)];if(variantToShow){variantToShow.winner=true;return variantToShow;}}else{var variant_id=0;var variantToShow=cta.variants[parseInt(variant_id)];variantToShow.winner=true;return variantToShow;}}
app.ctas.mergeTags=function(cta,variant,embed){var personMap=app.helpers.personMap()
$cf(embed).find('p, h1, h2, h3, h4, h5, h6, span').each(function(index,element){$cf.each($cf(element).html().match("((.*))"),function(index,match){if(typeof match!=='undefined'&&match!==null){var txt=match.split('(');var mergetags=[]
for(var i=1;i<txt.length;i++){mergetags.push(txt[i].split(')')[0])}
if(match.indexOf('CURRENT_SCORE')!==-1){var score_tags=mergetags.filter(function(mergetag){return mergetag.indexOf('{CURRENT_SCORE}')>-1})
$cf.each(score_tags,function(index,mergetag){var mergetag='('+mergetag+')';var mergetag_text=app.helpers.removeTags(mergetag);if(mergetag_text.indexOf(' OR ')>-1){var parameter=mergetag_text.substring(12,mergetag_text.lastIndexOf(" OR ")).replace(/\}/g,'').replace(/\)/g,'');}else{var parameter=mergetag_text.substring(12,mergetag_text.lastIndexOf("})")).replace(/\}/g,'').replace(/\)/g,'');}
if(variant.score!==undefined&&variant.score!==null){$cf(element).html($cf(element).html().replace(mergetag,'<span data-merge="CURRENT_SCORE">'+variant.score+'</span>'));}else if(mergetag_text.indexOf('fallback')>-1){var fallback=mergetag_text.slice(mergetag_text.indexOf('fallback=')+'fallback='.length).replace(/\}/g,'').replace(/\)/g,'');$cf(element).html($cf(element).html().replace(mergetag,'<span data-merge="CURRENT_SCORE">'+fallback+'</span>'));}else if(mergetag_text.indexOf('fallback')==-1){$cf(element).html($cf(element).html().replace(mergetag,'<span data-merge="CURRENT_SCORE">0</span>'));}})}
$cf.each(personMap,function(dataname,property){if(match.indexOf(property)!==-1){var person_tags=mergetags.filter(function(mergetag){return mergetag.indexOf('person.'+property)>-1&&mergetag.indexOf('.fields.')==-1})
$cf.each(person_tags,function(index,mergetag){var mergetag='('+mergetag+')';var mergetag_text=app.helpers.removeTags(mergetag);if((convertflow.person!==undefined&&convertflow.person[dataname]!==undefined&&convertflow.person[dataname]!==null&&convertflow.person[dataname].length>0)||app.helpers.getParameterByName(property)!==""){if(app.helpers.getParameterByName(property)==""){$cf(element).html($cf(element).html().replace(mergetag,'<span data-merge="'+dataname+'">'+convertflow.person[dataname]+'</span>'));}else{$cf(element).html($cf(element).html().replace(mergetag,'<span data-merge="'+dataname+'">'+app.helpers.getParameterByName(property)+'</span>'));}}else if(mergetag_text.indexOf('fallback')>-1){var fallback=mergetag_text.slice(mergetag_text.indexOf('fallback=')+'fallback='.length).replace(/\}/g,'').replace(/\)/g,'');$cf(element).html($cf(element).html().replace(mergetag,'<span data-merge="'+dataname+'">'+fallback+'</span>'));}else if(mergetag_text.indexOf('fallback')==-1){$cf(element).html($cf(element).html().replace(mergetag,'<span data-merge="'+dataname+'"></span>'));}})}});if(match.indexOf('.fields.')!==-1){var field_tags=mergetags.filter(function(mergetag){return mergetag.indexOf('person.fields.')>-1})
$cf.each(field_tags,function(index,mergetag){var mergetag='('+mergetag+')';var mergetag_text=app.helpers.removeTags(mergetag);if(mergetag_text.indexOf(' OR ')>-1){var dataname=mergetag_text.substring(16,mergetag_text.lastIndexOf(" OR ")).replace(/\}/g,'').replace(/\)/g,'');}else{var dataname=mergetag_text.substring(16,mergetag_text.lastIndexOf("})")).replace(/\}/g,'').replace(/\)/g,'');}
if((convertflow.person&&convertflow.person.extra&&(convertflow.person.extra[dataname]||convertflow.person.extra[dataname]==0))||app.helpers.getParameterByName(dataname)!==""){if(app.helpers.getParameterByName(dataname)==""){$cf(element).html($cf(element).html().replace(mergetag,'<span data-merge="'+dataname+'">'+convertflow.person.extra[dataname]+'</span>'));}else{$cf(element).html($cf(element).html().replace(mergetag,'<span data-merge="'+dataname+'">'+app.helpers.getParameterByName(dataname)+'</span>'));}}else if(mergetag_text.indexOf('fallback')>-1){var fallback=mergetag_text.slice(mergetag_text.indexOf('fallback=')+'fallback='.length).replace(/\}/g,'').replace(/\)/g,'');$cf(element).html($cf(element).html().replace(mergetag,'<span data-merge="'+dataname+'">'+fallback+'</span>'));}else if(mergetag_text.indexOf('fallback')==-1){$cf(element).html($cf(element).html().replace(mergetag,'<span data-merge="'+dataname+'"></span>'));}})}
if(match.indexOf('parameter=')!==-1){var param_tags=mergetags.filter(function(mergetag){return mergetag.indexOf('parameter=')>-1})
$cf.each(param_tags,function(index,mergetag){var mergetag='('+mergetag+')';var mergetag_text=app.helpers.removeTags(mergetag);if(mergetag_text.indexOf(' OR ')>-1){var parameter=mergetag_text.substring(12,mergetag_text.lastIndexOf(" OR ")).replace(/\}/g,'').replace(/\)/g,'');}else{var parameter=mergetag_text.substring(12,mergetag_text.lastIndexOf("})")).replace(/\}/g,'').replace(/\)/g,'');}
if(app.helpers.getParameterByName(parameter)!==""){$cf(element).html($cf(element).html().replace(mergetag,app.helpers.getParameterByName(parameter)));}else if(mergetag_text.indexOf('fallback')>-1){var fallback=mergetag_text.slice(mergetag_text.indexOf('fallback=')+'fallback='.length).replace(/\}/g,'').replace(/\)/g,'');$cf(element).html($cf(element).html().replace(mergetag,fallback));}else if(mergetag_text.indexOf('fallback')==-1){$cf(element).html($cf(element).html().replace(mergetag,''));}})}
if(match.indexOf('window.')!==-1){var tags=mergetags.filter(function(mergetag){return mergetag.indexOf('window.')>-1})
$cf.each(tags,function(index,mergetag){var mergetag='('+mergetag+')';var mergetag_text=app.helpers.removeTags(mergetag);if(mergetag_text.indexOf(' OR ')>-1){var variableName=mergetag_text.substring(9,mergetag_text.lastIndexOf(" OR ")).replace(/\}/g,'').replace(/\)/g,'');}else{var variableName=mergetag_text.substring(9,mergetag_text.lastIndexOf("})")).replace(/\}/g,'').replace(/\)/g,'');}
var globalVariable=app.helpers.nestedGet(window,variableName);if(globalVariable&&(typeof globalVariable=='string'||typeof globalVariable=='number')){globalVariable=globalVariable+'';$cf(element).html($cf(element).html().replace(mergetag,globalVariable));}else if(mergetag_text.indexOf('fallback')>-1){var fallback=mergetag_text.slice(mergetag_text.indexOf('fallback=')+'fallback='.length).replace(/\}/g,'').replace(/\)/g,'');$cf(element).html($cf(element).html().replace(mergetag,fallback));}else if(mergetag_text.indexOf('fallback')==-1){$cf(element).html($cf(element).html().replace(mergetag,''));}})}
if(match.indexOf('cart.')!==-1){var cart_tags=mergetags.filter(function(mergetag){return mergetag.indexOf('cart.')>-1})
$cf.each(cart_tags,function(index,mergetag){var mergetag='('+mergetag+')';var mergetag_text=app.helpers.removeTags(mergetag);var merge_value;if(mergetag_text.indexOf(' OR ')>-1){var dataname=mergetag_text.substring(7,mergetag_text.lastIndexOf(" OR ")).replace(/\}/g,'').replace(/\)/g,'');}else{var dataname=mergetag_text.substring(7,mergetag_text.lastIndexOf("})")).replace(/\}/g,'').replace(/\)/g,'');}
if(convertflow.cart!==undefined&&typeof convertflow.cart=='object'&&dataname){var currency_character=(app.website.currency_character)?app.website.currency_character:'$';var cart_count_threshold;var cart_value_threshold;if(variant.options['cart-value-threshold']){cart_value_threshold=variant.options['cart-value-threshold'];}else{cart_value_threshold=(app.website.data['cart-value-threshold'])?app.website.data['cart-value-threshold']:50;}
if(dataname=='count'){merge_value=(convertflow.cart[dataname])?convertflow.cart[dataname]:'';}
if(dataname=='value'){merge_value=currency_character+((convertflow.cart[dataname])?convertflow.cart[dataname].toFixed(2):0);}
if(dataname=='value_threshold'&&cart_value_threshold){try{merge_value=currency_character+parseInt(cart_value_threshold).toFixed(2);}catch(err){console.log(err);};}
if(dataname=='value_threshold_gap'&&cart_value_threshold){try{var threshold=parseInt(cart_value_threshold);var cart_value=(convertflow.cart['value'])?convertflow.cart['value']:0;var gap=(threshold-cart_value).toFixed(2);if(gap<0){gap=0;}
merge_value=currency_character+gap;}catch(err){console.log(err);};}
if(dataname=='count_threshold'&&cart_count_threshold){try{merge_value=currency_character+parseInt(cart_count_threshold);}catch(err){console.log(err);};}
if(dataname=='count_threshold_gap'&&cart_count_threshold){try{var threshold=parseInt(cart_count_threshold);var cart_count=(convertflow.cart['count'])?convertflow.cart['count']:0;var gap=threshold-cart_count;if(gap<0){gap=0;}
merge_value=gap;}catch(err){console.log(err);};}}
if(merge_value){$cf(element).html($cf(element).html().replace(mergetag,'<span data-merge="'+dataname+'">'+merge_value+'</span>'));}else if(mergetag_text.indexOf('fallback')>-1){var fallback=mergetag_text.slice(mergetag_text.indexOf('fallback=')+'fallback='.length).replace(/\}/g,'').replace(/\)/g,'');$cf(element).html($cf(element).html().replace(mergetag,'<span data-merge="'+dataname+'">'+fallback+'</span>'));}else if(mergetag_text.indexOf('fallback')==-1){$cf(element).html($cf(element).html().replace(mergetag,'<span data-merge="'+dataname+'"></span>'));}});}
var services=app.services;$cf.each(services,function(index,service){if(match.indexOf(service)!==-1){var service_tags=mergetags.filter(function(mergetag){return mergetag.indexOf('person.'+service+'.')>-1})
$cf.each(service_tags,function(index,mergetag){var mergetag='('+mergetag+')';var mergetag_text=app.helpers.removeTags(mergetag);if(mergetag_text.indexOf(' OR ')>-1){var dataname=mergetag_text.substring(('person.'+service+'.').length+2,mergetag_text.lastIndexOf(" OR ")).replace(/\}/g,'').replace(/\)/g,'');}else{var dataname=mergetag_text.substring(('person.'+service+'.').length+2,mergetag_text.lastIndexOf("})")).replace(/\}/g,'').replace(/\)/g,'');}
if(convertflow.person!==undefined&&convertflow.person.data[service]!==undefined&&convertflow.person.data[service]['properties']&&$cf.grep(convertflow.person.data[service]['properties'],function(p){return(p.property==dataname||p.id==dataname||p.name==dataname)&&p.value}).length!==0){var property=$cf.grep(convertflow.person.data[service]['properties'],function(p){return(p.property==dataname||p.id==dataname||p.name==dataname)})[0].value
$cf(element).html($cf(element).html().replace(mergetag,'<span data-merge="'+dataname+'">'+property+'</span>'));}else if(mergetag_text.indexOf('fallback')>-1){var fallback=mergetag_text.slice(mergetag_text.indexOf('fallback=')+'fallback='.length).replace(/\}/g,'').replace(/\)/g,'');$cf(element).html($cf(element).html().replace(mergetag,'<span data-merge="'+dataname+'">'+fallback+'</span>'));}else if(mergetag_text.indexOf('fallback')==-1){$cf(element).html($cf(element).html().replace(mergetag,'<span data-merge="'+dataname+'"></span>'));}})}})}})})}
app.ctas.initialize=function(cta,variant,embed,callback){app.variants.handleLoad({cta:cta,variant:variant,embed:embed});app.ctas.style(cta,variant,embed)
app.ctas.brandStyle(cta,variant,embed)
app.ctas.poweredby(cta,variant,embed)
app.ctas.consentMessages(cta,variant,embed)
app.helpers.plugins();if((cta.cta_type=='inline'||cta.cta_type=='page')==false){app.ctas.trigger(cta,variant,embed)
app.ctas.bindClose(cta,variant,embed)}
app.ctas.profile(cta,variant,embed)
$cf(embed).find('.cf-section').each(function(index,section){var section_id=$cf(section).attr('section-id')
if(cta.cta_type=='overlay'&&cta.overlay_type=='splash'&&(variant.options['splash-type']==undefined||variant.options['splash-type']=='full')){$cf(section).find('.cf-column').css('min-height',$cf(window).height())}});app.ctas.mergeTags(cta,variant,embed);app.ctas.forms(cta,variant,embed);app.ctas.buttons(cta,variant,embed);app.ctas.surveys(cta,variant,embed);app.ctas.timers(cta,variant,embed);app.ctas.progressBars(cta,variant,embed);app.ctas.fonts(cta,variant,embed);if(cta.cta_type=='inline'||cta.cta_type=='page'){var step=$cf.map(variant.steps,function(step){if(step.position==1)return step})[0]
if(step.options&&step.options['script']){try{$cf('body').append(step.options['script']);}catch(e){console.log(e.message,e.stack);};}
app.ctas.initializeStep(cta,variant,step,embed);if(cta.cta_type=='page'){var tracking_id=app.website.data['google-analytics-tracking-id'];if(tracking_id&&!window.gtag){var gtag_path='https://www.googletagmanager.com/gtag/js?id='+tracking_id;app.helpers.loadScript(gtag_path);window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config',tracking_id);}}
if(app.live==true){app.ctas.track({event_type:'View',variant_id:variant.id,step_id:step.id},cta);var trackExternalEvent=function(){app.visitors.fireEvent("cfView",{cta:cta,variant:variant,step:step,});}
if(cta.cta_type!=='page'){trackExternalEvent();}else{$cf(window).load(function(){trackExternalEvent();});}}
if(cta.cta_type=='page'&&window.location.hash&&$cf(window.location.hash).length>0){$cf('html, body').animate({scrollTop:$cf(window.location.hash).offset().top},0);}}
if(callback!==undefined){callback(cta,variant,embed);}}
app.ctas.fonts=function(cta,variant,embed){var checkAndLoadFonts=function(embed){$cf(embed).find('[style*="font-family"],[data-font]').each(function(i,dom_element){var full_font_family=$cf(dom_element).attr("data-font")||dom_element.style.fontFamily||$cf(dom_element).css("font-family");if(full_font_family){$cf(full_font_family.split(',')).each(function(i,font_family){var font_family=font_family.replace(/['"]+/g,'').trim();if(font_family&&$cf.inArray(font_family,["Your site font","Helvetica Nueue",'Helvetica Neue','Helvetica-Nueue','Helvetica',"Georgia",'Verdana','Times','system-ui','sans-serif','serif','inherit','Arial','sans-serif','San-serif'])==-1&&convertflow.fonts[font_family]==undefined){convertflow.fonts[font_family]=true;WebFont.load({google:{families:[font_family,(font_family+':bold')]}})}});}});}
if(window['WebFont']==undefined){if(window.convertflow.fontsLoaded==undefined){window.convertflow.fontsLoaded=true;app.helpers.cachedScript('https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js').done(function(){$cf(document).trigger('cfFontReady');checkAndLoadFonts(embed);});}else{$cf(document).on('cfFontReady',function(){checkAndLoadFonts(embed);});}}else{checkAndLoadFonts(embed);}}
app.ctas.profile=function(cta,variant,embed){var brand=app.website.brand;var user_id=$cf(embed).find('.cf-profile-name').attr('data-user-id')||$cf(embed).find('.cf-profile-name').attr('user-id');var user=(user_id!==undefined)?app.website.profiles[parseInt(user_id)]:undefined;$cf(embed).find('.cf-profile-title').each(function(index,span){if(brand!==null&&brand.length>0){$cf(span).text(brand);}})
if(user!==undefined){$cf(embed).find('.cf-profile-name').each(function(index,span){if(user.name!==null&&user.name.length>0){var name=user.name
if(user.lastname!==null&&user.lastname.length>0){var name=name+' '+user.lastname}
$cf(span).text(name);}})
$cf(embed).find('.cf-profile-img').each(function(index,div){var image=$cf(div).find('img')
if($cf(image).attr('src')!==user.avatar){$cf(image).attr('src',user.avatar)}})}}
app.ctas.poweredby=function(cta,variant,embed){if(app.website.powered_by==true&&app.live==true){$cf('.cf-powered-by').show()}}
app.ctas.consentMessages=function(cta,variant,embed){if(app.website.privacy_message.length>0){var privacy_message=$cf('<div />').html(app.website.privacy_message).text();$cf(embed).find('.cf-privacy-message').text(privacy_message);}
if(app.website.privacy_link.length>0){var privacy_link=app.website.privacy_link
if(app.website.privacy_link.indexOf('http')==-1){var privacy_link='http://'+privacy_link}
$cf(embed).find('.cf-privacy-link').attr('href',privacy_link).show();}
if(app.website.privacy_link_text.length>0){var privacy_link_text=$cf('<div />').html(app.website.privacy_link_text).text();$cf(embed).find('.cf-privacy-link').html('<br>'+privacy_link_text)}
if(app.website.terms_link.length>0){var terms_link=app.website.terms_link
if(app.website.terms_link.indexOf('http')==-1){var terms_link='http://'+terms_link}
$cf(embed).find('.cf-terms-link').attr('href',terms_link).show();}
if(app.website.terms_link_text.length>0){var terms_link_text=$cf('<div />').html(app.website.terms_link_text).text();$cf(embed).find('.cf-terms-link').text(terms_link_text);}
if(app.website.marketing_consent.length>0){var marketing_consent=$cf('<div />').html(app.website.marketing_consent).text();$cf(embed).find('.cf-marketing-label').html(marketing_consent)}
if(app.website.sms_consent.length>0){var smsConsentMessage=app.website.sms_consent;if(app.website.brand){smsConsentMessage=smsConsentMessage.replace('{BRAND}',app.website.brand);}else{smsConsentMessage=smsConsentMessage.replace('{BRAND}',window.location.hostname);}
var sms_consent=$cf('<div />').html(smsConsentMessage).text();$cf(embed).find('.cf-sms-message').html(sms_consent)}}
app.ctas.resetCTAs=function(){var ctas=window.convertflow.ctas;var html_style=$cf('html').attr('style');if(ctas){$cf.each(Object.keys(ctas),function(index,cta_id){if(ctas[cta_id]){ctas[cta_id]['fired']=undefined
ctas[cta_id]['clicktriggered']=undefined
if(ctas[cta_id]['timeout']){clearTimeout(ctas[cta_id]['timeout']);ctas[cta_id]['timeout']=undefined;}}})}
if(convertflow.barTriggered==true&&html_style&&html_style.indexOf('padding-top')>-1&&html_style.indexOf('transition')>-1){$cf('html').css('transition','').css('padding-top','')}
convertflow.hookTriggered=undefined;convertflow.overlayTriggered=undefined;convertflow.twoTapTriggered=undefined;convertflow.barTriggered=undefined;convertflow.snippetsLoaded=undefined;convertflow.areas={};$cf('.convertflow-cta, .cf-prehook-popup').remove()}
app.ctas.timers=function(cta,variant,embed){var getTimeRemaining=function(endtime){var t=Date.parse(endtime)-Date.parse(new Date());var seconds=Math.floor((t/1000)%60);var minutes=Math.floor((t/1000/60)%60);var hours=Math.floor((t/(1000*60*60))%24);var days=Math.floor(t/(1000*60*60*24));return{total:t,days:days,hours:hours,minutes:minutes,seconds:seconds,};}
var initializeClock=function(step,section,element,clock,endtime){var daysSpan=clock.querySelector(".cf-timer-unit[data-unit-type='days'] .cf-timer-unit-number");var hoursSpan=clock.querySelector(".cf-timer-unit[data-unit-type='hours'] .cf-timer-unit-number");var minutesSpan=clock.querySelector(".cf-timer-unit[data-unit-type='minutes'] .cf-timer-unit-number");var secondsSpan=clock.querySelector(".cf-timer-unit[data-unit-type='seconds'] .cf-timer-unit-number");var updateClock=function(){var t=getTimeRemaining(endtime);if(daysSpan){var daysDiv=clock.querySelector(".cf-timer-unit[data-unit-type='days']");daysSpan.innerHTML=t.days>0?t.days:0;if(t.days==0){daysDiv.classList.add("cf-timer-hidden");}else{daysDiv.classList.remove("cf-timer-hidden");}}
if(hoursSpan){var hoursDiv=clock.querySelector(".cf-timer-unit[data-unit-type='hours']");hoursSpan.innerHTML=t.hours>0?t.hours:0;if(t.days==0&&t.hours==0){hoursDiv.classList.add("cf-timer-hidden");}else{hoursDiv.classList.remove("cf-timer-hidden");}}
if(minutesSpan){var minutesDiv=clock.querySelector(".cf-timer-unit[data-unit-type='minutes']");minutesSpan.innerHTML=t.minutes>0?t.minutes:0;if(t.days==0&&t.hours==0&&t.minutes==0){minutesDiv.classList.add("cf-timer-hidden");}else{minutesDiv.classList.remove("cf-timer-hidden");}}
if(secondsSpan){var secondsDiv=clock.querySelector(".cf-timer-unit[data-unit-type='seconds']");secondsSpan.innerHTML=t.seconds>0?t.seconds:0;}
if(t.total<=0){clearInterval(timeinterval);if(element.options["timer-end-action"]=="message"){$cf(clock).find(".cf-timer-inner").hide();$cf(clock).find(".cf-timer-message").show();}else if(element.options["timer-end-action"]=="hide"){$cf(clock).hide();}else if(element.options["timer-end-action"]=="step"&&element.options["timer-end-step"]&&variant.steps[element.options["timer-end-step"]]){if($cf('.cf-step[data-step-id="'+step.id+'"]').is(':visible')==true){app.ctas.performConfirmationActionStep({embed:embed,cta:cta,variant:variant,step:step,section:section,element:element,step_override:element.options["timer-end-step"]});}}}}
updateClock();var timeinterval=setInterval(updateClock,1000);}
$cf.each(variant.steps,function(step_id,step){$cf.each(step.sections,function(section_id,section){$cf.each(section.elements,function(element_id,element){if(element.element_type=='timer'){var clock=$cf(embed).find('.cf-timer[data-id="'+element.id+'"]')[0];var deadline;var broadcast=app.website.broadcasts[cta.broadcast_id];if(element.options['timer-type']=='static'&&element.options['timer-broadcast-date']=="true"&&broadcast&&broadcast.quick==false&&broadcast.timeframe==true&&broadcast.range_end){deadline=new Date(parseInt(broadcast.range_end));}else if(element.options['timer-type']=='static'){if(element.options['timer-date-formatted']){deadline=new Date(Date.parse(element.options['timer-date-formatted']));;}else{deadline=new Date();}}else if(element.options['timer-type']=='daily'){var hours=element.options['timer-hours']||element.options['timer-hours']==0?parseInt(element.options['timer-hours']):23;var minutes=element.options['timer-minutes']||element.options['timer-minutes']==0?parseInt(element.options['timer-minutes']):59;var seconds=element.options['timer-seconds']||element.options['timer-seconds']==0?parseInt(element.options['timer-seconds']):59;deadline=new Date(new Date().setHours(hours,minutes,seconds,999))}else if(element.options['timer-type']=='relative'){var d=new Date();var timerDays=(element.options['timer-days']||element.options['timer-days']==0?parseInt(element.options['timer-days']):0);var timerHours=(element.options['timer-hours']||element.options['timer-hours']==0?parseInt(element.options['timer-hours']):23);var timerMinutes=(element.options['timer-minutes']||element.options['timer-minutes']==0?parseInt(element.options['timer-minutes']):59);var timerSeconds=(element.options['timer-seconds']||element.options['timer-seconds']==0?parseInt(element.options['timer-seconds']):59);var days=d.getDate()+timerDays;var hours=d.getHours()+timerHours;var minutes=d.getMinutes()+timerMinutes;var seconds=d.getSeconds()+timerSeconds;if(false==(timerDays==0&&timerHours==0&&timerMinutes==0&&timerSeconds==0)){deadline=new Date(new Date(new Date().setDate(days)).setHours(hours,minutes,seconds,999));}else{deadline=new Date(new Date(new Date().setDate(-2)).setHours(0,0,0,999));}}
if(clock&&deadline){if(deadline>new Date()){initializeClock(step,section,element,clock,deadline);}else if(element.options["timer-end-action"]=="message"){$cf(clock).find(".cf-timer-inner").hide();$cf(clock).find(".cf-timer-message").show();}else if(element.options["timer-end-action"]=="hide"){$cf(clock).hide();}}}});});});}
app.ctas.progressBars=function(cta,variant,embed){$cf.each(variant.steps,function(step_id,step){$cf.each(step.sections,function(section_id,section){$cf.each(section.elements,function(element_id,element){if(element.element_type=='progress'){var elementDiv=$cf(embed).find('.cf-element[data-element-id="'+element_id+'"]');var progressInner=$cf(elementDiv).find('.cf-progress-inner');var stepCount=Object.keys(variant.steps).length;if(element.options['progress-type']=='dynamic'){var stepDiv=$cf(elementDiv).parents(".cf-step")[0];var stepPosition=parseInt($cf(stepDiv).attr("data-step-position"));var previousExcludedSteps=$cf(embed).find(".cf-step[data-progress-bar-count='false']").filter(function(i,stepDiv){return stepDiv.getAttribute("data-step-position")<stepPosition}).length
stepPosition=stepPosition-previousExcludedSteps;var stepCount=$cf(embed).find(".cf-step:not([data-progress-bar-count='false'])").length;var innerProgressWidth=(100*stepPosition)/stepCount;$cf(progressInner).css('width',(innerProgressWidth>100?'100':innerProgressWidth)+'%');var progressMessageStepProgress=$cf(elementDiv).find(".cf-progress-step-progress")[0];if(progressMessageStepProgress){if(stepPosition>stepCount){var stepProgressText=stepCount+'/'+stepCount;}else{var stepProgressText=stepPosition+'/'+stepCount;}
$cf(progressMessageStepProgress).text(stepProgressText);}}
if(element.options['progress-type']=='cart'&&convertflow.cart!==undefined&&typeof convertflow.cart=='object'){var currency_character=(app.website.currency_character)?app.website.currency_character:'$';var cart_value=(convertflow.cart['value'])?convertflow.cart['value']:0;var cart_value_threshold;var percentageWidth=0;if(variant.options['cart-value-threshold']){cart_value_threshold=parseInt(variant.options['cart-value-threshold']);}else{cart_value_threshold=(app.website.data['cart-value-threshold'])?parseInt(app.website.data['cart-value-threshold']):50;}
if(cart_value_threshold!==undefined){percentageWidth=(cart_value*100)/cart_value_threshold;if(percentageWidth>100){percentageWidth=100;}
$cf(progressInner).css('min-width',percentageWidth+'%');}}}});});});};app.ctas.style=function(cta,variant,embed){var embed_css={width:"100%"};if(variant.options["container-width"]=='2560px'){variant.options["container-width"]='100%';}
if(cta.cta_type=="inline"){if(variant.options["cta-position"]=="center"||(variant.options["cta-position"]==undefined&&(cta.inline_type=="sidebar"||cta.inline_type=="bumper"))){embed_css["margin-left"]="auto";embed_css["margin-right"]="auto";}
if(variant.options["cta-position"]=="left"){embed_css["margin-right"]="auto";}
if(variant.options["cta-position"]=="right"){embed_css["margin-left"]="auto";}
if(cta.inline_type=="embed"){embed_css["max-width"]=variant.options["container-width"];}else{if(cta.inline_type=="sidebar"){embed_css["max-width"]="310px";}
if(cta.inline_type=="bumper"){embed_css["max-width"]="900px";}}}
if(cta.cta_type!=="inline"){var popup_css={};var trigger=$cf(embed).find('div[id="cta_'+cta.id+'"]');$cf(trigger).addClass("cf-has-transitions cf-is-hidden");var trigger_css={};var container=trigger;var close_css={};if(cta.cta_type!=="page"&&$cf(embed).find(".cf-close").length==0){$cf(container).prepend('<div data-cta="'+cta.id+'" class="cf-cta-close">x</div>');var close=$cf(embed).find(".cf-cta-close");}
var powered_by=$cf('<div class="cf-powered-by" style="display: none; bottom: 0; padding: 7px; padding-top: 5px; width: 100%; text-align: center; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; height: 30px; line-height: 22px !important;">'+
'<a rel="nofollow" href="'+
app.powered_by_link+
'" target="_blank" style="cursor: pointer; font-family: Helvetica Neue, Helvetica, Arial, sans-serif !important; letter-spacing: 0.5px !important; font-smoothing: antialiased !important; -moz-osx-font-smoothing: auto !important; -webkit-font-smoothing: antialiased !important;">'+
'<div class="cf-powered-by-inner" style="display: block !important; margin-left: auto !important; margin-right: auto !important; max-width: 143px !important; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: inherit !important; color: inherit !important;">'+
'<span style="float: left; font-size: 11px; font-family: inherit !important; color: inherit !important; letter-spacing: inherit !important;">Crafted in</span>'+
'<img style="width: 11px !important; transition: all 0.2s ease !important; left: 0 !important; right: 0 !important; float: left !important; margin-left: 4px !important; margin-right: auto !important; margin-top: 6px !important;" />'+
'<span style="float: right; font-size: 11px; font-family: inherit !important; color: inherit !important; letter-spacing: inherit !important;">ConvertFlow</span>'+
"</div>"+
"</a>"+
"</div>");var link=$cf(powered_by).find("a").attr("href");if(link.indexOf("https://www.convertflow.com/")>-1){var link=link.replace("https://www.convertflow.com/","");}
if(link.indexOf("https://app.convertflow.com/refer")>-1){var link=link.replace("https://app.convertflow.com/refer","");}
if(link.indexOf("utm_campaign=default")>-1){var link=link.replace("default",cta.cta_type);}
if(cta.cta_type=="page"){var link="/landing-pages"+link;}
if(cta.cta_type=="overlay"){var link="/popups"+link;}
if(cta.cta_type=="hook"){var link="/messages"+link;}
if(cta.cta_type=="bar"){var link="/sticky-bars"+link;}
var link=link+"&utm_content="+cta.id;$cf(powered_by).find("a").attr("href","https://www.convertflow.com"+encodeURI(link));if(cta.cta_type=="page"||cta.cta_type=="bar"||(cta.cta_type=="overlay"&&["dark","custom"].includes(variant.options["container-background"]))){$cf(powered_by).css({background:"rgba(22, 31, 49, 0.85)",});$cf(powered_by).find("a").each(function(){$cf(this)[0].style.setProperty("color","#fff","important");});$cf(powered_by).find("img").attr("src","https://img.convertflow.co/static/convertflow-crafted-in-icon-white.png");}else{$cf(powered_by).css({background:cta.cta_type=="overlay"||(cta.cta_type=="hook"&&$cf(window).width()<=480)?"rgba(255, 255, 255, 0.95)":"none",});$cf(powered_by).find("a").each(function(){$cf(this)[0].style.setProperty("color","#bbb","important");});$cf(powered_by).find("img").attr("src","https://img.convertflow.co/static/convertflow-crafted-in-icon-grey.png");}
if(cta.cta_type=="overlay"){$cf(powered_by).css({position:"fixed","z-index":"100000",cursor:"pointer",});$cf.extend(popup_css,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%","overflow-y":"auto","z-index":"100001",opacity:"0",transition:"opacity 0.2 ease",});if(variant.options["container-background"]=="dark"){popup_css["background"]="rgba(15, 21, 33, 0.89)";}else if(variant.options["container-background"]=="light"){popup_css["background"]="rgba(250, 250, 255, 0.88)";}else if(variant.options["container-background"]=="custom"&&variant.options["container-background-color"]){popup_css["background"]=variant.options["container-background-color"];}else{popup_css["background"]="rgba(15, 21, 33, 0.89)";}
if(cta.overlay_type=="boxed"){var boxed_style={};if($cf(window).width()>480){$cf.extend(boxed_style,{position:"absolute","margin-left":"auto","margin-right":"auto","margin-top":"4%",cursor:"initial","z-index":"99998",left:"0",right:"0","margin-bottom":"4%",});boxed_style["max-width"]=variant.options["container-width"];if(app.helpers.IE()){boxed_style["width"]=variant.options["container-width"];}}else{$cf.extend(boxed_style,{position:"absolute","margin-left":"auto","margin-right":"auto","margin-top":"10%","margin-bottom":"4%","max-width":"90%",width:"100%","min-width":"310px",cursor:"initial","z-index":"99998",left:"0",right:"0",});close_css["top"]="1%";}
if(variant.options["container-width"]=="100%"){boxed_style["margin-top"]="0px";boxed_style["margin-bottom"]="0px";boxed_style["max-width"]="100%";}
$cf.extend(trigger_css,boxed_style);}
if(cta.overlay_type=="splash"){var splash_style={};if($cf(window).width()>480){$cf.extend(trigger_css,{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",cursor:"initial","z-index":"99998",});}else{$cf.extend(close_css,{top:"2%",});}}
if(variant.options["close-style"]==undefined||variant.options["close-style"]=="default"){var close_style={position:"absolute",right:"10px",top:"10px",width:"25px",height:"25px","border-radius":"25px","text-align":"center","line-height":"22px","font-size":"19px","font-family":"Verdana, Arial, sans-serif",cursor:"pointer","z-index":"99999","box-shadow":"rgba(0, 0, 0, 0.2) 0px 3px 50px 0px",};close_style["background"]="rgba(242, 245, 249, 1)";close_style["color"]="rgb(103 111 132)";$cf.extend(close_css,close_style);}
var powered_by_div=embed;}
if(cta.cta_type=="hook"){if($cf(window).width()>480){$cf(powered_by).css({position:"absolute","z-index":"100000",cursor:"pointer","max-width":"100%",bottom:"0px","border-radius":"0px 0px 3px 3px",});if(cta.hook_type!=="full"){var corner_style={};if(app.website.powered_by==true){corner_style["bottom"]="0px";corner_style["padding-bottom"]="30px";}else{corner_style["padding-bottom"]="0px";corner_style["bottom"]="20px";}
$cf.extend(corner_style,{position:"fixed","z-index":"99999",});if(cta.hook_type=="vertical"&&(variant.options["container-width"]==undefined||variant.options["container-width"]=="310px")){$cf.extend(corner_style,{width:"310px",});}
if(cta.hook_type=="horizontal"||(cta.hook_type=="vertical"&&variant.options["container-width"]=="500px")){$cf.extend(corner_style,{width:"500px",});}
if(cta.hook_type=="vertical"&&variant.options["container-width"]){$cf.extend(corner_style,{width:variant.options["container-width"],});}
if(variant.options["cta-position"]==undefined||variant.options["cta-position"]=="right"){corner_style["right"]="20px";}
if(variant.options["cta-position"]=="left"){corner_style["left"]="20px";}
if(variant.options["cta-position"]=="center"){corner_style["right"]="0";corner_style["left"]="0";corner_style["margin-left"]="auto";corner_style["margin-right"]="auto";}
var max_height=window.innerHeight-80;$cf(embed).children('div[id="cta_'+cta.id+'"]').children(".cf-container").css({"max-height":max_height+"px","overflow-y":"auto",});if(variant.options["close-style"]==undefined||variant.options["close-style"]=="default"){var close_style={position:"absolute",right:"5px",top:"5px",width:"20px",height:"20px","border-radius":"20px","text-align":"center","line-height":"18px","font-size":"14px","font-family":"Verdana, Arial, sans-serif",cursor:"pointer","z-index":"99999",};close_style["background"]="rgba(242, 245, 249, 1)";close_style["color"]="rgb(103 111 132)";}
$cf.extend(trigger_css,corner_style);var powered_by_div=trigger;}
if(cta.hook_type=="full"){$cf(powered_by).css({"margin-left":"-20px","max-width":"390px",});$cf.extend(popup_css,{position:"fixed",top:"0",right:"0",width:"100%","max-width":"390px",height:"100%","overflow-y":"auto","z-index":"100000",opacity:"0",transition:"opacity 0.2 ease","box-shadow":"rgba(0, 0, 0, 0.290196) 0px 2px 5px 0px",padding:"0px 20px","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box","box-sizing":"border-box",});if(variant.options["container-background"]!=="dark"){popup_css["background"]="rgba(250, 250, 255, 0.88)";}else{popup_css["background"]="rgba(15, 21, 33, 0.89)";}
if(variant.options["close-style"]==undefined||variant.options["close-style"]=="default"){var close_style={position:"absolute",right:"3%",top:"1%",width:"25px",height:"25px","border-radius":"20px","text-align":"center","line-height":"22px","font-size":"16px","font-family":"Verdana, Arial, sans-serif",cursor:"pointer","z-index":"99999",};if(variant.options["container-background"]!=="dark"){close_style["background"]="#f8fafd";close_style["color"]="#8994b0";}else{close_style["background"]="#202631";close_style["color"]="#8994b0";}}
$cf.extend(trigger_css,{width:"310px",position:"relative","margin-top":"16%","padding-bottom":"50px","margin-left":"auto","margin-right":"auto","margin-bottom":"4%",});var powered_by_div=embed;}}
if($cf(window).width()<=480){$cf.extend(popup_css,{"overflow-y":"auto","z-index":"100000",opacity:"0",transition:"opacity 0.2 ease"});var max_height=window.innerHeight-80;$cf(embed).children('div[id="cta_'+cta.id+'"]').children(".cf-container").css({"max-height":max_height+"px","overflow-y":"auto",});$cf.extend(trigger_css,{"z-index":"100000",position:"fixed",bottom:"0",right:"0",left:"0",right:"0",width:"90%","min-width":"310px","max-height":"100%","margin-left":"auto","margin-right":"auto","margin-bottom":"30px",});$cf(powered_by).css({position:"fixed",background:'none'});$cf(powered_by).each(function(){$cf(this)[0].style.setProperty("margin-left","inherit","important");});var powered_by_div=embed;if(variant.options["close-style"]==undefined||variant.options["close-style"]=="default"){var close_style={position:"absolute",right:"5px",top:"5px",width:"25px",height:"25px","border-radius":"20px","text-align":"center","line-height":"22px","font-size":"16px","font-family":"Verdana, Arial, sans-serif",cursor:"pointer","z-index":"99999",};close_style["background"]="rgba(242, 245, 249, 1)";close_style["color"]="rgb(103 111 132)";}
$cf(embed).find(".cf-profile").css("max-width","100%");$cf(powered_by).css("max-width","100%").css("margin-left","0px");$cf(powered_by).find(".cf-powered-by img").css("opacity","1");$cf(powered_by).find(".cf-powered-by a").css("color","#fff");}
$cf.extend(close_css,close_style);}
if(cta.cta_type=="page"){var powered_by_div=embed;}
if(cta.cta_type=="page"||cta.cta_type=="bar"){var icon=$cf(powered_by).find("img").each(function(){$cf(this)[0].style.setProperty("margin-right","2px","important");$cf(this)[0].style.setProperty("margin-top","4px","important");if(cta.cta_type=="page"){$cf(this)[0].style.setProperty("margin-left","2px","important");}});$cf(powered_by).find(".cf-powered-by-inner").prepend(icon);$cf(powered_by).find("span").first().remove();$cf(powered_by).find("span").text("Crafted in ConvertFlow");$cf(powered_by).find("span").each(function(){$cf(this)[0].style.setProperty("font-size","10px","important");});$cf(powered_by).find(".cf-powered-by-inner").each(function(){$cf(this)[0].style.setProperty("max-width","135px","important");});$cf(powered_by).css({padding:"3px",width:"147px",height:"25px",position:"fixed","z-index":"100000",cursor:"pointer",left:"0",right:"initial","line-height":"18px",background:"rgba(22, 31, 49, 0.60)","border-radius":"0px 5px 0px 0px",top:"initial",bottom:"0",});}
if(cta.cta_type=="bar"){$cf.extend(popup_css,{position:"fixed",right:"0",width:"100%","max-width":"100%","z-index":"99998",display:"none","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box","box-sizing":"border-box",});if(variant.options["bar-position"]=="top"){popup_css["top"]="0";if(variant.options["bar-fixed"]=='false'){popup_css['position']='absolute';}
$cf("html").css("transition","padding-top 0.3s").css("-webkit-transition","padding-top 0.3s");}else{popup_css["bottom"]="0";}
if(variant.options["bar-fixed"]!=='false'){var max_height=window.innerHeight;$cf(embed).children('div[id="cta_'+cta.id+'"]').children(".cf-container").css({"max-height":max_height+"px","overflow-y":"auto",}).scrollTop(0);}
if(variant.options["container-width"]){popup_css['max-width']=variant.options["container-width"];}
if(variant.options["cta-position"]=="right"){popup_css["right"]="0px";}
if(variant.options["cta-position"]=="left"){popup_css["left"]="0px";}
if(variant.options["cta-position"]==undefined||variant.options["cta-position"]=="center"){popup_css["right"]="0";popup_css["left"]="0";popup_css["margin-left"]="auto";popup_css["margin-right"]="auto";}
var close_style={position:"fixed",right:"5px",top:"5px",width:"20px",height:"20px","border-radius":"20px","text-align":"center","line-height":"18px","font-size":"14px","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","font-family":"Verdana, Arial, sans-serif",cursor:"pointer","z-index":"99999",};close_style["background"]="rgba(242, 245, 249, 1)";close_style["color"]="rgb(103 111 132)";if($cf(window).width()<=480){close_style["top"]="10px";close_style["right"]="10px";}
$cf(powered_by).find("span").hide();if(variant.options["bar-position"]=="top"){$cf(powered_by).css({"border-radius":"0px 0px 5px 0px",top:"0",bottom:"initial",});}else{$cf(powered_by).css({"border-radius":"0px 5px 0px 0px",top:"initial",bottom:"0",});}
$cf(powered_by).css("width","25px");$cf(powered_by).css("position","absolute");$cf(powered_by).on("mouseover",function(){$cf(this).find("span").show();$cf(powered_by).css("width","141px");}).on("mouseleave",function(){$cf(this).find("span").hide();$cf(powered_by).css("width","25px");});var powered_by_div=embed;$cf.extend(close_css,close_style);}
$cf(powered_by_div).append(powered_by);$cf(embed).css(popup_css);$cf(trigger).css(trigger_css);if(close){$cf(close).css(close_css);}}
if(cta.cta_type=="page"||((cta.cta_type=="inline"||cta.cta_type=="overlay")&&variant["options"]["container-width"]=="100%")){$cf.each(variant.steps,function(step_id,step){$cf.each(step.sections,function(section_id,section){if(section.options["structure"]["browser-height"]=="true"&&$cf(window).width()>1024){$cf('.cf-section[section-id="'+section_id+'"]').attr("data-browser-height","true");$cf('.cf-section[section-id="'+
section_id+
'"], .cf-column[section-id="'+
section_id+
'"]').each(function(i,section_div){$cf(section_div).css("min-height",$cf(window).height()+"px");});}});});}
$cf(embed).css(embed_css);};app.ctas.trigger=function(cta,variant,embed,trigger_type_override){var trigger_cookie="viewedCta"+cta.id;var trigger_type=variant.options.trigger_type;var step=$cf.map(variant.steps,function(step){if(step.position==1)return step;})[0];var supression=cta.cta_type+"Triggered";if(variant.options["aggressive"]=="true"){app.helpers.deleteCookie(trigger_cookie);}
var fire=function(fire_trigger_type){if((convertflow.ctas[cta.id]["clicktriggered"]==undefined&&(convertflow[supression]==undefined||cta.broadcast_id==convertflow[supression]||fire_trigger_type=="click"))||(convertflow.ctas[cta.id]["clicktriggered"]==true&&fire_trigger_type=="click")){$cf(embed).css({display:"block",opacity:"1"});$cf(embed).find('div[id="cta_'+cta.id+'"]').removeClass("cf-is-hidden");if(cta.cta_type=="hook"){$cf(embed).find('div[id="cta_'+cta.id+'"]').addClass("slide-up");}else if(cta.cta_type=="bar"){if(variant.options["bar-position"]=="bottom"){$cf(embed).find('div[id="cta_'+cta.id+'"]').addClass("slide-up");}else{var barHeight=$cf(embed).find('div[id="cta_'+cta.id+'"]').outerHeight();$cf("html").css("padding-top",barHeight+"px");$cf(embed).find('div[id="cta_'+cta.id+'"]').addClass("slide-down");}}else{$cf(embed).find('div[id="cta_'+cta.id+'"]').addClass("is-visible");}
if(convertflow.ctas[cta.id]["fired"]==undefined){convertflow.ctas[cta.id]["fired"]=true;if(step.options&&step.options["script"]){try{$cf("body").append(step.options["script"]);}catch(e){console.log(e.message,e.stack);}}
convertflow[supression]=true;if(app.live==true&&step.tracked!==true){step.tracked=true;app.ctas.track({event_type:"View",variant_id:variant.id,step_id:step.id,},cta);app.visitors.fireEvent("cfView",{cta:cta,variant:variant,step:step,});}
app.ctas.initializeStep(cta,variant,step,embed);}}};this.delayed=function(){if(variant.options.delay!==undefined){var delay=parseInt(variant.options.delay)*1000;}else{var delay=0*1000;}
convertflow.ctas[cta.id]['timeout']=setTimeout(function(){if(convertflow.ctas[cta.id]["fired"]!==true){fire("delayed");convertflow.ctas[cta.id]['timeout']=undefined;}},delay);};this.scroll=function(){var length=$cf(document).height();if(variant.options.scroll!==undefined){var scroll=parseInt(variant.options.scroll);}else{var scroll=0;}
var target=(scroll*length)/100;$cf(window).off("scroll.cta"+cta.id).on("scroll.cta"+cta.id,function(){if($cf(window).scrollTop()>=target&&$cf(embed).css("display")!="block"){if(convertflow.ctas[cta.id]["fired"]!==true)fire("scroll");}});};this.exit=function(){if($cf(window).width()>480){var config=config||{},aggressive=config.aggressive||false,sensitivity=setDefault(config.sensitivity,20),timer=setDefault(config.timer,1000),delay=setDefault(config.delay,0),callback=config.callback||function(){},cookieExpire=setDefaultCookieExpire(config.cookieExpire)||"",cookieDomain=config.cookieDomain?";domain="+location.hostname.split(".").slice(-2).join("."):"",cookieName=config.cookieName?config.cookieName:trigger_cookie,sitewide=config.sitewide===true?";path=/":"",_delayTimer=null,_html=document.documentElement;trigger_type=config.trigger_type;animation=config.animation;function setDefault(_property,_default){return typeof _property==="undefined"?_default:_property;}
function setDefaultCookieExpire(days){var ms=days*24*60*60*1000;var date=new Date();date.setTime(date.getTime()+ms);return "; expires="+date.toUTCString();}
function handleMouseleave(e){if(e.clientY>sensitivity||(checkCookieValue(cookieName,"true")&&!aggressive))
return;_delayTimer=setTimeout(_fireAndCallback,delay);}
function handleMouseenter(e){if(_delayTimer){clearTimeout(_delayTimer);_delayTimer=null;}}
var disableKeydown=false;function handleKeydown(e){if(disableKeydown||(checkCookieValue(cookieName,"true")&&!aggressive))
return;else if(!e.metaKey||e.keyCode!==76)return;disableKeydown=true;_delayTimer=setTimeout(_fireAndCallback,delay);}
function checkCookieValue(cookieName,value){return parseCookies()[cookieName]===value;}
function parseCookies(){var cookies=document.cookie.split("; ");var ret={};for(var i=cookies.length-1;i>=0;i--){var trigger=cookies[i].split("=");ret[trigger[0]]=trigger[1];}
return ret;}
function _fireAndCallback(){if(convertflow.ctas[cta.id]["fired"]!==true)fire("exit");}
$cf(window).off("mouseleave.cta"+cta.id).on("mouseleave.cta"+cta.id,handleMouseleave);$cf(window).off("mouseenter.cta"+cta.id).on("mouseenter.cta"+cta.id,handleMouseenter);}
if($cf(window).width()<=480&&variant.options["trigger-mobile-exit"]!=="false"){if(window.history&&window.history.pushState){window.addEventListener("popstate",function(event){var hashLocation=location.hash;var hashSplit=hashLocation.split("#!/");var hashName=hashSplit[1];if(hashName!==""){var hash=window.location.hash;if(hash===""){if(convertflow.ctas[cta.id]["fired"]!==true)fire("exit");}}});if(convertflow.ctas[cta.id]["mobile_exit_intent_ready"]!==true){convertflow.ctas[cta.id]["mobile_exit_intent_ready"]=true;window.history.pushState("forward",null,null);}}}};this.clickPop=function(){$cf(document).on("click",".cta-"+cta.id+"-trigger",function(){if($cf(this).attr("data-validated")==undefined||$cf(this).attr("data-validated")=="true"){$cf(".cf-"+cta.cta_type).hide();fire("click");}});};this.twoTapPopup=function(){var twoTapContents=variant.two_tap_popup||variant.profilepop;if(twoTapContents&&(!convertflow.twoTapTriggered||(trigger_type_override=='two-tap'&&variant.options['prehook-trigger-on-close']+''=='true'))){if($cf(".cf-two-tap.cta"+cta.id+", .cf-prehook-popup.cta"+cta.id).length==0){$cf("body").append(twoTapContents);}
var twoTapDiv=$cf(".cf-two-tap.cta"+cta.id+", .cf-prehook-popup.cta"+cta.id);$cf(twoTapDiv).removeAttr('data-react-class');$cf(twoTapDiv).removeAttr('data-react-props');$cf(twoTapDiv).removeAttr('data-hydrate');$cf(twoTapDiv).removeAttr('data-react-cache-id');$cf(twoTapDiv).css("display","none");function showTwoTapPopup(){if((convertflow.twoTapTriggered==undefined&&(convertflow[supression]==undefined||cta.broadcast_id==convertflow[supression]))||(trigger_type_override=='two-tap'&&variant.options['prehook-trigger-on-close']+''=='true')){convertflow.twoTapTriggered=true;var twoTapMessage=$cf(twoTapDiv).find('.cf-two-tap-message, .prehook-message');app.ctas.mergeTags(cta,variant,twoTapMessage);app.ctas.fonts(cta,variant,twoTapDiv);if(variant.options['trigger_type']=='prehook'){$cf(twoTapMessage).find("p").attr("style",'margin: 0 !important; font-family: "Helvetica Neue", Helvetica, Arial, sans-serif !important; font-size: 16px !important; color: #6f818e; line-height: 1.4 !important; padding: 0px; -webkit-font-smoothing: subpixel-antialiased; -moz-osx-font-smoothing: initial; font-smoothing: subpixel-antialiased;');}
$cf(twoTapDiv).addClass("slide-up");$cf(twoTapDiv)[0].style.setProperty('display','block','important');var twoTapClose=$cf(twoTapDiv).find(".cf-two-tap-close, .prehook-close");app.ctas.bindClose(cta,variant,embed,twoTapClose);var twoTapButton=$cf(twoTapDiv).find(".cf-two-tap-message, .cf-prehook-button");$cf(twoTapButton).on('click',function(){fire("click");$cf(twoTapDiv)[0].style.setProperty('display','none','important');});}};if(variant.options["prehook-trigger-type"]=="scroll"){var length=$cf(document).height();if(variant.options["scroll"]!==undefined){var scroll=parseInt(variant.options["scroll"]);}else{var scroll=0;}
var target=(scroll*length)/100;$cf(window).scroll(function(){if($cf(window).scrollTop()>=target){if(convertflow.ctas[cta.id]["fired"]!==true)
showTwoTapPopup();}});}
if(variant.options["prehook-trigger-type"]=="delayed"){if(variant.options["scroll"]!==undefined){var delay=parseInt(variant.options["delay"])*1000;}else{var delay=0;}
setTimeout(function(){if(convertflow.ctas[cta.id]["fired"]!==true)
showTwoTapPopup();},delay);}
if(variant.options["prehook-trigger-type"]=="immediate"||variant.options["prehook-trigger-type"]==undefined){if(convertflow.ctas[cta.id]["fired"]!==true){showTwoTapPopup();}}
if(variant.options['trigger_type']!=='two-tap'&&variant.options['prehook-trigger-on-close']+''=='true'&&trigger_type_override=='two-tap'){showTwoTapPopup();}}};this.onAddToCart=()=>{$cf(document).on("submit","[action=\"/cart/add\"]",function(event){fire("addToCart");});window.addEventListener("cfAddToCart",function(event){fire("addToCart");});};$cf(document).on("trigger_CTA_"+cta.id,function(){$cf(".cf-"+cta.cta_type).hide();fire("click");});if(app.live==true){if(app.helpers.getCookie(trigger_cookie)==undefined||app.helpers.getCookie(trigger_cookie)==null||app.helpers.getCookie(trigger_cookie)==""){if(variant.options.trigger_type=="exit"){this.exit();}
if(variant.options.trigger_type=="delayed"){this.delayed();}
if(variant.options.trigger_type=="scroll"){this.scroll();}
if(["two-tap","prehook"].includes(variant.options.trigger_type)){this.twoTapPopup();}
if(variant.options.trigger_type=="cart"&&window.location.href.indexOf('/cart')==-1){this.onAddToCart();}}}else{fire("click");}
this.clickPop();if(trigger_type_override=='two-tap'){this.twoTapPopup();}};app.ctas.brandStyle=function(cta,variant,embed){if(app.live!==true){$cf.each(["brand_color_dark","brand_color_light","brand_color_vibrant"],function(i,color_key){if(app.website.brand_style[color_key]){if(color_key=='brand_color_dark'){var color_key_code='BLACK'}
if(color_key=='brand_color_light'){var color_key_code='WHITE'}
if(color_key=='brand_color_vibrant'){var color_key_code='MEDIUMBLUE'}
$cf.each(["background","color","border-color","border-top-color","border-bottom-color","border-left-color","border-right-color",],function(i,style_type){$cf(embed).find('[style*="'+style_type+'"][style*="'+color_key+'"], [style*="'+style_type+'"][style*="'+color_key_code+'"]').each(function(i,dom_element){var inline_style=$cf($cf(dom_element).attr("style").split(";")).filter(function(){return(this.indexOf(style_type)>-1&&(this.indexOf(color_key)>-1||this.indexOf(color_key_code)>-1));})[0];if(inline_style){dom_element.style.setProperty(style_type,app.website.brand_style[color_key],"important");}});});}});}};app.ctas.bindClose=function(cta,variant,embed,selector){var originalSelector=selector;if(selector==undefined){var selector='#cta'+cta.id+' .cf-cta-close, .cf-close[data-cta-id="'+cta.id+'"]';}
$cf(selector).unbind('click').on('click',function(){app.ctas.close(cta,variant,embed,true);if(originalSelector){$cf('.cf-two-tap[data-cta-id='+cta.id+'], .cf-prehook-popup.cta'+cta.id).removeClass('slide-up').hide();}
if(!originalSelector&&variant.options['trigger_type']!=='prehook'&&variant.options['prehook-trigger-on-close']+''=='true'){app.ctas.triggerTwoTap(cta,variant,embed);}});}
app.ctas.close=function(cta,variant,embed,track){$cf(embed).hide();$cf(embed).find('.cf-video iframe[src]').each(function(i,frame){$cf(frame).removeAttr('src');});if(cta.cta_type=='bar'&&variant.options['bar-position']=='top'){$cf('html').css('transition','').css('-webkit-transition','').css('padding-top','0')}
if(track==true){if(variant.options.hide){var expire=parseInt(variant.options.hide)*24*60;}else{var expire=0*24*60;}
app.helpers.setCookie('viewedCta'+cta.id,'true',expire);app.visitors.fireEvent("cfClose",{cta:cta,variant:variant});}}
app.ctas.triggerTwoTap=function(cta,variant,embed){app.ctas.trigger(cta,variant,embed,'two-tap');var prehookPosition=variant.options["prehook-position"]?variant.options["prehook-position"]:'right';var overlappingPrehooks=$cf('.cf-two-tap[data-position="'+prehookPosition+'"].slide-up');var prehook=$cf('.cf-two-tap[data-cta-id='+cta.id+']')[0];if(prehook&&overlappingPrehooks.length>1){var extraOffset=20+((overlappingPrehooks.length-1)*5);prehook.style.setProperty('bottom',extraOffset+'px','important');if(prehookPosition=='right'){prehook.style.setProperty('right',extraOffset+'px','important');prehook.style.setProperty('box-shadow','5px 5px 0px 0px rgba(0,0,0,0.09)','important');}else if(prehookPosition=='left'){prehook.style.setProperty('left',extraOffset+'px','important');prehook.style.setProperty('box-shadow','-5px 5px 0px 0px rgba(0,0,0,0.09)','important');}else if(prehookPosition=='center'){prehook.style.setProperty('box-shadow','0px 5px 0px 0px rgba(0,0,0,0.09)','important');}};}
app.ctas.track=function(event,cta,element){$cf.extend(event,{website_id:app.website_id,visitor_token:app.visitors.uid(),contactable_type:'Cta',contactable_id:cta.id,url:app.helpers.cleanURL(window.location.href)})
var position=undefined;if(cta.broadcast_id!==undefined)event.broadcast_id=cta.broadcast_id;if(event.variant_id!==undefined&&event.step_id==undefined){var variant=cta.variants[event.variant_id];var step=$cf.map(variant.steps,function(step){if(step.position==1)return step})[0]
var position=step.position;if(step!==undefined&&step.id!==undefined)event.step_id=step.id;}
var skip_database_storage=event.event_type=='Completion'||(event.event_type=='Complete'&&$cf.inArray(element.element_type,['form','survey'])>-1&&app.website.data["contact-processing"]!=="false");app.visitors.trackEvent(event,skip_database_storage);}
app.ctas.initializeStep=function(cta,variant,step,embed){$cf(embed).find('.cf-video iframe[src]').each(function(i,frame){$cf(frame).removeAttr('src');});$cf(embed).find('.cf-step[data-step-id="'+step.id+'"] .cf-video iframe').each(function(i,frame){var src=$cf(frame).attr('data-src');if(!$cf(frame).attr('src')){$cf(frame).attr('src',src);}})
var true_action_group;if(step.action_groups!==undefined){$cf.each(step.action_groups,function(i,action_group){if(!true_action_group&&app.campaigns.checkConditions(action_group.conditions,convertflow.person,{variant:variant})==true){true_action_group=action_group}})}
if(true_action_group){app.ctas.performConfirmationAction({embed:embed,cta:cta,variant:variant,step:step,action_group:true_action_group});}
return true_action_group;}
app.ctas.forms=function(cta,variant,embed){$cf.each(variant.steps,function(step_id,step){$cf.each(step.sections,function(section_id,section){$cf.each(section.elements,function(element_id,element){if(element.element_type=='form'){$cf(embed).find('.cf-cta-item[data-type="form"][data-id="'+element_id+'"]').each(function(index,cta_item){var form=$cf(cta_item).find('form');var form_container=$cf(embed).find('div[id="element'+element_id+'_form"]');$cf(form).find('input[name="contact[visitor_token]"]').val(app.visitors.uid())
$cf(form).find('.cf-form-fields').each(function(index,field_container){var fields=$cf(field_container).find('.cf-form-field').sort(function(a,b){return $cf(a).attr('data-pos')-$cf(b).attr('data-pos');});$cf(field_container).find('.cf-form-field').remove()
$cf(field_container).append(fields)})
$cf(form).find('.cf-select').each(function(index,radio_field){$cf(radio_field).find('input[type="radio"]').each(function(index,radio_option){$cf(radio_option).click(function(){if($cf(radio_option).attr('checkstate')=='true'){$cf(radio_option).prop('checked',false);$cf(radio_option).attr('checkstate','false');}else{$cf(radio_field).find('input[type="radio"]').prop('checked',false);$cf(radio_field).find('input[type="radio"]').attr('checkstate','false');$cf(radio_option).prop('checked',true);$cf(radio_option).attr('checkstate','true');}})})
$cf(radio_field).find('input[type="checkbox"]').each(function(index,checkbox){$cf(checkbox).on('change',function(){var checkbox_values=$cf(form).find('input[type="checkbox"][data-slug="'+$cf(checkbox).attr('data-slug')+'"]:checked').map(function(){return this.value;}).get().join(', ');$cf(form).find('input[name="'+$cf(checkbox).attr('data-slug')+'"][type="hidden"]').val(checkbox_values);});});})
$cf(form).find('.cf-field-range').each(function(i,rangeContainer){var range=$cf(rangeContainer).find('.cf-field-range-slider')[0];var field_id=$cf(range).attr('data-id');var field=Object.values(element.fields).filter(function(field){if(field.id+''==field_id){return field;}})[0];if(field){var rangeStartValue=0;var rangeValues={min:0,max:1000};var rangeStep=field.options['increment']?parseInt(field.options['increment']):1;var rangePips=false;var rangeSnap=false;var numberType=field.options['range-value-type']?field.options['range-value-type']:'integer';if(field.options['range-type']!=='increments'){var rangeSliderMinimum=field.options["minimum"]?parseInt(field.options["minimum"]):0;var rangeSliderMaximum=field.options["maximum"]?parseInt(field.options["maximum"]):1000;rangeStartValue=rangeSliderMaximum*0.25;rangeStartValue=[rangeStartValue];if(field.options["multiple-handles"]=="true"){rangeStartValue.push(rangeSliderMaximum*0.75);}
rangeValues={min:rangeSliderMinimum,max:rangeSliderMaximum,};rangePips=false;if(field.options['range-labels']=='true'){rangePips={mode:'range',values:[rangeSliderMinimum,rangeSliderMaximum],density:100,};var pipFormats={};if(numberType=='currency'){rangePips['format']=app.helpers.wNumb({decimals:2,prefix:app.website.currency_character})}
if(numberType=='percentage'){rangePips['format']=app.helpers.wNumb({decimals:0,suffix:'%'})}
if(field.options['range-label-minimum']){pipFormats[rangeSliderMinimum]=field.options['range-label-minimum'];}
if(field.options['range-label-maximum']){pipFormats[rangeSliderMaximum]=field.options['range-label-maximum'];}
if(Object.keys(pipFormats).length>0){rangePips['format']={to:function(a){return pipFormats[a];}}}}}
if(field.options['range-type']=='increments'){rangeSnap=field.options['limit-to-increments']!=='false'?true:false;if(rangeSnap==true){rangeStep=undefined;}
var values=[];if(field.field_options){Object.values(field.field_options).forEach(function(field_option){if(app.helpers.isNumeric(field_option.value)){values.push(parseInt(field_option.value));}})}
if(values){var sortedValues=values.sort(function(a,b){return a-b});rangeStartValue=sortedValues[0];rangeSliderMaximum=sortedValues[sortedValues.length-1];rangeValues={min:rangeStartValue,max:sortedValues[sortedValues.length-1]};rangeStartValue=[rangeStartValue];if(field.options["multiple-handles"]=="true"){rangeStartValue.push(rangeSliderMaximum*0.75);}
var numberOfPipsDividedBy100=100/sortedValues.length;sortedValues.filter(function(option_value){if(option_value!==rangeStartValue&&option_value!==rangeSliderMaximum){return option_value;}}).forEach(function(option_value,i){var percentage=numberOfPipsDividedBy100*(i+1);rangeValues[percentage+'%']=option_value;})
rangePips={mode:'values',values:values,density:values.length,};if(numberType=='currency'){rangePips['format']=app.helpers.wNumb({decimals:2,prefix:app.website.currency_character})}
if(numberType=='percentage'){rangePips['format']=app.helpers.wNumb({decimals:0,suffix:'%'})}}}
app.helpers.noUiSlider.create(range,{tooltips:true,start:rangeStartValue,connect:true,range:rangeValues,step:rangeStep,pips:rangePips,snap:rangeSnap,format:{to:function(value){return parseInt(value).toFixed();},from:function(value){return parseInt(value).toFixed();}}});rangeContainer.timeoutId=undefined;range.noUiSlider.on('start',function(values){$cf(rangeContainer).find('.noUi-tooltip').show();clearTimeout(rangeContainer.timeoutId);});range.noUiSlider.on('set',function(values){$cf(rangeContainer).find('.noUi-tooltip').show();});range.noUiSlider.on('update',function(values){var separator=' - ';var formattedNumbers=[];$cf(values).each(function(i,value){if(numberType=='integer'){formattedNumbers.push(value);}else if(numberType=='percentage'){formattedNumbers.push(value+'%');}else if(numberType=='currency'){formattedNumbers.push(app.website.currency_character+value+'.00');}});var formattedValues=formattedNumbers.join(separator);var rangeField=$cf(rangeContainer).find('input');$cf(rangeField).val(formattedValues);clearTimeout(rangeContainer.timeoutId);rangeContainer.timeoutId=setTimeout(function(){$cf(rangeContainer).find('.noUi-tooltip').hide();},2000);});}})
if(element.options['form-type']=='horizontal'&&$cf(window).width()<481&&(element.options['field-size']!=='cf-field-regular'||$cf(form_container).find('.cf-form-field[data-visible="true"]').length>1||$cf(form_container).attr('data-consent')=='true')){$cf(form_container).removeClass('cf-form-horizontal').addClass('cf-form-vertical')}
if(element.options['form-type']=='horizontal'&&$cf(window).width()>480){$cf(form_container).find('.cf-form-field[data-visible="true"]').each(function(i,field){if(i>=4){$cf(field).attr('data-visible','false')}})}
$cf(form).find('input[name="contact[source_url]"]').val(app.helpers.cleanURL(window.location.href));$cf.each(['broadcast_id'],function(index,campaign_id){if(convertflow.ctas[cta.id][campaign_id]!==undefined){$cf(form).find('input[name="contact['+campaign_id+']"]').val(convertflow.ctas[cta.id][campaign_id])}})
if(element.options['prefill-fields']!=='false'){$cf(form).find('select.cf-sms-countries').each(function(i,select){var countryCode;var countryValue;if(convertflow.person.data.location&&convertflow.person.data.location["countryCode"]){countryCode=convertflow.person.data.location["countryCode"];}else if(convertflow.person.country){var countryName=convertflow.person.country;countryValue=$cf(select).find('option:contains('+countryName+')').attr('value');}else if(element.options['phone-default-country']){countryCode=element.options['phone-default-country'];}else if(app.website.data['default-country']){countryCode=app.website.data['default-country'];}
if(countryValue){$cf(select).val(countryValue);}else if(countryCode){$cf(select).val(countryCode);}else{$cf(select).val('US');}});var contactFields={name:['name','first_name','firstname','f_name','fname'],last_name:['last_name','lastname','last','l_name','lname'],email:['email','emailaddress','email_address'],phone:['phone','phone_number','telephone','cellphone','cell'],url:['website'],company_name:['company_title','company','company_title','companyname','company_name'],company_title:['company_title','job','jobtitle','job_title'],city:['city'],country:['country'],address:['address','streetaddress','address1'],state:['state','region'],zip_code:['zip_code','zipcode','postal','postalcode']}
$cf.each(contactFields,function(database_field,field_names){var attribute=undefined;if(database_field!=='last_name'){var custom_params=element.options[database_field.replace('_','-')+'-prefill-params'];}else{var custom_params=element.options['lastname-prefill-params'];}
if(custom_params){$cf.each(custom_params.split(','),function(i,custom_param_name){var custom_param_name=custom_param_name.replace(' ','')
if(custom_param_name&&app.helpers.getParameterByName(custom_param_name)){attribute=app.helpers.getParameterByName(custom_param_name);}})}
if(!attribute){$cf.each(field_names,function(i,contact_field){var contact_field_value=$cf(form).find('[name="contact['+database_field+']"]').val();if(app.helpers.getParameterByName(contact_field)!==""||(["",null].includes(contact_field_value)&&convertflow.person!==undefined&&convertflow.person[database_field])){if(convertflow.person!==undefined&&convertflow.person[database_field]){attribute=convertflow.person[database_field]}
if(app.helpers.getParameterByName(contact_field)){attribute=app.helpers.getParameterByName(contact_field)}}})}
if(attribute){$cf(form).find('[name="contact['+database_field+']"]').val(attribute)
if(element.options['hide-prefilled-fields']=='true'&&element.options['form-type']!=='horizontal'){$cf(form).find('[name="contact['+database_field+']"]').attr('prefilled','true')}}})
$cf.each(element.fields,function(i,field){if(field.field_type!==undefined&&field.field_type!=='survey'&&field.slug){var person_field=undefined;var url_parameter=undefined;if(convertflow.person!==undefined&&convertflow.person.extra!==undefined&&convertflow.person.extra!==null&&convertflow.person.extra[field.slug]!==undefined&&convertflow.person.extra[field.slug]!==null&&convertflow.person.extra[field.slug]!==""){var person_field=convertflow.person.extra[field.slug];}
if(field.value&&['dropdown','range'].includes(field.field_type)==false){var person_field=field.value
var url_parameter=person_field}
if(field.url_params){var custom_param=$cf(field.url_params.split(',')).map(function(i,custom_param_name){var custom_param_name=custom_param_name.replace(' ','')
if(!custom_param&&custom_param_name&&app.helpers.getParameterByName(custom_param_name)){var custom_param=app.helpers.getParameterByName(custom_param_name);return custom_param}})[0]
if(custom_param){var person_field=custom_param
var url_parameter=person_field}}
if(app.helpers.getParameterByName(field.slug)){var person_field=app.helpers.getParameterByName(field.slug);}
if(person_field!==undefined){var field_selector=undefined
if(field.field_type=='text'||field.field_type=='hidden'){var field_selector='input[name="contact[extra]['+field.slug+']"]'}
if(field.field_type=='paragraph'){var field_selector='textarea[name="contact[extra]['+field.slug+']"]'}
if(field.field_type=='dropdown'){var field_selector='select[name="contact[extra]['+field.slug+']"]'}
if(field.field_type=='radio'||field.field_type=='select'){var field_selector='input[name="contact[extra]['+field.slug+']"]'}
if(field_selector!==undefined){if((field.field_type=='text'||field.field_type=='hidden'||field.field_type=='paragraph'||field.field_type=='dropdown')){if(!$cf(form).find(field_selector).val()||url_parameter){$cf(form).find(field_selector).val(person_field)}}
if((field.field_type=='radio'||field.field_type=='select')){$cf(person_field.split(', ')).each(function(i,person_field_value){$cf(form).find('[value="'+person_field_value+'"]').prop('checked',true);});if(field.multi_select==true){var checkbox_values=$cf(form).find('input[data-slug="contact[extra]['+field.slug+']"][type="checkbox"]:checked').map(function(){return this.value;}).get().join(', ');$cf(form).find(field_selector+'[type="hidden"]').val(checkbox_values);}}
if(element.options['hide-prefilled-fields']=='true'){$cf(form).find(field_selector).attr('prefilled','true')}}}}})
$cf(form).find('[prefilled="true"]').hide()
$cf(form).find('[prefilled="true"]').each(function(i,prefilled_input){$cf(prefilled_input).parents('.cf-form-field').each(function(i,prefilled_field){prefilled_field.style.setProperty('display','none','important');})})}
var submitForm=function(form){var email_value=$cf(form).find('input[name="contact[email]"]').val()
if(email_value){var email_value=email_value.toLowerCase()
$cf(form).find('input[name="contact[email]"]').val(email_value)}
var phoneField=$cf(form).find('input[name="contact[phone]"]');var phoneFieldOgValue=$cf(phoneField).val();var formattedPhoneNumber;var dialCodeField=$cf(form).find('.cf-sms-countries');if(phoneFieldOgValue&&phoneFieldOgValue.indexOf('+')==-1&&$cf(dialCodeField).val()){var phoneNumber=phoneFieldOgValue.replace(/[\s()+\-\.]|ext/gi,'');var dialCode=$cf(dialCodeField).find('option[value="'+$cf(dialCodeField).val()+'"]').attr('data-dial_code');var formattedPhoneNumber="+"+dialCode+phoneNumber;$cf(phoneField).val(formattedPhoneNumber)}
var formData=$cf(form).serializeArray();var contactFields=['email','name','last_name','phone','website','company_name','company_title','url','city','country','address','state','zip_code','extra','marketing_consent','privacy_consent','sms_consent']
var submittedFields={};$cf.each(formData,function(index,contact_field){if(contact_field.name.indexOf('extra')==-1){var field_name=contact_field.name.replace('contact[','').replace(']','')
if($cf.inArray(field_name,contactFields)>-1&&contact_field.value.length>0){if(contact_field.value!==undefined&&contact_field.value!==""){$cf('span[data-merge="'+field_name+'"]').text(contact_field.value)
convertflow.person[field_name]=contact_field.value
submittedFields[field_name]=contact_field.value
$cf('.new_contact').each(function(index,contact_form){$cf(contact_form).find('input[name="contact['+field_name+']"]').val(contact_field.value)})}}}else{var field_name=contact_field.name.replace('contact[','').replace('[','').replace(']','').replace('extra','').replace(']','')
if(contact_field.value!==undefined&&contact_field.value!==""){$cf('span[data-merge="'+field_name+'"]').text(contact_field.value)
convertflow.person.extra=convertflow.person.extra||{}
convertflow.person.extra[field_name]=contact_field.value
submittedFields[field_name]=contact_field.value
var score=app.ctas.incrementScore(embed,cta,variant,element,field_name,contact_field.value);$cf(form).append('<input type="hidden" name="contact[latest_score]" value="'+score+'" />');if(variant['score_field']){$cf(form).append('<input type="hidden" name="contact[extra]['+variant['score_field']+']" value="'+score+'" />');}
$cf('.new_contact').each(function(index,contact_form){var contact_form_field=$cf(contact_form).find('input[name="contact[extra]['+field_name+']"]')
if(!$cf(contact_form_field).val()){$cf(contact_form_field).val(contact_field.value)}})}}})
var contactData=$cf(form).serialize();var contactData='cf2=true&'+contactData;if(app.live==true){var action_groups=[]
if(element.action_groups!==undefined){$cf.each(element.action_groups,function(i,action_group){if($cf.isEmptyObject(action_group.conditions)==false&&app.campaigns.checkConditions(action_group.conditions,window.convertflow.person,{variant:variant})==true){action_groups.push(action_group.id)}})}
if(action_groups.length>0){var contactData='action_groups='+action_groups.join()+'&'+contactData;}
if(app.localstorage){app.helpers.compressAndStore(app.local_person,convertflow.person);}
if(app.website.data["contact-processing"]!=="false"){$cf.ajax({type:"GET",url:app.api_contacts,data:contactData,contentType:"application/json; charset=utf-8",dataType:"JSONP",complete:function(data,status,xhr){}});}}
if(formattedPhoneNumber&&phoneFieldOgValue){$cf(phoneField).val(phoneFieldOgValue);}
element.contactData=contactData
app.ctas.conversionLogic({embed:embed,cta:cta,variant:variant,step:step,section:section,element:element,submission_data:submittedFields});}
var field=$cf(form).find('input[name="contact[email]"]')
var icon=$cf(form).find('.cf-email-validation')
var icon_big_error='https://img.convertflow.co/static/validation-big-error.png'
var icon_big_success='https://img.convertflow.co/static/validation-big-success-grey.png'
var icon_big_success_green='https://img.convertflow.co/static/validation-big-success.png'
var icon_loader='https://img.convertflow.co/static/loader.png'
element.validated=false;element.ran_validation=false;var validateEmailFormat=function(form){var email=$cf(field).val().toLowerCase()
var filter=/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/;if(field.val()==""){$cf(icon).hide();$cf(icon).attr('style','transition: background 1s ease, border 1s ease;');if($cf(icon).attr('src')!=icon_big_error){$cf(field).addClass('cf-error');$cf(icon).removeClass('cf-spinner').attr('src',icon_big_error);}}
if(filter.test(email)){if($cf(icon).attr('src')!=icon_big_success){$cf(field).removeClass('cf-error');$cf(icon).removeClass('cf-spinner').attr('src',icon_big_success);}
return true;}else{if($cf(icon).attr('src')!=icon_big_error){$cf(field).addClass('cf-error');$cf(icon).removeClass('cf-spinner').attr('src',icon_big_error);}
return false;}}
var validatePhoneFormat=function(form){var phoneField=$cf(form).find('input[name="contact[phone]"]');var phoneValue=$cf(phoneField).val().replace(/[\s()+\-\.]|ext/gi,'');var filter=/^\d{4,}$/;if((element.options['show-email']=='true'&&element.options['phone-required']!=='true'&&$cf(phoneField).val()=='')||filter.test(phoneValue)){$cf(phoneField).removeClass('cf-error');return true;}else{$cf(phoneField).addClass('cf-error');return false;}}
var validateCheckboxes=function(form){var allChecked=true;$cf(form).find('input[type="checkbox"][required]:visible').each(function(i,checkbox){if($cf(checkbox).is(":checked")==false){allChecked=false;}});return allChecked;}
var mailserverValidate=function(form){var email=$cf(field).val().toLowerCase()
var tooltip=$cf(form).find('.cf-validation-tooltip').first()
$cf(form).find('button[type="submit"]').attr('disabled',true)
if(element.ran_validation==true){element.ran_validation=false}
function validationIcon(){if(element.validated==false&&element.ran_validation==false&&(icon.attr('src')==icon_loader||icon.attr('src')==icon_big_success)){if(icon.attr('src')!=icon_loader){icon.attr('src',icon_loader).addClass('cf-spinner');}
setTimeout(function(){validationIcon();},1500);}else if(element.ran_validation==true&&element.validated==true){icon.attr('src',icon_big_success_green).removeClass('cf-spinner');}else if(element.ran_validation==true&&element.validated==false){icon.attr('src',icon_big_error).removeClass('cf-spinner');}}
validationIcon();$cf.ajax({url:app.api_contacts_validate+'?email='+email,dataType:"JSONP",timeout:10000,success:function(json){$cf(form).find('button[type="submit"]').removeAttr('disabled')
if(json.mx_found==true&&json.score>=0.48&&(element.options['validate-email-business']!=='true'||json.free!==true)){$cf(icon).show();if($cf(icon).attr('src')!=icon_big_success_green){$cf(icon).attr('src',icon_big_success_green).removeClass('cf-spinner');}
$cf(field).attr('style','border: 1px solid rgb(133, 209, 164) !important; background: rgb(242, 255, 248) !important; transition: background 0.5s ease, border 0.5s ease;')
if($cf(tooltip).length){$cf(tooltip).hide()}
$cf(tooltip).find('.cf-tooltip-arrow').attr('style','border-top-color: #27ae60')
$cf(tooltip).find('.cf-tooltip-inner').attr('style','background-color: #27ae60').html('Email validated!')
$cf(tooltip).fadeIn(300);setTimeout(function(){$cf(field).attr('style','transition: background 1s ease, border 1s ease;');$cf(tooltip).fadeOut(500);},1500);element.validated=true
element.ran_validation=true
submitForm(form)}else{$cf(icon).show();if($cf(icon).attr('src')!=icon_big_error){$cf(icon).attr('src',icon_big_error).removeClass('cf-spinner');}
$cf(field).attr('style','border: 1px solid #F17C69 !important; background: #FEF3F0 !important; transition: background 0.5s ease, border 0.5s ease;')
$cf(tooltip).hide()
if(json.did_you_mean==null||json.did_you_mean==""){var arrow=$cf(tooltip).find('.cf-tooltip-arrow');$cf(arrow).attr('style','border-top-color: #e74c3c');var validationMessage=$cf(tooltip).find('.cf-tooltip-inner');$cf(validationMessage).attr('style','background-color: #e74c3c');if(element.options['validate-email-business']=='true'&&json.free==true){$cf(validationMessage).html('Enter a business email');}else{$cf(validationMessage).html('Enter a better email')}
$cf(tooltip).fadeIn(300);setTimeout(function(){$cf(field).attr('style','transition: background 1s ease, border 1s ease;');$cf(tooltip).fadeOut(500);},1500);element.ran_validation=true
element.validated=false}else{$cf(tooltip).find('.cf-tooltip-arrow').css('border-top-color','#0056ff')
$cf(tooltip).find('.cf-tooltip-inner').attr('style','background-color: #0056ff; text-align: left; max-width: 300px; line-height: 0; padding: 10px !important').html('<span class="cf-didyoumean" style="line-height: 1.3em; cursor: pointer;"></span>')
$cf(tooltip).find('.cf-didyoumean').html('Did you mean <span class="cf-didyoumeanemail" style="text-decoration: underline">'+json.did_you_mean+'</span>'+'?');$cf(tooltip).find('.cf-didyoumeanemail').on('click',function(){$cf(field).val(json.did_you_mean);$cf(tooltip).hide()
$cf(icon).attr('src',icon_big_success_green).removeClass('cf-spinner');});$cf(tooltip).fadeIn(300);$cf(tooltip).on('click',function(){$cf(field).attr('style','transition: background 1s ease, border 1s ease;');$cf(this).hide();})
element.ran_validation=true
element.validated=false}}},error:function(XMLHttpRequest,textStatus,errorThrown){element.validated=true
$cf(form).find('button[type="submit"]').removeAttr('disabled')
submitForm(form)}});}
$cf(form).attr('action','')
$cf.validator.messages.required='';$cf(form).find('input[name="contact[email]"]').keyup(function(){validateEmailFormat(form);});$cf(form).find('input[name="contact[phone]"]').keyup(function(i,phoneField){validatePhoneFormat(form);});$cf(form).validate({highlight:function(field_tag,errorClass,validClass){if(app.helpers.IE()==false&&$cf(form).attr('data-validity-reported')!=='true'){$cf(form).attr('data-validity-reported','true')
$cf(form)[0].reportValidity();}
$cf(field_tag).addClass('cf-error');},unhighlight:function(field_tag){if($cf(field_tag).attr('name')!=='contact[email]'&&($cf(field_tag).attr('name')!=='contact[phone]'||element.options['show-phone']!=='true')){$cf(field_tag).removeClass('cf-error');}},submitHandler:function(form,event){event.preventDefault();var emailValidated=element.options['show-email']=='false'||validateEmailFormat(form)==true;var phoneValidated=element.options['show-phone']!=='true'||validatePhoneFormat(form)==true;var checkboxesValidated=validateCheckboxes(form);if(emailValidated&&phoneValidated&&checkboxesValidated){if($cf(field).css('display')!=='none'&&app.helpers.IE()==false){icon.show();if(element.options['validate-email']=='true'&&element.options['show-email']!=='false'){mailserverValidate(form)}else{submitForm(form)}}else{submitForm(form)}}else if(validateEmailFormat(form)==false){icon.show();if(icon.attr('src')!=icon_big_error){icon.attr('src',icon_big_error);}}
return false}})});}})})})}
app.ctas.buttons=function(cta,variant,embed){$cf.each(variant.steps,function(step_id,step){$cf.each(step.sections,function(section_id,section){$cf.each(section.elements,function(element_id,element){if(element.element_type=='button'){$cf(embed).find('.cf-cta-item[data-type="button"][data-id="'+element_id+'"]').each(function(index,cta_item){var button=$cf(cta_item).find('.cf-button')[0];$cf(button).on('click',function(e){app.ctas.conversionLogic({embed:embed,cta:cta,variant:variant,step:step,section:section,element:element});});});}})})})}
app.ctas.surveys=function(cta,variant,embed){$cf.each(variant.steps,function(step_id,step){$cf.each(step.sections,function(section_id,section){$cf.each(section.elements,function(element_id,element){if(element.element_type=='survey'){$cf(embed).find('.cf-cta-item[data-type="survey"][data-id="'+element_id+'"]').each(function(index,cta_item){var field_div=$cf(cta_item).find('.cf-survey-field');var custom_field=$cf(field_div).attr('data-field');var field_submit=$cf(cta_item).find('.cf-survey-next-outer');var submitSurvey=function(custom_field,custom_field_value){var contactData={'visitor_token':convertflow.person.visitor_token,'element_id':element.id,'step_id':step.id,'variant_id':variant.id,'contactable_type':'Cta','contactable_id':cta.id,'website_id':app.website.id,'extra':{}}
if(convertflow.person.email!==undefined&&convertflow.person.email!==""){contactData['email']=convertflow.person.email}
if(convertflow.person.phone!==undefined&&convertflow.person.phone!==""){contactData['phone']=convertflow.person.phone}
$cf.each(['broadcast_id'],function(index,campaign_id){if(convertflow.ctas[cta.id][campaign_id]!==undefined){contactData[campaign_id]=convertflow.ctas[cta.id][campaign_id]}})
if(custom_field&&custom_field_value){convertflow.person.extra=convertflow.person.extra||{}
convertflow.person.extra[custom_field]=custom_field_value
contactData['extra']={};contactData['extra'][custom_field]=custom_field_value;}
var score=app.ctas.incrementScore(embed,cta,variant,element,custom_field,custom_field_value);if(score!==undefined){contactData['latest_score']=score;if(variant['score_field']){contactData['extra']=contactData['extra']||{};contactData['extra'][variant['score_field']]=score;}}
var payload={contact:contactData,cf2:true}
var action_groups=[]
if(element.action_groups!==undefined){$cf.each(element.action_groups,function(i,action_group){if($cf.isEmptyObject(action_group.conditions)==false&&app.campaigns.checkConditions(action_group.conditions,window.convertflow.person,{variant:variant})==true){action_groups.push(action_group.id)}})}
if(action_groups.length>0){payload['action_groups']=action_groups.join()}
if(app.live==true){if(app.website.data["contact-processing"]!=="false"){$cf.ajax({type:"GET",url:app.api_contacts,data:payload,contentType:"application/json; charset=utf-8",dataType:"JSONP",success:function(data,status,xhr){}});}
if(app.localstorage){app.helpers.compressAndStore(app.local_person,convertflow.person);}}
if(custom_field&&custom_field_value){$cf('span[data-merge="'+custom_field+'"]').text(custom_field_value)
$cf('.new_contact').each(function(index,contact_form){$cf(contact_form).find('input[name="contact[extra]['+custom_field+']"]').val(custom_field_value)})}
var submittedFields={}
submittedFields[custom_field]=custom_field_value
app.ctas.conversionLogic({embed:embed,cta:cta,variant:variant,step:step,section:section,element:element,submission_data:submittedFields});}
var is_multi_select=$cf(field_div).attr('data-multi-select');$cf(field_div).find('.cf-survey-choice').on('click',function(e){var custom_field_value=$cf(this).attr('data-value');if(is_multi_select!=='true'){$cf(field_div).find('.cf-survey-choice').each(function(){$cf(this).removeAttr('data-selected');});$cf(this).attr('data-selected','true');submitSurvey(custom_field,custom_field_value);};if(is_multi_select=='true'){if($cf(this).attr('data-selected')!=='true'){$cf(this).attr('data-selected','true');}else{$cf(this).removeAttr('data-selected');}
if($cf(field_div).find('.cf-survey-choice[data-selected="true"]').length>0){$cf(field_submit).show();}else{$cf(field_submit).hide();}};})
if(is_multi_select=='true'){$cf(field_submit).find('.cf-survey-next').on('click',function(){var custom_field_values=[];$cf(field_div).find('.cf-survey-choice[data-selected="true"]').each(function(i,choice){custom_field_values.push($cf(choice).attr('data-value'));});var custom_field_value=custom_field_values.join(', ');submitSurvey(custom_field,custom_field_value);});}})}})})})}
app.ctas.conversionLogic=function(payload){const embed=payload.embed;const cta=payload.cta;const variant=payload.variant;const step=payload.step;const section=payload.section;const element=payload.element;const submission_data=payload.submission_data;if(false==(element.options['confirmation-close']=="true"&&element.options['disable-conversion']=='true'&&(element.options['confirmation-type']=='redirect'||(element.options['confirmation-type']==undefined&&element.options['redirect-url'])))){if($cf(embed).find('.cf-element[data-id="'+element.id+'"]').attr('data-tracked')==undefined){$cf(embed).find('.cf-element[data-id="'+element.id+'"]').attr('data-tracked','true')
app.ctas.trackConversion(cta,variant,step,element,submission_data)}}
var true_action_group;if(element.action_groups!==undefined){$cf.each(element.action_groups,function(i,action_group){if(!action_group.data['confirmation-type']||(action_group.data['confirmation-type']=='redirect'&&(action_group.data['redirect-url']||action_group.data['confirmation-close']=='true'))||(action_group.data['confirmation-type']=='step'&&action_group.data['redirect-step'])||(action_group.data['confirmation-type']=='cta'&&action_group.data['confirmation-cta'])||(action_group.data['confirmation-type']=='message'&&action_group.data['confirmation'])||(action_group.data['confirmation-type']=='sms'&&action_group.data['sms-number'])){if(!true_action_group&&app.campaigns.checkConditions(action_group.conditions,window.convertflow.person,{variant:variant})==true){true_action_group=action_group;}}})}
app.ctas.performConfirmationAction({...payload,action_group:true_action_group});if(element.options['script']!==undefined&&element.options['script']!==""){try{$cf('body').append(element.options['script']);}catch(e){console.log(e.message,e.stack);};}
if(true_action_group&&true_action_group.actions){Object.values(true_action_group.actions).forEach(function(action){app.actions.run(action,event);});}
if(true_action_group&&true_action_group['data']['script']){try{$cf('body').append(true_action_group['data']['script']);}catch(e){console.log(e.message,e.stack);};}}
app.ctas.trackConversion=function(cta,variant,step,element,submission_data){if(app.live==true){var js_event={cta:cta,variant:variant,step:step,element:element,score:variant.score}
if(submission_data){js_event.fields=submission_data;}
if(element.element_type=='form'||element.element_type=='survey'){app.visitors.fireEvent('cfSubmit',js_event)}
app.visitors.fireEvent('cfConversion',js_event);var payload={event_type:'Complete',variant_id:variant.id,step_id:step.id,element_id:element.id}
if(variant.score!==undefined&&variant.score!==null){payload.data={score:variant.score}}
var action_groups=[]
if(element.action_groups!==undefined){$cf.each(element.action_groups,function(i,action_group){if($cf.isEmptyObject(action_group.conditions)==false&&app.campaigns.checkConditions(action_group.conditions,window.convertflow.person,{variant:variant})==true){action_groups.push(action_group.id)
if(action_group.actions&&$cf.map(action_group.actions,function(action){if(['Track completion of CTA','Track completion of campaign'].includes(action.action_type)){return action}}).length>0){var completion=Object.assign({},payload);completion['event_type']='Completion';app.ctas.track(completion,cta,element);app.visitors.fireEvent('cfCompletion',js_event);}}})}
if(action_groups.length>0){payload['action_groups']=action_groups.join()}
app.ctas.track(payload,cta,element);if($cf.map(element.actions,function(action){if(['Track completion of CTA','Track completion of campaign'].includes(action.action_type)){return action}}).length>0){var completion=Object.assign({},payload);completion['event_type']='Completion';app.ctas.track(completion,cta,element);app.visitors.fireEvent('cfCompletion',js_event);}}}
app.ctas.performConfirmationAction=function(payload){const element=payload.element;const action_group=payload.action_group;var element_confirmation_type=element?element.options['confirmation-type']:undefined;var can_use_default=(!action_group||!action_group.data['confirmation-type']);if((action_group&&action_group.data['confirmation-type']=='step')||(can_use_default&&element_confirmation_type=='step'&&element.options['redirect-step'])||(can_use_default&&!element_confirmation_type&&element.options['redirect-step'])){app.ctas.performConfirmationActionStep(payload);}else if((action_group&&action_group.data['confirmation-type']=='redirect'&&action_group.data['redirect-url'])||(can_use_default&&element_confirmation_type=='redirect'&&element.options['redirect-url'])||(can_use_default&&!element_confirmation_type&&element.options['redirect-url'])){app.ctas.performConfirmationActionRedirect(payload);}else if((action_group&&action_group.data['confirmation-type']=='cta'&&action_group.data['confirmation-cta'])||(can_use_default&&element_confirmation_type=='cta'&&element.options['confirmation-cta'])||(can_use_default&&!element_confirmation_type&&element.options['confirmation-cta'])){app.ctas.performConfirmationActionCta(payload);}else if((action_group&&action_group.data['confirmation-type']=='sms'&&action_group.data['sms-number'])||(can_use_default&&element_confirmation_type=='sms'&&element.options['sms-number'])){app.ctas.performConfirmationActionSms(payload);}else if(can_use_default&&['product','cart'].includes(element_confirmation_type)){if(payload.redirect_url){app.ctas.performConfirmationActionRedirect(payload);}
if(element_confirmation_type=='cart'){app.ctas.performConfirmationActionUpdateCart(payload);}}else if((action_group&&action_group.data['confirmation-type']=='message')||(can_use_default&&element_confirmation_type=='message')||(can_use_default&&!element_confirmation_type&&element.element_type!=='button')){app.ctas.performConfirmationActionMessage(payload);}
if((action_group&&['redirect','cta','sms'].includes(action_group.data['confirmation-type'])&&action_group.data['confirmation-close']=='true')||(can_use_default&&['redirect','cta','sms'].includes(element_confirmation_type)&&element.options['confirmation-close']=='true')||(can_use_default&&!element_confirmation_type&&element.options['confirmation-close']=='true')){app.ctas.performConfirmationActionClose(payload);}}
app.ctas.performConfirmationActionMessage=function(payload){const embed=payload.embed;const cta=payload.cta;const variant=payload.variant;const step=payload.step;const section=payload.section;const element=payload.element;const action_group=payload.action_group;var container=$cf('.cf-element[data-id="'+element.id+'"]');var confirmation_message=action_group&&action_group.data['confirmation-type']=='message'&&action_group.data['confirmation']?action_group.data['confirmation']:element.options['confirmation']?element.options['confirmation']:'Thanks!';var confirmation_style='';if(element.options['confirmation-background-color']){var confirmation_style=confirmation_style+'background: '+element.options['confirmation-background-color']+' !important;';}
if(element.options['confirmation-text-color']){var confirmation_style=confirmation_style+'color: '+element.options['confirmation-text-color']+' !important;';}
if(element.options['field-font']){var confirmation_style=confirmation_style+'font-family: '+element.options['field-font']+' !important;';}
var confirmation_style='style="'+confirmation_style+'"';$cf(container).find('.element-content').remove();$cf(container).html('<div class="cf-row cf-outer-center cf-center cf-regular-vspace cf-horizontal-somepadding cf-thanks-message" '+confirmation_style+'>'+confirmation_message+'</span>')}
app.ctas.performConfirmationActionStep=function(payload){const embed=payload.embed;const cta=payload.cta;const variant=payload.variant;const step=payload.step;const section=payload.section;const element=payload.element;const action_group=payload.action_group;const step_override=payload.step_override;const submission_data=payload.submission_data;var redirect_step=step_override||undefined;if(!redirect_step&&action_group&&action_group.data['confirmation-type']=='step'&&(action_group.data['redirect-step']=='previous'||variant.steps[action_group.data['redirect-step']])){redirect_step=action_group.data['redirect-step'];}
if(!redirect_step&&element){if(submission_data&&element.fields){Object.values(element.fields).forEach(function(field){if(field.slug&&field.field_options&&field.multi_select!==true){Object.values(field.field_options).forEach(function(field_option){if(!redirect_step&&field_option.step_id&&submission_data[field.slug]==field_option.value){redirect_step=field_option.step_id;}});}});}
if(!redirect_step&&element.options['redirect-step']){redirect_step=element.options['redirect-step'];}}
if(redirect_step&&(redirect_step=='previous'||variant.steps[parseInt(redirect_step)])){var next_step;if(redirect_step=='previous'&&variant.previousStep){next_step=variant.steps[variant.previousStep];}else{next_step=variant.steps[redirect_step]}
if(step){variant.previousStep=step.id;}
var skipped;if(redirect_step!=='previous'){skipped=app.ctas.initializeStep(cta,variant,next_step,embed);}
if(skipped==undefined&&next_step){$cf(embed).find('.cf-step').each(function(i,step_div){let step_div_id=$cf(step_div).attr('data-step-id');if(!step_div_id){step_div_id=$cf(step_div).attr('step-id');}
if(variant.steps[step_div_id]){$cf(step_div).attr('style','')
step_div.style.display='none';}})
$cf(embed).find('.cf-step[data-step-id="'+redirect_step+'"], .cf-step[step-id="'+next_step.id+'"]').each(function(i,step_div){$cf(step_div).attr('style','')
step_div.style.display='block';})
if(app.live==true&&next_step.tracked!==true){next_step.tracked=true;setTimeout(function(){app.ctas.track({event_type:'View',variant_id:variant.id,step_id:next_step.id},cta);app.visitors.fireEvent('cfView',{cta:cta,variant:variant,step:next_step});},500);}
if(element!==undefined&&element.element_type=='form'){$cf.each(element.contactData.split('&'),function(index,elem){var vals=elem.split('=');if(vals[0].indexOf('contact')>-1&&$cf(embed).find('div[id="step_'+next_step.id+'"] form').length&&vals[1].length&&vals[0]!=="contact%5Belement_id%5D"&&vals[0]!=="contact%5Bstep_id%5D"){var stepDiv=$cf(embed).find('div[id="step_'+next_step.id+'"]');$cf(stepDiv).find('.new_contact').each(function(){$cf(this).find('input[name="'+decodeURIComponent(vals[0])+'"]').val(decodeURIComponent(vals[1].replace(/\+/g,' ')));if($cf(this).attr('data-hide-prefilled-fields')=='true'){var field_div=$cf(this).find('[name="'+decodeURIComponent(vals[0])+'"]').parents('.cf-form-field')[0];if(field_div){$cf(field_div).attr('data-visible','false');}}})}})}
if(cta.cta_type=='page'){window.scrollTo(0,0);}
if(cta.cta_type=='bar'){if(variant.options['bar-position']=='top'){var barHeight=$cf(embed).find('.cta').outerHeight()
$cf('html').css('padding-top',barHeight+'px')}}
if(next_step!==undefined&&next_step['options']['script']!==undefined){try{$cf('body').append(next_step['options']['script']);}catch(e){console.log(e.message,e.stack);};}}}}
app.ctas.performConfirmationActionRedirect=function(payload){const embed=payload.embed;const cta=payload.cta;const variant=payload.variant;const step=payload.step;const section=payload.section;const element=payload.element;const action_group=payload.action_group;var redirect_url;var query_string;var target_blank;if(action_group&&action_group.data['confirmation-type']=='redirect'&&action_group.data['redirect-url']){redirect_url=action_group.data['redirect-url'];query_string=action_group.data['query-string'];target_blank=action_group.data['target-blank'];}
if(!redirect_url&&element.options['redirect-url']){redirect_url=element.options['redirect-url'];query_string=element.options['query-string'];target_blank=element.options['target-blank'];}
if(payload.redirect_url){redirect_url=payload.redirect_url;target_blank=element.options['target-blank'];}
if($cf.inArray(element.element_type,['form','survey'])>-1&&query_string=='true'){var queryString=function(form,redirect_url){var new_redirect_url=redirect_url
if($cf(form).attr('data-query-string')!=='false'){var paramMap={'extra':{}}
$cf.each(app.helpers.personMap(),function(key,value){var parameter=key
paramMap[parameter]=value
var option_attribute=value
if(value=='firstname'){var parameter='name'
var option_attribute='name'}
if(value=='lastname'){var parameter='last_name'}
if(value=='website'){var parameter='url'}
if(value=='company_name'){var parameter='company_name'
var option_attribute='company-name'}
if(value=='company_title'){var parameter='company_title'
var option_attribute='company-title'}
if(value=='zipcode'){var option_attribute='zip-code'}
if(element.options[option_attribute+'-redirect-dataname']){paramMap[parameter]=element.options[option_attribute+'-redirect-dataname']}})
$cf.each(element.fields,function(field_id,field){if(field.parameter==undefined||field.parameter==""){paramMap['extra'][field.slug]=field.slug}else{paramMap['extra'][field.slug]=field.parameter}})
if(new_redirect_url.indexOf("?")==-1){var query_start="?"}else{var query_start="&"}
var email_input=$cf(form).find('input[name="contact[email]"]').val()
if(email_input||convertflow.person.email!==undefined){if(email_input){var email_value=$cf(form).find('input[name="contact[email]"]').val()}else if(convertflow.person.email!==undefined){var email_value=convertflow.person.email}
new_redirect_url=new_redirect_url+query_start+paramMap['email']+'='+encodeURIComponent(email_value);}else{new_redirect_url=new_redirect_url+query_start+paramMap['email']+'=';}
delete paramMap.email
if(new_redirect_url.indexOf("&amp;")>-1){new_redirect_url=new_redirect_url.replace(new RegExp('&amp;','g'),'&');}
$cf.each(paramMap,function(contact_field,param_key){if(contact_field!=="extra"){var field=$cf(form).find('input[name="contact['+contact_field+']"]')
if(contact_field=='last_name'){var field_container=$cf(form).find('.cf-form-field[data-field="lastname"]')}else{var field_container=$cf(form).find('.cf-form-field[data-field="'+contact_field.replace('_','-')+'"]')}
var param_value=$cf(field).val()
if($cf(field_container).attr('data-visible')=='true'){new_redirect_url=new_redirect_url+'&'+param_key+'='+encodeURIComponent(param_value);}}else{$cf.each(param_key,function(field_slug,field_param){var field=$cf(form).find('[name="contact[extra]['+field_slug+']"], .cf-survey-field[data-field="'+field_slug+'"] .cf-survey-choice[data-selected="true"]')
var param_value=$cf(field).val()||$cf(field).attr('data-value')
if(param_value){new_redirect_url=new_redirect_url+'&'+field_param+'='+encodeURIComponent(param_value);}})}})}
return new_redirect_url}
var redirect_url=queryString($cf(embed).find('form[element-id="'+element.id+'"], .cf-element[data-id="'+element.id+'"] .cf-survey'),redirect_url)}
redirect_url=app.helpers.formatRedirectUrl(redirect_url);setTimeout(function(){if(element!==undefined&&target_blank!=="true"){window.location=redirect_url}else{window.open(redirect_url)}},500)}
app.ctas.performConfirmationActionCta=function(payload){const embed=payload.embed;const cta=payload.cta;const variant=payload.variant;const step=payload.step;const section=payload.section;const element=payload.element;const action_group=payload.action_group;var confirmation_cta_id;if(action_group&&action_group.data['confirmation-type']=='cta'&&action_group.data['confirmation-cta']){confirmation_cta_id=parseInt(action_group.data['confirmation-cta']);}
if(!confirmation_cta_id&&element.options['confirmation-cta']){confirmation_cta_id=parseInt(element.options['confirmation-cta']);}
var campaign=undefined;if(convertflow.ctas[cta.id]['broadcast_id']!==undefined){var campaign=app.website.broadcasts[convertflow.ctas[cta.id]['broadcast_id']]}
if(convertflow.ctas[confirmation_cta_id]==undefined){convertflow.load({cta_id:confirmation_cta_id,campaign:campaign,callback:function(){convertflow.trigger({cta_id:confirmation_cta_id})}});var confirmation_cta=convertflow.ctas[confirmation_cta_id]
if(confirmation_cta!==undefined){convertflow.ctas[confirmation_cta_id]['clicktriggered']=true}}else{convertflow.trigger({cta_id:confirmation_cta_id})}}
app.ctas.performConfirmationActionClose=function(payload){const embed=payload.embed;const cta=payload.cta;const variant=payload.variant;$cf(embed).hide()
if(variant.options['aggressive']=='false'&&variant.options['hide']!==""){app.helpers.setCookie('viewedCta'+cta.id,'true',parseInt(variant.options['hide'])*24*60)}
if(cta.cta_type=='bar'){if(variant.options['bar-position']=='bottom'){$cf(embed).find('.cta').addClass('slide-up')}else{var barHeight=$cf(embed).find('.cta').outerHeight()
$cf('html').css('padding-top',barHeight+'px')
$cf(embed).find('.cta').addClass('slide-down')}}
$cf(embed).find('.cf-video iframe[src]').each(function(i,frame){$cf(frame).removeAttr('src');});if(variant.options['trigger_type']!=='prehook'&&variant.options['prehook-trigger-on-close']+''=='true'){app.ctas.triggerTwoTap(cta,variant,embed);}
app.visitors.fireEvent("cfClose",{cta:cta,variant:variant});}
app.ctas.performConfirmationActionSms=function(payload){const embed=payload.embed;const cta=payload.cta;const variant=payload.variant;const step=payload.step;const section=payload.section;const element=payload.element;const action_group=payload.action_group;var sms_number=action_group&&action_group.data['confirmation-type']=='sms'&&action_group.data['sms-number']?action_group.data['sms-number']:element.options['sms-number']?element.options['sms-number']:'';var phone_number=sms_number.replaceAll('(','').replaceAll(')','').replaceAll(' ','').replaceAll('-','');var sms_keyword=action_group&&action_group.data['sms-keyword']?action_group.data['sms-keyword']:element.options['sms-keyword']?element.options['sms-keyword']:'';setTimeout(function(){window.location="sms:"+phone_number+"&body="+sms_keyword;},500)}
app.ctas.performConfirmationActionUpdateCart=function(payload){const embed=payload.embed;const cta=payload.cta;const variant=payload.variant;const step=payload.step;const section=payload.section;const element=payload.element;const action_group=payload.action_group;const productDiv=payload.productDiv;if(payload.embed.jquery){payload.embed=$cf(payload.embed)[0];}
const button=payload.button;if(button){const buttonNewContent=element.options["products-cart-button"]?element.options["products-cart-button"]:"<p>View Cart</p>";let cartURL=`${window.location.host}/cart`;const discountCode=element.options["products-cart-redirect-discount"];if(discountCode){cartURL=`${window.location.host}/discount/${discountCode}?redirect=/cart`;}
button.classList.add('cf-disabled');button.onclick=null;setTimeout(()=>{button.innerHTML=buttonNewContent;button.classList.remove('cf-disabled');button.onclick=(event)=>{event.preventDefault();window.location=app.helpers.formatRedirectUrl(cartURL);}},500);}}
app.ctas.incrementScore=function(embed,cta,variant,element,custom_field,custom_field_value,score_to_set){var scoreIncrement=0;if(!variant.score){variant.score=0;}
var field=Object.values(element.fields).filter(function(field){if(field.slug==custom_field){return field;}})[0];if(field&&field.field_options&&Object.values(field.field_options).length>0){var field_options=Object.values(field.field_options).filter(function(field_option){if(field_option.value==custom_field_value||custom_field_value.split(', ').includes(field_option.value)){return field_option;}});field_options.forEach((field_option)=>{if(field_option.score!==undefined&&field_option.score!==null){scoreIncrement+=field_option.score;}})}
variant.score=variant.score+scoreIncrement;$cf(embed).find('span[data-merge="CURRENT_SCORE"]').text(variant.score);return variant.score;}
app.elements.elementTypes={};app.elements.handleLoad=(payload)=>{const element=payload.element;const namespace=app.elements.elementTypes[element.element_type];if(namespace){namespace.handleLoad(payload);}};app.elements.elementTypes.products={handleLoad:(payload)=>{const element=payload.element;if(payload.embed.jquery){payload.embed=$cf(payload.embed)[0];}
const stepDiv=document.querySelector(`.cf-step[data-step-id="${payload.step.id}"]`);app.helpers.onVisible(stepDiv,()=>{app.elements.elementTypes.products.initialize(element,payload);});},initialize:(element,payload)=>{let objectToUse=element;const productRecommendations=element.product_recommendations||{};const trueConditionalRecommendation=Object.values(productRecommendations).filter((productRecommendation)=>{if(!$cf.isEmptyObject(productRecommendation.conditions)&&app.campaigns.checkConditions(productRecommendation.conditions,window.convertflow.person,{variant:payload.variant})==true){return productRecommendation;}})[0];if(trueConditionalRecommendation){objectToUse=trueConditionalRecommendation;}
app.elements.elementTypes.products.setupFeed(objectToUse,payload);},setupFeed:(object,payload)=>{const element=payload.element;if(element.options["products-source"]!=="Shopify"){Object.values(object.products).forEach((product)=>{const productDiv=payload.embed.querySelector(`.cf-products-item[data-product-id="${product.id}"]`);const productImage=productDiv.querySelector(".cf-products-item-image img");const productTitle=productDiv.querySelector(".cf-products-item-title p");const productPrice=productDiv.querySelector(".cf-products-item-price-base");const productPriceContainer=productDiv.querySelector(".cf-products-item-price p");const productDiscount=productDiv.querySelector(".cf-products-item-price-discount");const productDescription=productDiv.querySelector(".cf-products-item-description");const productVariantsSelectTag=productDiv.querySelector("select");const productButton=productDiv.querySelector(".cf-products-item-button");if(productVariantsSelectTag){productVariantsSelectTag.onchange=(event)=>{const value=productVariantsSelectTag.value;const selectedProductVariant=product.product_variants[value];const productDiscount=productDiv.querySelector(".cf-products-item-price-discount");if(selectedProductVariant&&selectedProductVariant.image){productImage.src=selectedProductVariant.image;}else if(product.image){productImage.src=product.image;}
if(selectedProductVariant&&selectedProductVariant.title){productTitle.innerText=selectedProductVariant.title;}else if(product.title){productTitle.innerText=product.title;}
let priceFormatted;if(selectedProductVariant&&selectedProductVariant.price){priceFormatted=selectedProductVariant.price;}else if(product.price){priceFormatted=product.price;}else{priceFormatted=0;}
productPriceContainer.innerHTML=`${app.website.currency_character}<span class="cf-products-item-price-base">${priceFormatted}</span>`;if(selectedProductVariant&&selectedProductVariant.discounted_price!==null){productPriceContainer.innerHTML=`<strike><span class="cf-products-item-price-base">${app.website.currency_character}${priceFormatted}</span></strike> ${app.website.currency_character}<span class="cf-products-item-price-discount">${selectedProductVariant.discounted_price}</span>`;}else if(product.discounted_price!==null){productPriceContainer.innerHTML=`<strike><span class="cf-products-item-price-base">${app.website.currency_character}${priceFormatted}</span></strike> ${app.website.currency_character}<span class="cf-products-item-price-discount">${product.discounted_price}</span>`;}else if(element.options["products-discount-type"]=="amount"||element.options["products-discount-type"]=="percentage"){let priceDiscounted=priceFormatted;if(element.options["products-discount-type"]=="amount"){const discountAmount=element.options["products-discount-amount"]||10;priceDiscounted=priceFormatted-parseInt(discountAmount);}
if(element.options["products-discount-type"]=="percentage"){const discountPercentage=element.options["products-discount-percentage"]||10;priceDiscounted=priceFormatted-
priceFormatted*(parseInt(discountPercentage)*0.01);}
if(priceDiscounted<0){priceDiscounted=0;}
productPriceContainer.innerHTML=`<strike><span class="cf-products-item-price-base">${app.website.currency_character}${priceFormatted}</span></strike> ${app.website.currency_character}<span class="cf-products-item-price-discount">${priceDiscounted}</span>`;}
if(selectedProductVariant&&selectedProductVariant.description){productDescription.innerHTML=selectedProductVariant.description;}else if(product.description){productDescription.innerHTML=product.description;}};}
const onClick=(event)=>{app.elements.elementTypes.products.handleClick({...payload,product:product,button:productButton},productDiv);};if(element.options["products-button"]!=="false"||object.options["confirmation-type"]=="cart"){productButton.onclick=onClick;}else{const clickableDiv=productDiv.querySelector(".cf-products-item-inner");clickableDiv.style.cursor="pointer";clickableDiv.onclick=onClick;}
productDiv.style.display="block";});}else if(element.options["products-source"]=="Shopify"&&app.live==true&&window.Shopify){const productsSource=object.options["shopify-products-source"]||"cart";const productsLimit=element.options["products-limit"]||"3";const integration=Object.values(app.website.integrations).filter((integration)=>integration.integration_type=="Shopify")[0];const productsContainer=payload.embed.querySelector(`.cf-products-outer[data-element-id="${payload.element.id}"]`);productsContainer.style.visibility="hidden";function loadCartItems(items){const shopifyProductHandles=items.map((shopifyProduct)=>shopifyProduct.handle);const productsLimitInt=parseInt(productsLimit);const shopifyProducts=shopifyProductHandles.map((handle)=>({handle:handle,})).slice(0,productsLimitInt);app.elements.elementTypes.products.shopifyBuildFeed(payload,shopifyProducts);shopifyProductHandles.forEach((handle)=>{$cf.getJSON(window.Shopify.routes.root+`products/${handle}.js`,function(shopifyProduct){app.elements.elementTypes.products.shopifyPopulateProduct(payload,shopifyProduct);});});}
if(productsSource=="cart"&&integration){loadCartItems(integration["cart"]["items"]);}
if(productsSource=="related"){let productIdForRecommendation=element.options["shopify-products-related-default"];if((!object.options["shopify-products-related-type"]||object.options["shopify-products-related-type"]=="current")&&window.ShopifyAnalytics&&ShopifyAnalytics.meta&&ShopifyAnalytics.meta.product&&ShopifyAnalytics.meta.product.id){productIdForRecommendation=ShopifyAnalytics.meta.product.id;}
function fetchProductRecommendations(productIdForRecommendation){fetch(window.Shopify.routes.root+
`recommendations/products.json?product_id=${productIdForRecommendation}&limit=${productsLimit}`).then((response)=>response.json()).then(({products})=>{app.elements.elementTypes.products.shopifyBuildFeed(payload,products||[]);});}
if(object.options["shopify-products-related-type"]=="cart"&&integration){if(["inline","page"].includes(payload.cta.cta_type)&&integration["cart"]&&integration["cart"]["items"]&&integration["cart"]["items"].length>0&&integration["cart"]["items"][0].product_id){productIdForRecommendation=integration["cart"]["items"][0].product_id;fetchProductRecommendations(productIdForRecommendation);}else{setTimeout(function(){fetch(window.Shopify.routes.root+"cart.js").then((response)=>response.json()).then(({items})=>{if(items&&items[0]&&items[0].product_id){productIdForRecommendation=items[0].product_id;}
fetchProductRecommendations(productIdForRecommendation);});},500);}}else{fetchProductRecommendations(productIdForRecommendation);}}
if(productsSource=="filter"){const productsFilter=object.options["shopify-products-filter"];fetch(window.Shopify.routes.root+
`search/suggest.json?q=${productsFilter}&resources[type]=product&limit=${productsLimit}&resources[options][unavailable_products]=hide&resources[options][fields]=title,product_type,variants.title,tag`).then((response)=>response.json()).then((suggestions)=>{const shopifyProductHandles=suggestions.resources.results.products.map((shopifyProduct)=>shopifyProduct.handle);const shopifyProducts=shopifyProductHandles.map((handle)=>({handle:handle,}));app.elements.elementTypes.products.shopifyBuildFeed(payload,shopifyProducts);shopifyProductHandles.forEach((handle)=>{$cf.getJSON(window.Shopify.routes.root+`products/${handle}.js`,function(shopifyProduct){app.elements.elementTypes.products.shopifyPopulateProduct(payload,shopifyProduct);});});});}
if(productsSource=="selected"){const shopifyProductHandles=object.options["shopify-products-selected"].split(",").sort((a,b)=>a.localeCompare(b));const shopifyProducts=shopifyProductHandles.map((handle)=>({handle:handle,}));app.elements.elementTypes.products.shopifyBuildFeed(payload,shopifyProducts);shopifyProductHandles.forEach((handle)=>{$cf.getJSON(window.Shopify.routes.root+`products/${handle}.js`,function(shopifyProduct){app.elements.elementTypes.products.shopifyPopulateProduct(payload,shopifyProduct);});});}
if(productsSource=="collection"){const collectionId=object.options["shopify-products-collection"];if(collectionId){fetch(window.Shopify.routes.root+
`collections/${collectionId}/products.json`).then((response)=>response.json()).then(({products})=>{app.elements.elementTypes.products.shopifyBuildFeed(payload,products||[]);products.forEach((collectionItem)=>{$cf.getJSON(window.Shopify.routes.root+
`products/${collectionItem.handle}.js`,function(shopifyProduct){app.elements.elementTypes.products.shopifyPopulateProduct(payload,shopifyProduct);});});});}else{app.elements.elementTypes.products.shopifyBuildFeed(payload,[]);}}}else if(element.options["products-source"]=="Shopify"){if(app.live!==true){document.querySelectorAll(`.cf-products-outer[data-element-id="${element.id}"] .cf-products-item`).forEach((productDiv)=>{productDiv.style.display="block";});}else{app.elements.elementTypes.products.showEmptyMessage(payload);}}},shopifyBuildFeed:(payload,shopifyProducts)=>{const productsContainer=payload.embed.querySelector(`.cf-products-outer[data-element-id="${payload.element.id}"]`);let shopifyProductDivs=[];const productDivTemplate=productsContainer.firstChild.cloneNode(true);productsContainer.style.visibility="initial";productsContainer.replaceChildren();if(shopifyProducts.length>0){shopifyProducts.forEach((shopifyProduct)=>{const productDiv=productDivTemplate.cloneNode(true);productDiv.setAttribute("data-handle",shopifyProduct.handle);productsContainer.appendChild(productDiv);if(shopifyProduct.title){app.elements.elementTypes.products.shopifyPopulateProduct(payload,shopifyProduct);}});if(payload.element.options["products-button-cart-all"]=="true"){app.elements.elementTypes.products.shopifyAddAllToCart(payload,shopifyProducts);}}
if(shopifyProducts.length==0){app.elements.elementTypes.products.showEmptyMessage(payload);}},shopifyPopulateProduct:(payload,shopifyProduct)=>{const element=payload.element;const productDiv=payload.embed.querySelector(`.cf-products-outer[data-element-id="${payload.element.id}"]  .cf-products-item[data-handle="${shopifyProduct.handle}"]`);if(productDiv){const productImage=productDiv.querySelector(".cf-products-item-image");const productTitle=productDiv.querySelector(".cf-products-item-title p");const productPriceContainer=productDiv.querySelector(".cf-products-item-price p");const productPrice=productDiv.querySelector(".cf-products-item-price-base");const productDiscount=productDiv.querySelector(".cf-products-item-price-discount");const productDescription=productDiv.querySelector(".cf-products-item-description");const productButtonOuter=productDiv.querySelector(".cf-products-item-button-outer");const productButton=productDiv.querySelector(".cf-products-item-button");if(shopifyProduct.featured_image){productImage.innerHTML=`<img src="${shopifyProduct.featured_image}" loading="lazy" />`;}
if(shopifyProduct.title){productTitle.innerText=shopifyProduct.title;}
if(shopifyProduct.price){productDiv.setAttribute("data-product-price",shopifyProduct.price);let priceFormatted=(shopifyProduct.price/100).toFixed(2);productPrice.innerText=priceFormatted;let priceDiscounted;if(element.options["products-discount-type"]=="amount"){let discountAmount=element.options["products-discount-amount"]||10;priceDiscounted=priceFormatted-parseInt(discountAmount);}
if(element.options["products-discount-type"]=="percentage"){let discountPercentage=element.options["products-discount-percentage"]||10;priceDiscounted=priceFormatted-
priceFormatted*(parseInt(discountPercentage)*0.01);}
if(priceDiscounted!==undefined){if(priceDiscounted<0){priceDiscounted=0;}
let originalPrice=productPriceContainer.querySelector("strike")||document.createElement("strike");let discountFormatted=priceDiscounted.toFixed(2);originalPrice.innerHTML=`${app.website.currency_character}<span className="cf-products-item-price-base">${priceFormatted}</span> `;productPriceContainer.prepend(originalPrice);productDiscount.innerHTML=discountFormatted;}}
if(shopifyProduct.description&&element.options["products-descriptions"]!=="false"){productDescription.innerHTML=shopifyProduct.description;}else if(element.options["products-descriptions"]!=="false"){productDescription.innerHTML="<p></p>";}
if(element.options["confirmation-type"]=="cart"&&shopifyProduct.variants.length>0){const selectTag=productDiv.querySelector(".cf-products-item-variants select");const shopifyProductVariantOptions=[];shopifyProduct.variants.forEach((shopifyProductVariant)=>{const optionTag=document.createElement("option");optionTag.value=shopifyProductVariant.id;optionTag.innerText=shopifyProductVariant.name;shopifyProductVariantOptions.push(optionTag);});selectTag.replaceChildren(...shopifyProductVariantOptions);selectTag.onchange=(event)=>{const value=selectTag.value;const selectedProductVariant=Object.values(shopifyProduct.variants).filter((shopifyProductVariant)=>shopifyProductVariant.id+""==value)[0];if(selectedProductVariant){if(selectedProductVariant.featured_image&&selectedProductVariant.featured_image.src){productImage.innerHTML=`<img src="${selectedProductVariant.featured_image.src}" loading="lazy" />`;}
if(selectedProductVariant.name){productTitle.innerText=selectedProductVariant.name;}
if(selectedProductVariant.price){let priceFormatted=(selectedProductVariant.price/100).toFixed(2);productPrice.innerText=priceFormatted;let priceDiscounted;if(element.options["products-discount-type"]=="amount"){let discountAmount=element.options["products-discount-amount"]||10;priceDiscounted=priceFormatted-parseInt(discountAmount);}
if(element.options["products-discount-type"]=="percentage"){let discountPercentage=element.options["products-discount-percentage"]||10;priceDiscounted=priceFormatted-
priceFormatted*(parseInt(discountPercentage)*0.01);}
if(priceDiscounted!==undefined){const originalPrice=productPriceContainer.querySelector("strike")||document.createElement("strike");const discountFormatted=priceDiscounted.toFixed(2);originalPrice.innerHTML=`${app.website.currency_character}<span className="cf-products-item-price-base">${priceFormatted}</span> `;productPriceContainer.prepend(originalPrice);productDiscount.innerHTML=discountFormatted;}}}};}
const onClick=(event)=>{app.elements.elementTypes.products.handleClick({...payload,shopifyProduct:shopifyProduct,button:productButton},productDiv);};if(element.options["products-button"]!=="false"||element.options["confirmation-type"]=="cart"){productButton.onclick=onClick;}else{const clickableDiv=productDiv.querySelector(".cf-products-item-inner");clickableDiv.style.cursor="pointer";clickableDiv.onclick=onClick;}
productDiv.style.display="block";}},handleClick:(payload,productDiv)=>{const element=payload.element;const product=payload.product;if(element.options["products-source"]!=="Shopify"){let redirectURL=product.redirect_url;if(element.options["products-button"]!=="false"&&product.product_variants&&Object.values(product.product_variants).length>0){const productVariantSelectTag=productDiv.querySelector("select");const selectedProductVariantID=productVariantSelectTag.value;const selectedProductVariant=product.product_variants[selectedProductVariantID];if(selectedProductVariant&&selectedProductVariant.redirect_url){redirectURL=selectedProductVariant.redirect_url;}}
app.ctas.conversionLogic({...payload,redirect_url:redirectURL});}
if(element.options["products-source"]=="Shopify"){const shopifyProduct=payload.shopifyProduct;if(element.options["confirmation-type"]=="cart"&&shopifyProduct.variants.length>0){const selectTag=productDiv.querySelector(".cf-products-item-variants select");const selectedProductVariantID=selectTag.value;if(selectedProductVariantID){$cf.ajax({type:"POST",url:window.Shopify.routes.root+"cart/add.js",data:{items:[{id:selectedProductVariantID,quantity:1,},],},dataType:"json",success:function(data){app.visitors.fireEvent("cfAddToCart",{cta:payload.cta,variant:payload.variant,step:payload.step,element:payload.element,});},});let redirectURL=element.options["products-cart-redirect"]=="true"?`${window.location.host}/cart`:undefined;const discountCode=element.options["products-cart-redirect-discount"];if(redirectURL&&discountCode){redirectURL=`${window.location.host}/discount/${discountCode}?redirect=/cart`;}
let integration=$cf.map(app.website.integrations,function(integration){if(integration.integration_type=="Shopify")return integration;})[0];if(integration){integration.cart=integration.cart||{};integration.cart.items=integration.cart.items||[];integration.cart.items.push(shopifyProduct);integration.cart.item_count=integration.cart.item_count||0;integration.cart.item_count+=1;integration.cart.original_total_price=integration.cart.original_total_price||0;integration.cart.original_total_price+=shopifyProduct.price;integration.cart.total_price=integration.cart.total_price||0;integration.cart.total_price+=shopifyProduct.price;app.visitors.updateShopifyCart(integration.cart);}
app.ctas.conversionLogic({...payload,redirect_url:redirectURL,productDiv:productDiv,});}}
if(element.options["confirmation-type"]=="product"){let redirectURL=`/products/${shopifyProduct.handle}`;const discountCode=element.options["products-cart-redirect-discount"];if(redirectURL&&discountCode){redirectURL=`/discount/${discountCode}?redirect=/products/${shopifyProduct.handle}`;}
app.ctas.conversionLogic({...payload,redirect_url:`${window.location.host}${redirectURL}`,});}}},shopifyAddAllToCart:(payload,shopifyProducts)=>{const element=payload.element;const elementDiv=payload.embed.querySelector(`.cf-element[data-element-id="${element.id}"]`);const addAllButton=elementDiv.querySelector(`.cf-products-all-button-outer .cf-button`);if(!addAllButton)return false;addAllButton.onclick=(event)=>{let productVariantIds=[];elementDiv.querySelectorAll(".cf-products-item-variants select").forEach((select)=>{productVariantIds.push({id:select.value,quantity:1,});});$cf.ajax({type:"POST",url:window.Shopify.routes.root+"cart/add.js",data:{items:productVariantIds,},dataType:"json",success:function(data){app.visitors.fireEvent("cfAddToCart",{cta:payload.cta,variant:payload.variant,step:payload.step,element:payload.element,});},});let integration=$cf.map(app.website.integrations,function(integration){if(integration.integration_type=="Shopify")return integration;})[0];if(integration){shopifyProducts.forEach((shopifyProduct)=>{integration.cart=integration.cart||{};integration.cart.items=integration.cart.items||[];integration.cart.items.push(shopifyProduct);integration.cart.item_count=integration.cart.item_count||0;integration.cart.item_count+=1;const productDiv=elementDiv.querySelector(`.cf-products-item[data-handle=\"${shopifyProduct.handle}\"]`);if(productDiv&&productDiv.getAttribute("data-product-price")){const price=parseInt(productDiv.getAttribute("data-product-price"));integration.cart.original_total_price=integration.cart.original_total_price||0;integration.cart.original_total_price+=price;integration.cart.total_price=integration.cart.total_price||0;integration.cart.total_price+=price;}
app.visitors.updateShopifyCart(integration.cart);});}
let redirectURL=element.options["products-cart-redirect"]=="true"?`/cart`:undefined;const discountCode=element.options["products-cart-redirect-discount"];if(redirectURL&&discountCode){redirectURL=`/discount/${discountCode}?redirect=/cart`;}
app.ctas.conversionLogic({...payload,redirect_url:redirectURL?`${window.location.host}${redirectURL}`:undefined,button:addAllButton,});};},showEmptyMessage:(payload)=>{const elementDiv=payload.embed.querySelector(`.cf-element[data-element-id="${payload.element.id}"]`);const productsEmptyDiv=elementDiv.querySelector(`.cf-products-empty-message`);const addAllButton=elementDiv.querySelector(`.cf-products-all-button-outer .cf-button`);if(addAllButton){addAllButton.style.display="none";}
productsEmptyDiv.style.display="block";},};app.sections.handleLoad=(payload)=>{const section=payload.section;Object.values(section.elements).forEach((element)=>{app.elements.handleLoad({element:element,...payload});});};app.steps.handleLoad=(payload)=>{const step=payload.step;Object.values(step.sections).forEach((section)=>{app.sections.handleLoad({section:section,...payload});});};app.variants.handleLoad=(payload)=>{const cta=payload.cta;const variant=payload.variant;Object.values(variant.steps).forEach((step)=>{app.steps.handleLoad({step:step,...payload});});};app.visitors.generateUID=function(){return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=='x'?r:(r&0x3|0x8);return v.toString(16);});}
app.visitors.uid=function(override){var cookie='cf_'+app.website.id+'_id';var uid=app.helpers.getCookie(cookie);if(app.helpers.getCookie(cookie)==undefined||override==true){var uid=app.visitors.generateUID()
app.helpers.setCookie(cookie,uid,20*365*24*60);}
return uid}
app.visitors.urlIdentification=function(){var email=undefined;if(app.website.url_identification=='true'){$cf.each(['cf_email','email','Email','EmailAddress','email_address','emailaddresss','inf_field_Email'],function(index,key){var parameter=app.helpers.getParameterByName(key)
if(parameter!==""){email=parameter
return false}})}
return email}
app.visitors.create=function(){var session_time=new Date().toISOString();var visitor={website_id:app.website.id,visitor_token:app.visitors.uid(),contact_id:null,landing_page:window.location.href,platform:convertflow.platform||"Web",data:{}}
if(document.referrer!==""&&document.referrer.includes(location.host)==false){visitor.referral_source=document.referrer}
var payload={visitor:visitor,new:true,utms:{}}
$cf.each(['utm_source','utm_medium','utm_campaign','utm_term','utm_content'],function(i,utm_param){var utm=app.helpers.getParameterByName(utm_param)
if(utm){payload.utms[utm_param]=utm}})
$cf.ajax({type:"GET",url:app.api_visitors+app.visitors.uid(),contentType:"application/json; charset=utf-8",data:payload,dataType:"JSONP",complete:function(data,status,xhr){window.convertflow.person.last_requested=$cf.now();if(data&&data.responseJSON&&(data.responseJSON['logged_in']==true||"false"=="true")){app.helpers.setCookie('cf_'+app.website.id+'_logged_in','true',60*24*60);if(window.convertflow.readyFired==true){app.admin.initialize(convertflow.app.website);}}}});visitor.last_requested=$cf.now();window.convertflow.person=visitor;var continue_without_response=true;var integrations_to_sync=app.visitors.integrationsToSync(true);if(integrations_to_sync&&integrations_to_sync.length>0){var continue_without_response=false;integrations_to_sync.forEach(function(integration_to_sync){app.visitors.targetingSync(integration_to_sync);})}
if(continue_without_response==true){app.visitors.initialize(visitor);}}
app.visitors.get=function(){$cf.ajax({type:"GET",url:app.api_visitors+app.visitors.uid(),contentType:"application/json; charset=utf-8",dataType:"JSONP",timeout:5000,success:function(person,status,xhr){person.last_requested=$cf.now();app.helpers.setCookie(app.visitors.expiration_cookie,person.last_requested);var person=app.visitors.appendLocalContactFields(person);window.convertflow.person=person;var continue_without_response=true;var integrations_to_sync=app.visitors.integrationsToSync(true);if(integrations_to_sync&&integrations_to_sync.length>0){var continue_without_response=false;integrations_to_sync.forEach(function(integration_to_sync){app.visitors.targetingSync(integration_to_sync);})}
if(continue_without_response==true){app.visitors.initialize(person);}},error:function(){app.visitors.uid(true);app.visitors.create();}});}
app.visitors.integrationsToSync=function(clear_params){var integrations_to_sync=[];$cf.each(app.website.integrations,function(i,integration){if(integration.targeting_sync_id_type){var current_targeting_data=window.convertflow.person&&window.convertflow.person.data[integration.integration_type.toLowerCase()]&&window.convertflow.person.data[integration.integration_type.toLowerCase()]['last_sync']?window.convertflow.person.data[integration.integration_type.toLowerCase()]:undefined;var can_sync_with_param=(app.helpers.getParameterByName(integration.targeting_sync_parameter)&&!current_targeting_data);var can_sync_with_existing_data=(integration.targeting_sync_id_type=='email'&&!current_targeting_data&&window.convertflow.person&&window.convertflow.person.email)||(integration.targeting_sync_id_type=='phone'&&!current_targeting_data&&window.convertflow.person&&window.convertflow.person.phone)||(current_targeting_data&&(current_targeting_data['id']||integration.targeting_sync_id_type=='email'||integration.targeting_sync_id_type=='phone')&&current_targeting_data['last_sync']&&app.helpers.parseDate(current_targeting_data['last_sync'])<=(Date.parse(new Date())-(30*60*1000)));if(can_sync_with_param||can_sync_with_existing_data){if(can_sync_with_param){var contact_id=app.helpers.getParameterByName(integration.targeting_sync_parameter);if(clear_params==true){app.visitors.removeTargetingSyncParameter(integration.targeting_sync_parameter);}}
if(can_sync_with_existing_data){if(current_targeting_data&&current_targeting_data['id']){var contact_id=current_targeting_data['id'];}
if(integration.targeting_sync_id_type=='email'&&window.convertflow.person.email){var contact_id=window.convertflow.person.email;}
if(integration.targeting_sync_id_type=='phone'&&window.convertflow.person.phone){var contact_id=window.convertflow.person.phone;}}
if(contact_id){integrations_to_sync.push({integration_id:integration.id,integration_type:integration.integration_type,contact_id:contact_id,website_id:app.website.id})}}}})
return integrations_to_sync}
app.visitors.removeTargetingSyncParameter=function(param){if(location.search.indexOf(param+'=')!==-1){var replace='';try{var url=new URL(location);url.searchParams.delete(param);replace=url.href;}catch(ex){var regExp=new RegExp('[?&]'+param+'=.*$');replace=location.search.replace(regExp,'');replace=location.pathname+replace+location.hash;}
history.replaceState(null,'',replace);}}
app.visitors.canUseLocal=function(localperson){var conclusion=false;var targetingSync=app.visitors.integrationsToSync(false);var local_storage_can_be_used=(localperson!==null&&app.helpers.getCookie(app.visitors.localstorage_prevent)!=='true');var website_id_matches=(local_storage_can_be_used&&localperson.website_id!==undefined&&localperson.website_id==app.website.id);var localperson_was_requested_recently=(local_storage_can_be_used&&localperson.last_requested!==undefined&&localperson.last_requested>=Date.parse(new Date())-(30*60*1000));var localperson_has_not_expired=local_storage_can_be_used&&(app.helpers.getCookie(app.visitors.expiration_cookie)==undefined||parseInt(app.helpers.getCookie(app.visitors.expiration_cookie))<=localperson.last_requested);var localperson_last_update_matches=local_storage_can_be_used&&(app.helpers.getCookie(app.visitors.localstorage_last_update))==localperson.last_updated;var targeting_sync_is_not_running=(!targetingSync||targetingSync.length==0);var not_waiting_on_contact_processing=(local_storage_can_be_used&&(localperson.email!==undefined&&localperson.person_type!=='Contact')==false);if(local_storage_can_be_used&&website_id_matches&&localperson_was_requested_recently&&targeting_sync_is_not_running&&localperson_has_not_expired&&localperson_last_update_matches&&not_waiting_on_contact_processing){var conclusion=true;}
return conclusion;}
app.visitors.appendLocalContactFields=function(person){var localperson=app.helpers.decompressAndGet(app.local_person)
if(person.person_type=='Visitor'&&localperson&&localperson.email&&localperson.person_type!=='Contact'){var contactFields=['email','name','last_name','phone','website','company_name','company_title','city','country','address','state','zip_code','extra']
contactFields.forEach(function(field){if(field!=='extra'){if(!person[field]&&localperson[field]){person[field]=localperson[field]}}else{if(!person['extra']&&localperson['extra']){person['extra']=localperson['extra']}else if(person['extra']&&localperson['extra']){Object.keys(localperson['extra']).forEach(function(custom_field){if(!person['extra'][custom_field]){person['extra'][custom_field]=localperson['extra'][custom_field];}})}}})}
return person;}
app.visitors.visitEvent=function(){var visit={event_type:'Visit',visitor_token:app.visitors.uid(),url:window.location.href,website_id:app.website.id,data:{title:document.title}}
if($cf.isEmptyObject(app.helpers.getQueryString())==false&&app.website.data["contact-processing"]!=="false"){visit.data=$cf.extend({},visit.data,{params:app.helpers.getQueryString()})}
return visit}
app.visitors.trackEvent=function(event,skip_database_storage){if(convertflow.person&&window.convertflow.readyFired==true){event.website_id=app.website.id
event.visitor_token=app.visitors.uid()
if(convertflow.person!==undefined){var id=convertflow.person.id_bigint||convertflow.person.id;if(convertflow.person.person_type=='Visitor'){event.visitor_id=id;event.visitor_id_bigint=id;}
if(convertflow.person.person_type=='Contact'){event.contact_id=id;}}
if($cf.inArray(event.event_type,['View','Complete','Completion'])>-1){app.visitors.addEngagementToHistory(event);}
app.actions.mapEventToActions(event);var payload={};if(event.action_groups){payload['action_groups']=event.action_groups
delete event.action_groups}
payload['event']=event
if(app.helpers.canStringify()&&skip_database_storage!==true){if(payload['event']['visitor_token']){$cf.ajax({type:"GET",url:app.api_events,contentType:"application/json; charset=utf-8",data:payload,dataType:"JSONP",complete:function(data,status,xhr){}});}else{throw "ConvertFlow event lacks visitor_token"}}}else if(window.convertflow.readyFired==undefined){setTimeout(function(){app.visitors.trackEvent(event,skip_database_storage);},500)}}
app.visitors.initialize=function(data){if(!data.visit_already_stored){var data=app.visitors.addPageViewToHistory(data);}else{delete data.visit_already_stored;}
window.convertflow.person=data;app.helpers.compressAndStore(app.local_person,data)
var visit_event=app.visitors.visitEvent();app.visitors.trackEvent(visit_event);var continue_without_enrichment=true;var enrichment_integrations=app.visitors.enabledEnrichmentIntegrations();if(enrichment_integrations&&enrichment_integrations.length>0){var continue_without_enrichment=false;$cf.each(enrichment_integrations,function(i,integration_type){app.visitors.enrichmentIntegration(integration_type);});}
if(convertflow.person.email===undefined&&app.visitors.urlIdentification()!==undefined){var continue_without_enrichment=false;convertflow.identify({email:app.visitors.urlIdentification()});}
if(continue_without_enrichment==true){app.visitors.ready();}}
app.visitors.enabledEnrichmentIntegrations=function(){var response=[];if(app.geotargeting==true&&(!convertflow.person.data||!convertflow.person.data.location)){response.push('geolocation');}
$cf.each(app.website.integrations,function(i,integration){if($cf.inArray(integration.integration_type,['Shopify','Clearbit'])>-1){response.push(integration.integration_type);}});return response;}
app.visitors.enrichmentIntegration=function(integration_type){if(integration_type=='geolocation'){app.visitors.enrichment_status['geolocation']='in progress';$cf.ajax({type:"GET",url:'https://convertflow.co/geolocation/',dataType:"JSONP",success:function(data,status,xhr){app.visitors.enrichment_status['geolocation']='success';var visitor=window.convertflow.person;visitor.data=visitor.data||{};var location={latitude:data['lat'],longitude:data['lon'],city:data['city'],regionName:data['regionName'],region:data['region'],country:data['country'],countryCode:data['countryCode'],timezone:data['timezone'],zip:data['zip']}
visitor.data.location=location;visitor.city=location.city;visitor.country=location.country;visitor.state=location.regionName;visitor.zip_code=location.zip;app.helpers.compressAndStore(app.local_person,visitor)
if(Object.values(app.visitors.enrichment_status).includes('in progress')==false){app.visitors.ready();}},timeout:1000,error:function(){app.visitors.enrichment_status['geolocation']='failed';if(Object.values(app.visitors.enrichment_status).includes('in progress')==false){app.visitors.ready();}}});}
if(integration_type=='Shopify'){if(window.Shopify&&typeof window.Shopify=='object'){app.visitors.enrichment_status['Shopify']='in progress';$cf.get("/cart.js",function(data){app.visitors.enrichment_status['Shopify']='success';app.visitors.updateShopifyCart(data);if(Object.values(app.visitors.enrichment_status).includes('in progress')==false){app.visitors.ready();}},'json').fail(function(){app.visitors.enrichment_status['Shopify']='failed';if(Object.values(app.visitors.enrichment_status).includes('in progress')==false){app.visitors.ready();}});}else if(Object.values(app.visitors.enrichment_status).includes('in progress')==false){app.visitors.ready();};}};app.visitors.updateShopifyCart=function(cart){let integration=$cf.map(app.website.integrations,function(integration){if(integration.integration_type=="Shopify")return integration;})[0];if(integration){integration['cart']=cart;}
if(cart){window.convertflow.cart=window.convertflow.cart||{};if(cart.total_price){window.convertflow.cart['value']=cart.original_total_price/100;}
if(cart.item_count){window.convertflow.cart['count']=cart.item_count;}}}
app.visitors.addPageViewToHistory=function(data){var person=data;var url=app.helpers.cleanURL(window.location.href);var time_now=app.helpers.timeNow();var fallback_session={pages:0,sessions:1,current:time_now};if(person.data.visits==undefined){var history={pages:0}}else{var history=person.data.visits;}
if(history[url]==undefined){history[url]=0;}
if(history.session==undefined){history.session=fallback_session;}
if(app.helpers.parseDate(history.session.current)<=(Date.parse(new Date())-(30*60*1000))){history.session.previous=history.session.current;history.session.current=time_now;}
history.pages=history.pages+1;history.session.pages=history.session.pages+1;history[url]=history[url]+1;person.data.visits=history;var params_current=app.helpers.getQueryString()
var params_new=person.data.params||{}
$cf.each(params_current,function(key,value){params_new[key]=value})
person.data.params=params_new
return person;}
app.visitors.addEngagementToHistory=function(event){var person=window.convertflow.person;person.data=person.data||{};person.data['campaigns']=person.data['campaigns']||{};if(event.contactable_id){person.data.campaigns['ctas']=person.data.campaigns['ctas']||{};var cta_object=person.data['campaigns']['ctas'][event.contactable_id]||{};var cta_stats=cta_object['stats']||{};cta_stats[event.event_type]=cta_stats[event.event_type]||0;cta_stats[event.event_type]+=1;cta_object['stats']=cta_stats;if(event.variant_id){var variant_id=event.variant_id;cta_object['variants']=cta_object['variants']||{};var variant_object=cta_object['variants'][variant_id]||{};var variant_stats=variant_object['stats']||{};variant_stats[event.event_type]=variant_stats[event.event_type]||0;variant_stats[event.event_type]+=1;variant_object['stats']=variant_stats;if(event.step_id){var step_id=event.step_id;variant_object['steps']=variant_object['steps']||{};var step_object=variant_object['steps'][step_id]||{};var step_stats=step_object['stats']||{};step_stats[event.event_type]=step_stats[event.event_type]||0;step_stats[event.event_type]+=1;step_object['stats']=step_stats;if(event.element_id){var element_id=event.element_id;step_object['elements']=step_object['elements']||{};var element_object=step_object['elements'][element_id]||{};var element_stats=element_object['stats']||{};element_stats[event.event_type]=element_stats[event.event_type]=0;element_stats[event.event_type]+=1;element_object['stats']=element_stats;step_object['elements'][element_id]=element_object;}
variant_object['steps'][step_id]=step_object;}
cta_object['variants'][variant_id]=variant_object;}
person.data.campaigns.ctas[event.contactable_id]=cta_object;}
app.helpers.compressAndStore(app.local_person,person);}
app.visitors.ready=function(){app.campaigns.initialize(app.website);window.convertflow.readyFired=true;if(app.helpers.getCookie('cf_'+app.website.id+'_logged_in')=='true'){app.admin.initialize(convertflow.app.website);}
var trigger_ready=function(){$cf(document).trigger("cfReady");try{window.dispatchEvent(new CustomEvent('cfReady',{detail:false}));}catch(error){var evt=document.createEvent("CustomEvent");evt.initCustomEvent('cfReady',undefined,undefined,undefined);window.dispatchEvent(evt);};}
if(document.readyState=='complete'){trigger_ready()}else{$cf(document).ready(function(){trigger_ready()})}}
app.visitors.targetingSync=function(payload){if(app.website.integrations[payload.integration_id]){var integration_type_key=payload.integration_type.toLowerCase();app.visitors.targeting_sync_status[integration_type_key]=false;var targeting_sync_url='https://convertflow.co/targeting-sync/?environment=production';$cf.ajax({type:"GET",url:targeting_sync_url,data:payload,dataType:"JSONP",timeout:5000,success:function(data,status,xhr){app.visitors.targeting_sync_status[integration_type_key]=true;convertflow.person.data[integration_type_key]=convertflow.person.data[integration_type_key]||{};convertflow.person.data[integration_type_key]['last_sync']=app.helpers.timeNow();convertflow.person.last_requested=undefined;if(data&&$cf.isEmptyObject(data.contact)==false){var targeting_data=Object.assign({},data);if(payload.contact_id){targeting_data['id']=payload.contact_id;}
app.visitors.storeTargetingData(integration_type_key,targeting_data);Object.keys(data).forEach(function(integration_data_key){if(integration_data_key=='contact'){Object.keys(data[integration_data_key]).forEach(function(contact_attribute){if(!convertflow.person[contact_attribute]){if(contact_attribute=='email'){convertflow.identify({email:data[integration_data_key]['email'],override:true})}
convertflow.person[contact_attribute]=data[integration_data_key][contact_attribute];}});}
if(integration_data_key!=='contact'){convertflow.person.data[integration_type_key][integration_data_key]=data[integration_data_key];}})}
convertflow.person.visit_already_stored=true;if(!Object.values(app.visitors.targeting_sync_status).includes(false)&&Object.values(app.visitors.enrichment_status).includes('in progress')==false){app.visitors.initialize(convertflow.person);}},error:function(XMLHttpRequest,textStatus,errorThrown){console.log(integration_type_key+' timed out!')
app.visitors.targeting_sync_status[integration_type_key]=true;app.visitors.initialize(convertflow.person);}});}}
app.visitors.storeTargetingData=function(integration_type,response){var targeting_data=response;if(targeting_data.contact){delete targeting_data.contact;}
var payload={visitor_token:app.visitors.uid(),targeting_data:JSON.stringify(targeting_data),integration_type:integration_type}
$cf.ajax({type:"POST",url:app.api_visitors+app.visitors.uid()+'/targeting_data',data:payload,dataType:"json",success:function(data,status,xhr){convertflow.person.last_requested=$cf.now();}});}
app.visitors.trackingUIDs=function(){$cf(window).on("load",function(){setTimeout(function(){var tracking_ids={}
if(Object.keys(tracking_ids).length!==0){var endpoint=app.api_visitors+app.visitors.uid()+"/uids";$cf.ajax({type:"POST",url:endpoint,data:{visitor_token:app.visitors.uid(),uids:tracking_ids},dataType:"json"});}},1000)})}
app.visitors.trackSubmits=function(){if(window.convertflow&&convertflow.app.website.form_tracking=='true'&&app.website.data["contact-processing"]!=="false"&&($cf.isEmptyObject(convertflow.app.website.conditions)||app.campaigns.checkConditions(convertflow.app.website.conditions)==true)){$cf(document).on("submit","form",function(e){var form=e.target;if($cf(form).hasClass('new_contact')==false){var fields={firstname:'name',first_name:'name',lastname:'last_name',last_name:'last_name',email:'email',Email:'email',phone:'phone',website:'url'}
var submission={}
$cf.each(fields,function(k,v){if(submission[v]==undefined){if($cf(form).find('input[type="'+k+'"]').length>0&&$cf(form).find('input[type="'+k+'"]').attr('type')!=='hidden'){submission[v]=$cf(form).find('input[type="'+k+'"]').val()}else if($cf(form).find('[name*="'+k+'"]').length>0&&$cf(form).find('[name*="'+k+'"]').attr('name')!=='authenticity_token'&&$cf(form).find('[name*="'+k+'"]').attr('type')!=='hidden'){submission[v]=$cf(form).find('[name*="'+k+'"]').val()}else if($cf(form).find('[id*="'+k+'"]').length>0&&$cf(form).find('[id*="'+k+'"]').attr('type')!=='hidden'){submission[v]=$cf(form).find('[id*="'+k+'"]').val()}else if($cf(form).find('[placeholder*="'+k+'"]').length>0&&$cf(form).find('[placeholder*="'+k+'"]').attr('type')!=='hidden'){submission[v]=$cf(form).find('[placeholder*="'+k+'"]').val()}}});var filter=/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/;if(submission['email']!==undefined&&filter.test(submission['email'])){convertflow.person.email=submission['email'];submission['source_url']=app.helpers.cleanURL(window.location.href);var event={event_type:'Submission',visitor_token:app.visitors.uid(),website_id:app.website.id,url:app.helpers.cleanURL(window.location.href),data:submission}
$cf.ajax({type:"GET",url:app.api_events,data:{event:event,cf2:true},dataType:"JSONP"});if(app.localstorage){app.helpers.compressAndStore(app.local_person,convertflow.person);}}}});}}
app.visitors.fireEvent=function(event_type,payload){var cta;var event={}
if(payload.cta){cta=payload.cta;event.cta={name:payload.cta.name,cta_type:payload.cta.cta_type,id:payload.cta.id}}
if(payload.variant){event.variant=payload.variant.variation}
if(payload.step){event.step=payload.step.position}
if(payload.element){event.element=payload.element.element_type
if(payload.element.element_type=='button'){event['button_text']=$cf(payload.element.html).text();};if(payload.element.element_type=='form'){event['button_text']=$cf(".new_contact[data-element-id='"+payload.element.id+"']").find('.cf-form-button .cf-button').first().text();};if(payload.element.element_type=='survey'){var field_object=payload.element.fields[Object.keys(payload.element.fields)[0]];if(field_object.slug){event['button_text']=payload.fields[field_object.slug];}};}
if(payload.fields){event.fields=payload.fields}
$cf(document).trigger(event_type,[event]);try{window.dispatchEvent(new CustomEvent(event_type,{detail:event}));}catch(error){var evt=document.createEvent("CustomEvent");evt.initCustomEvent(event_type,undefined,undefined,event);window.dispatchEvent(evt);};if(typeof window.analytics=='object'&&typeof analytics.track=='function'){var integration=$cf.map(app.website.integrations,function(integration){if(integration.integration_type=='Segment')return integration})[0];if(integration){var segment_event;var segment_properties={};if(event_type=='cfView'){var segment_event='CTA Viewed';}
if(event_type=='cfSubmit'&&payload.element&&payload.element.element_type=='form'){var segment_event='CTA Form Submitted';}
if(event_type=='cfSubmit'&&payload.element&&payload.element.element_type=='survey'){var segment_event='CTA Survey Submitted';}
if(event_type=='cfConversion'&&payload.element&&payload.element.element_type=='button'){var segment_event='CTA Button Clicked';}
if(event_type=='cfCompletion'){var segment_event='CTA Completed';}
if(event_type=='cfClose'){var segment_event='CTA Closed';}
if(event_type=='cfAddToCart'){var segment_event='Add To Cart';}
if(payload.cta){segment_properties['cta_name']=payload.cta.name;segment_properties['cta_type']=payload.cta.cta_type;segment_properties['cta_id']=payload.cta.id;}
if(payload.variant){segment_properties['cta_variant']=payload.variant.variation;}
if(payload.step){segment_properties['cta_step']=payload.step.position;}
if(payload.element){segment_properties['element']=payload.element.element_type;if(payload.element.element_type=='button'){segment_properties['button_text']=$cf(payload.element.html).text();};if(payload.element.element_type=='form'){segment_properties['button_text']=$cf(".new_contact[data-element-id='"+payload.element.id+"']").find('.cf-form-button .cf-button').first().text();};if(payload.element.element_type=='survey'){var field_object=payload.element.fields[Object.keys(payload.element.fields)[0]];if(field_object.slug){segment_properties['button_text']=payload.fields[field_object.slug];}};}
if(segment_event&&$cf.isEmptyObject(segment_properties)==false){analytics.track(segment_event,segment_properties);}
if(event_type=='cfSubmit'&&payload.fields){var segment_traits={};var officialFields=['email','name','last_name','phone','url','company_name','company_title','city','state','zip_code','country','address','privacy_consent','marketing_consent','sms_consent'];var traitMap={'email':'email','name':'firstName','last_name':'lastName','phone':'phone','url':'website','company_title':'title','privacy_consent':'privacy_consent','marketing_consent':'marketing_consent','sms_consent':'sms_consent'};$cf.each(traitMap,function(k,v){if(payload.fields[k]){segment_traits[v]=payload.fields[k];}});$cf.each(payload.fields,function(k,v){if($cf.inArray(k,officialFields)==-1){var formatted_key=k.replace(/-/g,'_').replace(/‚Äì/g,'_').replace(/ /g,'_');segment_traits[formatted_key]=v;}});var locationTraits={};if(payload.fields.city)locationTraits['city']=payload.fields.city;if(payload.fields.state)locationTraits['state']=payload.fields.state;if(payload.fields.zip_code)locationTraits['postalCode']=payload.fields.zip_code;if(payload.fields.country)locationTraits['country']=payload.fields.country;if(payload.fields.address)locationTraits['street']=payload.fields.address;if($cf.isEmptyObject(locationTraits)==false)segment_traits['address']=locationTraits;var companyTraits={};if(payload.fields.company_name)companyTraits['name']=payload.fields.company_name;if($cf.isEmptyObject(companyTraits)==false)segment_traits['company']=companyTraits;analytics.identify(segment_traits);};}};var google_analytics_category=app.website.data['google-analytics-category']?app.website.data['google-analytics-category']:'ConvertFlow';var event_names={'cfView':'View','cfConversion':'Conversion','cfCompletion':'Completion','cfClose':'Close','cfAddToCart':'Add To Cart'}
var name=""
if(cta){if(cta.cta_type=='inline'){name=name+'Embedded ‚Äì '}else{var capitalized=cta.cta_type.charAt(0).toUpperCase()+cta.cta_type.slice(1)
name=name+capitalized+' ('+cta.id+')'+' ‚Äì ';}}
if(cta.name!==undefined&&cta.name!==""){name=name+cta.name;}else{name=name+'Cta '+cta.id}
if(payload.variant){name=name+' (Variant '+payload.variant.variation.toUpperCase()+')';if(payload.step){name=name+' ‚Äì Step '+payload.step.position;}}
if(app.website.data['google-analytics-track']!=='false'){if(window.gtag!==undefined&&!app.website.data['google-analytics-tracking-id']&&event_names[event_type]!==undefined){var ga_event={'event_category':google_analytics_category,'event_label':name}
if(event_type=='cfView'){ga_event['non_interaction']=true}
gtag('event',event_names[event_type],ga_event);}else if(window.ga!==undefined&&window.ga.getAll!==undefined&&event_names[event_type]!==undefined){var ga_event={'hitType':'event','eventCategory':google_analytics_category,'eventAction':event_names[event_type],'eventLabel':name}
if(['cfView','cfClose'].includes(event_type)){ga_event['nonInteraction']=true}
$cf.each(ga.getAll(),function(index,tracker){var trackingId=tracker.get('trackingId');if(trackingId&&!ga_event[trackingId]&&(!app.website.data['google-analytics-tracking-id']||app.website.data['google-analytics-tracking-id']==trackingId)){ga(tracker.get('name')+'.send',ga_event);ga_event[trackingId]=true;}})}}
if(app.website.data['google-analytics-data-layer']=='true'&&event_names[event_type]!==undefined){var ga_event={'event':google_analytics_category,'eventAction':event_names[event_type],'eventLabel':name}
if(['cfView','cfClose'].includes(event_type)){ga_event['nonInteraction']=true}
event['event']=event_type;event['ga_event']=ga_event;if(payload.element&&payload.element.options['confirmation-type']=='redirect'&&payload.element.options['redirect-url']){event['redirect_url']=app.helpers.formatRedirectUrl(payload.element.options['redirect-url']);}
if(app.website.data['google-analytics-data-layer-variable']&&window[app.website.data['google-analytics-data-layer-variable']]){var dataLayerObject=window[app.website.data['google-analytics-data-layer-variable']];try{dataLayerObject.push(event);}catch(e){}}else{window.dataLayer=window.dataLayer||[];dataLayer.push(event);}}
if(event_type=='cfSubmit'&&convertflow.person.email&&$cf('script[src*="klaviyo"]').length>0){var _learnq=_learnq||[];_learnq.push(['identify',{'$email':convertflow.person.email}]);}}
app.admin.initialize=function(website){if(window.convertflow.person&&(convertflow.person.logged_in+'')=='true'||app.helpers.getCookie('cf_'+app.website.id+'_logged_in')=='true'){app.helpers.setCookie('cf_'+app.website.id+'_logged_in','true',60*24*60);if(document.readyState==='interactive'||document.readyState==='complete'){app.admin.load(website);}else{$cf(document).on('ready',function(){app.admin.load(website);})}}}
app.admin.load=function(website){if(website.adminWidgetLoaded!==true){website.adminWidgetLoaded=true;$cf.ajax({type:"GET",url:app.interface_root+"admin",dataType:"JSONP",success:function(data){$cf('#cfTestStart').remove();$cf('#cfTestWidget').remove();$cf('body').append(data.html);$cf(document).on('cfTestReady',function(){cfTest38306(website);});}})}}
app.api.identify=function(data){var emailTest=/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/;var emailPresent=data.email!==undefined&&((convertflow.person!==undefined&&convertflow.person.email==undefined)||(data.override==true&&data.email!==convertflow.person.email))&&emailTest.test(data.email);var phoneTest=/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/im;var phonePresent=data.phone!==undefined&&((convertflow.person!==undefined&&convertflow.person.phone==undefined)||(data.override==true&&data.phone!==convertflow.person.phone))&&phoneTest.test(data.phone);if(emailPresent==true||phonePresent==true){var payload={contact:{website_id:app.website.id,visitor_token:app.visitors.uid()}}
if(emailPresent){payload.contact.email=data.email;}
if(phonePresent){payload.contact.phone=data.phone;}
if(app.website.data["contact-processing"]!=="false"){$cf.ajax({type:"GET",url:app.api_contacts,dataType:"JSONP",data:payload,success:function(response){}});}else{console.log('ConvertFlow: Contact PII processing disabled');}
if(app.localstorage){if(emailPresent){convertflow.person['email']=data.email;}
if(phonePresent){convertflow.person['phone']=data.phone;}
app.helpers.compressAndStore(app.local_person,convertflow.person);if(window.convertflow.readyFired==true){app.ctas.resetCTAs();app.campaigns.initialize(app.website);}}}}
app.api.load=function(payload){var cta_id;if(typeof payload=='object'&&payload.cta_id){cta_id=payload.cta_id;}else if(typeof payload!=='object'&&app.helpers.isNumeric(payload)){cta_id=payload;};if($cf('#cta'+cta_id).length==0){var ctaDiv=document.createElement('div');$cf(ctaDiv).attr('id','cta'+cta_id);$cf(ctaDiv).attr('cta-id',cta_id);$cf(ctaDiv).css('display','none');$cf(ctaDiv).addClass('convertflow-cta');if(app.website.ctas[cta_id]!==undefined){$cf(ctaDiv).addClass('cf-'+app.website.ctas[cta_id].cta_type);}
app.ctas.load(cta_id,payload.campaign,ctaDiv,payload.callback);}}
app.api.trigger=function(payload){var cta_id;if(typeof payload=='object'&&payload.cta_id){cta_id=payload.cta_id;}else if(typeof payload!=='object'&&app.helpers.isNumeric(payload)){cta_id=payload;};$cf(document).trigger('trigger_CTA_'+cta_id);if(payload.step){var cta=convertflow.ctas[cta_id];var embed=$cf('#cta'+cta_id);if(cta&&embed){var variant=Object.values(cta.variants).filter(function(variant){if(variant.winner==true){return variant;}})[0];if(variant){var step=Object.values(variant.steps).filter(function(step){if(step.position+''==payload.step+''){return step;}})[0];if(step){app.ctas.performConfirmationActionStep({embed:embed,cta:cta,variant:variant,step_override:step.id});}}}};}
app.api.start=function(){app.ctas.resetCTAs();app.visitors.trackEvent(app.visitors.visitEvent());app.campaigns.initialize(app.website);}
app.api.close=function(payload){var cta_ids=[];if(typeof payload=='object'&&payload.cta_id){cta_ids.push(payload.cta_id);}else{$cf('.cf-overlay:visible, .cf-hook:visible, .cf-bar:visible, .cf-two-tap:visible').each(function(i,cta_div){var cta_div_id=$cf(cta_div).attr('data-cta-id')||$cf(cta_div).attr('id');if(cta_div_id){var cta_id=cta_div_id.replace('cta','');cta_ids.push(cta_id);}});}
cta_ids.forEach(function(cta_id){var cta=convertflow.ctas[cta_id];if(cta){var embed=$cf('#cta'+cta_id);if(cta&&embed){var variant=Object.values(cta.variants).filter(function(variant){if(variant.winner==true){return variant;}})[0];if(variant){var track=payload&&payload.track?payload.track:false;app.ctas.close(cta,variant,embed,track);$cf('.cf-two-tap[data-cta-id='+cta.id+'], .cf-prehook-popup.cta'+cta.id).removeClass('slide-up').hide();}}}});}
app.helpers.domain=function(){var parts=location.hostname.split('.');if(parts.length>2&&(parts[1]!=='com'&&parts[1]!=='co'&&parts[1]!=='ac'&&parts[1]!=='org')&&['convertflowpages','myshopify','herokuapp','github','ghost','webflow','lpages','wpenginepowered','mybigcommerce','netlify'].includes(parts[1])==false){var subdomain=parts.shift();var domain=parts.join('.');}else{var domain=location.hostname;}
return domain}
app.helpers.page=function(){return window.location.pathname;}
app.helpers.timeNow=function(){var date=new Date();return date.toISOString();}
app.helpers.IE=function(){var ms_ie=false;var ua=window.navigator.userAgent;var old_ie=ua.indexOf('MSIE ');var new_ie=ua.indexOf('Trident/');var edge=ua.indexOf('Edge/');if((old_ie>-1)||(new_ie>-1)||(edge>-1)){var ms_ie=true;}
return ms_ie;}
app.helpers.setCookie=function(name,value,ttl){var expires="";var cookieDomain="";if(ttl){var date=new Date();date.setTime(date.getTime()+(ttl*60*1000));expires="; expires="+date.toGMTString();}
if(app.helpers.domain()){cookieDomain="; domain="+app.helpers.domain();}
document.cookie=name+"="+escape(value)+expires+cookieDomain+"; path=/";}
app.helpers.deleteCookie=function(name){if(name&&app.helpers.domain()){var cookieDomain="; domain="+app.helpers.domain();document.cookie=name+"="+cookieDomain+"; path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;";}}
app.helpers.getCookie=function(name){var re=new RegExp(name+"=([^;]+)");var value=re.exec(document.cookie);return(value!=null)?unescape(value[1]):undefined;}
app.helpers.getParameterByName=function(name){var name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var results=null;var response=null;try{var regex=new RegExp("[\\?&]"+name+"=([^&#]*)");results=regex.exec(location.search);if(results!==null){response=app.helpers.decodeURIComponentSafe(results[1].replace(/\+/g," "));};}catch(e){};if(results===null){response='';};return response;}
app.helpers.isInArray=function(value,array){return array.indexOf(value)>-1;}
app.helpers.decodeURIComponentSafe=function(uri,mod){var out=new String(),arr,i=0,l,x;typeof mod==="undefined"?mod=0:0;arr=uri.split(/(%(?:d0|d1)%.{2})/);for(l=arr.length;i<l;i++){try{x=decodeURIComponent(arr[i]);}catch(e){x=mod?arr[i].replace(/%(?!\d+)/g,'%25'):arr[i];}
out+=x;}
return out;}
app.helpers.getQueryString=function(){var search=location.search.substring(1);var data={}
if(search!==""){$cf.each(search.split('&'),function(i,parameter){if(parameter.indexOf('=')>-1){var param_array=parameter.split('=')
var key=param_array[0]
var value=param_array[1]
data[key]=app.helpers.decodeURIComponentSafe(value)}})}
return data}
app.helpers.canStringify=function(){return typeof(JSON)!=="undefined"&&typeof(JSON.stringify)!=="undefined";}
app.helpers.cleanURL=function(url){var cleaned_url=url.split(/[?#]/)[0].replace(/^https?\:\/\//,"").replace(/^www./,"").replace(/\s+/g,'').replace(/\/$/,"");return cleaned_url;}
app.helpers.cachedScript=function(url,options){options=$cf.extend(options||{},{dataType:"script",cache:true,async:true,url:url});return $cf.ajax(options);}
app.helpers.capitalizeFirstLetter=function(string){return string.charAt(0).toUpperCase()+string.slice(1);}
app.helpers.personMap=function(){return{name:'firstname',last_name:'lastname',email:'email',phone:'phone',website:'website',company_name:'company_name',company_title:'company_title',city:'city',country:'country',address:'address',state:'state',zip_code:'zipcode'}}
app.localstorage=(function(){if(app.helpers.IE()==false){try{return!!localStorage.getItem;}catch(exception){return false;}}else{return false;}}());var localStorageSpace=function(){if(app.localstorage){var allStrings='';for(var key in window.localStorage){if(window.localStorage.hasOwnProperty(key)){allStrings+=window.localStorage[key];}}
var value=allStrings?3+((allStrings.length*16)/(8*1024)):'0'
return value;}else{return '0'}};if(app.localstorage){var localCompress=function(){function o(o,r){if(!t[o]){t[o]={};for(var n=0;n<o.length;n++)t[o][o.charAt(n)]=n}return t[o][r]}var r=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",t={},i={compressToBase64:function(o){if(null==o)return"";var r=i._compress(o,6,function(o){return n.charAt(o)});switch(r.length%4){default:case 0:return r;case 1:return r+"===";case 2:return r+"==";case 3:return r+"="}},decompressFromBase64:function(r){return null==r?"":""==r?null:i._decompress(r.length,32,function(e){return o(n,r.charAt(e))})},compressToUTF16:function(o){return null==o?"":i._compress(o,15,function(o){return r(o+32)})+" "},decompressFromUTF16:function(o){return null==o?"":""==o?null:i._decompress(o.length,16384,function(r){return o.charCodeAt(r)-32})},compressToUint8Array:function(o){for(var r=i.compress(o),n=new Uint8Array(2*r.length),e=0,t=r.length;t>e;e++){var s=r.charCodeAt(e);n[2*e]=s>>>8,n[2*e+1]=s%256}return n},decompressFromUint8Array:function(o){if(null===o||void 0===o)return i.decompress(o);for(var n=new Array(o.length/2),e=0,t=n.length;t>e;e++)n[e]=256*o[2*e]+o[2*e+1];var s=[];return n.forEach(function(o){s.push(r(o))}),i.decompress(s.join(""))},compressToEncodedURIComponent:function(o){return null==o?"":i._compress(o,6,function(o){return e.charAt(o)})},decompressFromEncodedURIComponent:function(r){return null==r?"":""==r?null:(r=r.replace(/ /g,"+"),i._decompress(r.length,32,function(n){return o(e,r.charAt(n))}))},compress:function(o){return i._compress(o,16,function(o){return r(o)})},_compress:function(o,r,n){if(null==o)return"";var e,t,i,s={},p={},u="",c="",a="",l=2,f=3,h=2,d=[],m=0,v=0;for(i=0;i<o.length;i+=1)if(u=o.charAt(i),Object.prototype.hasOwnProperty.call(s,u)||(s[u]=f++,p[u]=!0),c=a+u,Object.prototype.hasOwnProperty.call(s,c))a=c;else{if(Object.prototype.hasOwnProperty.call(p,a)){if(a.charCodeAt(0)<256){for(e=0;h>e;e++)m<<=1,v==r-1?(v=0,d.push(n(m)),m=0):v++;for(t=a.charCodeAt(0),e=0;8>e;e++)m=m<<1|1&t,v==r-1?(v=0,d.push(n(m)),m=0):v++,t>>=1}else{for(t=1,e=0;h>e;e++)m=m<<1|t,v==r-1?(v=0,d.push(n(m)),m=0):v++,t=0;for(t=a.charCodeAt(0),e=0;16>e;e++)m=m<<1|1&t,v==r-1?(v=0,d.push(n(m)),m=0):v++,t>>=1}l--,0==l&&(l=Math.pow(2,h),h++),delete p[a]}else for(t=s[a],e=0;h>e;e++)m=m<<1|1&t,v==r-1?(v=0,d.push(n(m)),m=0):v++,t>>=1;l--,0==l&&(l=Math.pow(2,h),h++),s[c]=f++,a=String(u)}if(""!==a){if(Object.prototype.hasOwnProperty.call(p,a)){if(a.charCodeAt(0)<256){for(e=0;h>e;e++)m<<=1,v==r-1?(v=0,d.push(n(m)),m=0):v++;for(t=a.charCodeAt(0),e=0;8>e;e++)m=m<<1|1&t,v==r-1?(v=0,d.push(n(m)),m=0):v++,t>>=1}else{for(t=1,e=0;h>e;e++)m=m<<1|t,v==r-1?(v=0,d.push(n(m)),m=0):v++,t=0;for(t=a.charCodeAt(0),e=0;16>e;e++)m=m<<1|1&t,v==r-1?(v=0,d.push(n(m)),m=0):v++,t>>=1}l--,0==l&&(l=Math.pow(2,h),h++),delete p[a]}else for(t=s[a],e=0;h>e;e++)m=m<<1|1&t,v==r-1?(v=0,d.push(n(m)),m=0):v++,t>>=1;l--,0==l&&(l=Math.pow(2,h),h++)}for(t=2,e=0;h>e;e++)m=m<<1|1&t,v==r-1?(v=0,d.push(n(m)),m=0):v++,t>>=1;for(;;){if(m<<=1,v==r-1){d.push(n(m));break}v++}return d.join("")},decompress:function(o){return null==o?"":""==o?null:i._decompress(o.length,32768,function(r){return o.charCodeAt(r)})},_decompress:function(o,n,e){var t,i,s,p,u,c,a,l,f=[],h=4,d=4,m=3,v="",w=[],A={val:e(0),position:n,index:1};for(i=0;3>i;i+=1)f[i]=i;for(p=0,c=Math.pow(2,2),a=1;a!=c;)u=A.val&A.position,A.position>>=1,0==A.position&&(A.position=n,A.val=e(A.index++)),p|=(u>0?1:0)*a,a<<=1;switch(t=p){case 0:for(p=0,c=Math.pow(2,8),a=1;a!=c;)u=A.val&A.position,A.position>>=1,0==A.position&&(A.position=n,A.val=e(A.index++)),p|=(u>0?1:0)*a,a<<=1;l=r(p);break;case 1:for(p=0,c=Math.pow(2,16),a=1;a!=c;)u=A.val&A.position,A.position>>=1,0==A.position&&(A.position=n,A.val=e(A.index++)),p|=(u>0?1:0)*a,a<<=1;l=r(p);break;case 2:return""}for(f[3]=l,s=l,w.push(l);;){if(A.index>o)return"";for(p=0,c=Math.pow(2,m),a=1;a!=c;)u=A.val&A.position,A.position>>=1,0==A.position&&(A.position=n,A.val=e(A.index++)),p|=(u>0?1:0)*a,a<<=1;switch(l=p){case 0:for(p=0,c=Math.pow(2,8),a=1;a!=c;)u=A.val&A.position,A.position>>=1,0==A.position&&(A.position=n,A.val=e(A.index++)),p|=(u>0?1:0)*a,a<<=1;f[d++]=r(p),l=d-1,h--;break;case 1:for(p=0,c=Math.pow(2,16),a=1;a!=c;)u=A.val&A.position,A.position>>=1,0==A.position&&(A.position=n,A.val=e(A.index++)),p|=(u>0?1:0)*a,a<<=1;f[d++]=r(p),l=d-1,h--;break;case 2:return w.join("")}if(0==h&&(h=Math.pow(2,m),m++),f[l])v=f[l];else{if(l!==d)return null;v=s+s.charAt(0)}w.push(v),f[d++]=s+v.charAt(0),h--,s=v,0==h&&(h=Math.pow(2,m),m++)}}};return i}();"function"==typeof define&&define.amd?define(function(){return localCompress}):"undefined"!=typeof module&&null!=module&&(module.exports=localCompress);}
app.helpers.compressAndStore=function(key,object){if(app.localstorage){if(localStorageSpace()<1000){var timestamp=Date.now();object.last_updated=timestamp;app.helpers.setCookie(app.visitors.localstorage_last_update,timestamp);return localStorage.setItem(key,localCompress.compress(JSON.stringify(object)));}else{return null;}}else{return null}}
app.helpers.decompressAndGet=function(key){if(app.localstorage){var data=localStorage.getItem(key)
if(data!==null){try{return JSON.parse(localCompress.decompress(data));}catch(e){return null}}else{return null}}else{return null}}
if(app.helpers.IE()==true&&(typeof window.CustomEvent==="function")==false){function CustomEvent(event,params){params=params||{bubbles:false,cancelable:false,detail:undefined};var evt=document.createEvent('CustomEvent');evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail);return evt;}
CustomEvent.prototype=window.Event.prototype;window.CustomEvent=CustomEvent;}
app.helpers.parseDate=function(date){if(date.indexOf('T')==-1){var lastIndex=date.lastIndexOf(" ");if(date.indexOf('0000')>-1){var formatted_date=date.substring(0,lastIndex).replace(' ','T')+'Z';}else{var timezone=date.split(' ').pop()
var formatted_date=date.substring(0,lastIndex).replace(' ','T');var len=timezone.length;var formatted_timezone=timezone.substring(0,len-2)+":"+timezone.substring(len-2);var formatted_date=formatted_date+formatted_timezone;}
var parsed_date=Date.parse(formatted_date);}else{var formatted_date=date;var parsed_date=Date.parse(formatted_date);}
return parsed_date;}
app.helpers.nestedGet=function(obj,path,defaultValue){var paths=String.prototype.split.call(path,/[,[\].]+?/).filter(Boolean)
var result=paths.reduce(function(res,key){if(res!==null&&res!==undefined){return res[key]}else{return res}},obj);return(result===undefined||result===obj)?defaultValue:result;}
app.helpers.loadScript=function(scriptUrl,callback,async){if(document.characterSet!=='UTF-8'||async==false){var script=document.createElement('script');script.type="text/javascript";script.src=scriptUrl;script.charset="UTF-8";script.onload=callback;if(async==false){document.head.appendChild(script);}else{script.async=true;document.body.appendChild(script);}}else{app.helpers.cachedScript(scriptUrl).done(callback);}}
app.helpers.removeTags=function(str){if((str===null)||(str===''))
return false;else
str=str.toString();return str.replace(/(<([^>]+)>)/ig,'');};app.helpers.isNumeric=function(str){if(typeof str!="number"&&typeof str!="string")return false;return!isNaN(str)&&!isNaN(parseFloat(str));}
app.helpers.formatRedirectUrl=function(redirect_url){if(redirect_url.indexOf('http')==-1&&redirect_url.charAt(0)!=='#'&&redirect_url.indexOf('mailto:')==-1){redirect_url='http://'+redirect_url;}
if(redirect_url.indexOf("&amp;")>-1){redirect_url=redirect_url.replace(new RegExp('&amp;','g'),'&');}
if(window.ga!==undefined&&window.ga.getAll!==undefined&&window.gaplugins!==undefined&&app.website.data['google-analytics-cross-domain']=='true'&&redirect_url.charAt(0)!=='#'&&redirect_url.indexOf('mailto:')==-1){var trackerToUse;$cf.each(ga.getAll(),function(index,tracker){var trackingId=tracker.get('trackingId');if(trackingId&&(!trackerToUse||app.website.data['google-analytics-tracking-id']==trackingId)){trackerToUse=tracker;}});if(trackerToUse!==undefined){redirect_url=(new window.gaplugins.Linker(trackerToUse)).decorate(redirect_url);}}
return redirect_url;}
app.helpers.onVisible=(domElement,callback)=>{new IntersectionObserver((entries,observer)=>{entries.forEach(entry=>{if(entry.intersectionRatio>0){callback(domElement);observer.disconnect();}});}).observe(domElement);}
app.helpers.plugins=function(){/*!jQuery Validation Plugin - v1.15.0 - 2/24/2016 http://jqueryvalidation.org/ Copyright (c) 2016 J√∂rn Zaefferer; Licensed MIT*/!function(a){a($cf)}(function(a){a.extend(a.fn,{validate:function(b){if(!this.length)return void(b&&b.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing."));var c=a.data(this[0],"validator");return c?c:(this.attr("novalidate","novalidate"),c=new a.validator(b,this[0]),a.data(this[0],"validator",c),c.settings.onsubmit&&(this.on("click.validate",":submit",function(b){c.settings.submitHandler&&(c.submitButton=b.target),a(this).hasClass("cancel")&&(c.cancelSubmit=!0),void 0!==a(this).attr("formnovalidate")&&(c.cancelSubmit=!0)}),this.on("submit.validate",function(b){function d(){var d,e;return c.settings.submitHandler?(c.submitButton&&(d=a("<input type='hidden'/>").attr("name",c.submitButton.name).val(a(c.submitButton).val()).appendTo(c.currentForm)),e=c.settings.submitHandler.call(c,c.currentForm,b),c.submitButton&&d.remove(),void 0!==e?e:!1):!0}return c.settings.debug&&b.preventDefault(),c.cancelSubmit?(c.cancelSubmit=!1,d()):c.form()?c.pendingRequest?(c.formSubmitted=!0,!1):d():(c.focusInvalid(),!1)})),c)},valid:function(){var b,c,d;return a(this[0]).is("form")?b=this.validate().form():(d=[],b=!0,c=a(this[0].form).validate(),this.each(function(){b=c.element(this)&&b,b||(d=d.concat(c.errorList))}),c.errorList=d),b},rules:function(b,c){if(this.length){var d,e,f,g,h,i,j=this[0];if(b)switch(d=a.data(j.form,"validator").settings,e=d.rules,f=a.validator.staticRules(j),b){case"add":a.extend(f,a.validator.normalizeRule(c)),delete f.messages,e[j.name]=f,c.messages&&(d.messages[j.name]=a.extend(d.messages[j.name],c.messages));break;case"remove":return c?(i={},a.each(c.split(/\s/),function(b,c){i[c]=f[c],delete f[c],"required"===c&&a(j).removeAttr("aria-required")}),i):(delete e[j.name],f)}return g=a.validator.normalizeRules(a.extend({},a.validator.classRules(j),a.validator.attributeRules(j),a.validator.dataRules(j),a.validator.staticRules(j)),j),g.required&&(h=g.required,delete g.required,g=a.extend({required:h},g),a(j).attr("aria-required","true")),g.remote&&(h=g.remote,delete g.remote,g=a.extend(g,{remote:h})),g}}}),a.extend(a.expr[":"],{blank:function(b){return!a.trim(""+a(b).val())},filled:function(b){var c=a(b).val();return null!==c&&!!a.trim(""+c)},unchecked:function(b){return!a(b).prop("checked")}}),a.validator=function(b,c){this.settings=a.extend(!0,{},a.validator.defaults,b),this.currentForm=c,this.init()},a.validator.format=function(b,c){return 1===arguments.length?function(){var c=a.makeArray(arguments);return c.unshift(b),a.validator.format.apply(this,c)}:void 0===c?b:(arguments.length>2&&c.constructor!==Array&&(c=a.makeArray(arguments).slice(1)),c.constructor!==Array&&(c=[c]),a.each(c,function(a,c){b=b.replace(new RegExp("\\{"+a+"\\}","g"),function(){return c})}),b)},a.extend(a.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",pendingClass:"pending",validClass:"valid",errorElement:"label",focusCleanup:!1,focusInvalid:!0,errorContainer:a([]),errorLabelContainer:a([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(a){this.lastActive=a,this.settings.focusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,a,this.settings.errorClass,this.settings.validClass),this.hideThese(this.errorsFor(a)))},onfocusout:function(a){this.checkable(a)||!(a.name in this.submitted)&&this.optional(a)||this.element(a)},onkeyup:function(b,c){var d=[16,17,18,20,35,36,37,38,39,40,45,144,225];9===c.which&&""===this.elementValue(b)||-1!==a.inArray(c.keyCode,d)||(b.name in this.submitted||b.name in this.invalid)&&this.element(b)},onclick:function(a){a.name in this.submitted?this.element(a):a.parentNode.name in this.submitted&&this.element(a.parentNode)},highlight:function(b,c,d){"radio"===b.type?this.findByName(b.name).addClass(c).removeClass(d):a(b).addClass(c).removeClass(d)},unhighlight:function(b,c,d){"radio"===b.type?this.findByName(b.name).removeClass(c).addClass(d):a(b).removeClass(c).addClass(d)}},setDefaults:function(b){a.extend(a.validator.defaults,b)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date ( ISO ).",number:"Please enter a valid number.",digits:"Please enter only digits.",equalTo:"Please enter the same value again.",maxlength:a.validator.format("Please enter no more than {0} characters."),minlength:a.validator.format("Please enter at least {0} characters."),rangelength:a.validator.format("Please enter a value between {0} and {1} characters long."),range:a.validator.format("Please enter a value between {0} and {1}."),max:a.validator.format("Please enter a value less than or equal to {0}."),min:a.validator.format("Please enter a value greater than or equal to {0}."),step:a.validator.format("Please enter a multiple of {0}.")},autoCreateRanges:!1,prototype:{init:function(){function b(b){var c=a.data(this.form,"validator"),d="on"+b.type.replace(/^validate/,""),e=c.settings;e[d]&&!a(this).is(e.ignore)&&e[d].call(c,this,b)}this.labelContainer=a(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||a(this.currentForm),this.containers=a(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var c,d=this.groups={};a.each(this.settings.groups,function(b,c){"string"==typeof c&&(c=c.split(/\s/)),a.each(c,function(a,c){d[c]=b})}),c=this.settings.rules,a.each(c,function(b,d){c[b]=a.validator.normalizeRule(d)}),a(this.currentForm).on("focusin.validate focusout.validate keyup.validate",":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'], [type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], [type='radio'], [type='checkbox'], [contenteditable]",b).on("click.validate","select, option, [type='radio'], [type='checkbox']",b),this.settings.invalidHandler&&a(this.currentForm).on("invalid-form.validate",this.settings.invalidHandler),a(this.currentForm).find("[required], [data-rule-required], .required").attr("aria-required","true")},form:function(){return this.checkForm(),a.extend(this.submitted,this.errorMap),this.invalid=a.extend({},this.errorMap),this.valid()||a(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var a=0,b=this.currentElements=this.elements();b[a];a++)this.check(b[a]);return this.valid()},element:function(b){var c,d,e=this.clean(b),f=this.validationTargetFor(e),g=this,h=!0;return void 0===f?delete this.invalid[e.name]:(this.prepareElement(f),this.currentElements=a(f),d=this.groups[f.name],d&&a.each(this.groups,function(a,b){b===d&&a!==f.name&&(e=g.validationTargetFor(g.clean(g.findByName(a))),e&&e.name in g.invalid&&(g.currentElements.push(e),h=h&&g.check(e)))}),c=this.check(f)!==!1,h=h&&c,c?this.invalid[f.name]=!1:this.invalid[f.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),a(b).attr("aria-invalid",!c)),h},showErrors:function(b){if(b){var c=this;a.extend(this.errorMap,b),this.errorList=a.map(this.errorMap,function(a,b){return{message:a,element:c.findByName(b)[0]}}),this.successList=a.grep(this.successList,function(a){return!(a.name in b)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){a.fn.resetForm&&a(this.currentForm).resetForm(),this.invalid={},this.submitted={},this.prepareForm(),this.hideErrors();var b=this.elements().removeData("previousValue").removeAttr("aria-invalid");this.resetElements(b)},resetElements:function(a){var b;if(this.settings.unhighlight)for(b=0;a[b];b++)this.settings.unhighlight.call(this,a[b],this.settings.errorClass,""),this.findByName(a[b].name).removeClass(this.settings.validClass);else a.removeClass(this.settings.errorClass).removeClass(this.settings.validClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(a){var b,c=0;for(b in a)a[b]&&c++;return c},hideErrors:function(){this.hideThese(this.toHide)},hideThese:function(a){a.not(this.containers).text(""),this.addWrapper(a).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{a(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(b){}},findLastActive:function(){var b=this.lastActive;return b&&1===a.grep(this.errorList,function(a){return a.element.name===b.name}).length&&b},elements:function(){var b=this,c={};return a(this.currentForm).find("input, select, textarea, [contenteditable]").not(":submit, :reset, :image, :disabled").not(this.settings.ignore).filter(function(){var d=this.name||a(this).attr("name");return!d&&b.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.hasAttribute("contenteditable")&&(this.form=a(this).closest("form")[0]),d in c||!b.objectLength(a(this).rules())?!1:(c[d]=!0,!0)})},clean:function(b){return a(b)[0]},errors:function(){var b=this.settings.errorClass.split(" ").join(".");return a(this.settings.errorElement+"."+b,this.errorContext)},resetInternals:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=a([]),this.toHide=a([])},reset:function(){this.resetInternals(),this.currentElements=a([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(a){this.reset(),this.toHide=this.errorsFor(a)},elementValue:function(b){var c,d,e=a(b),f=b.type;return"radio"===f||"checkbox"===f?this.findByName(b.name).filter(":checked").val():"number"===f&&"undefined"!=typeof b.validity?b.validity.badInput?"NaN":e.val():(c=b.hasAttribute("contenteditable")?e.text():e.val(),"file"===f?"C:\\fakepath\\"===c.substr(0,12)?c.substr(12):(d=c.lastIndexOf("/"),d>=0?c.substr(d+1):(d=c.lastIndexOf("\\"),d>=0?c.substr(d+1):c)):"string"==typeof c?c.replace(/\r/g,""):c)},check:function(b){b=this.validationTargetFor(this.clean(b));var c,d,e,f=a(b).rules(),g=a.map(f,function(a,b){return b}).length,h=!1,i=this.elementValue(b);if("function"==typeof f.normalizer){if(i=f.normalizer.call(b,i),"string"!=typeof i)throw new TypeError("The normalizer should return a string value.");delete f.normalizer}for(d in f){e={method:d,parameters:f[d]};try{if(c=a.validator.methods[d].call(this,i,b,e.parameters),"dependency-mismatch"===c&&1===g){h=!0;continue}if(h=!1,"pending"===c)return void(this.toHide=this.toHide.not(this.errorsFor(b)));if(!c)return this.formatAndAdd(b,e),!1}catch(j){throw this.settings.debug&&window.console&&console.log("Exception occurred when checking element "+b.id+", check the '"+e.method+"' method.",j),j instanceof TypeError&&(j.message+=".  Exception occurred when checking element "+b.id+", check the '"+e.method+"' method."),j}}if(!h)return this.objectLength(f)&&this.successList.push(b),!0},customDataMessage:function(b,c){return a(b).data("msg"+c.charAt(0).toUpperCase()+c.substring(1).toLowerCase())||a(b).data("msg")},customMessage:function(a,b){var c=this.settings.messages[a];return c&&(c.constructor===String?c:c[b])},findDefined:function(){for(var a=0;a<arguments.length;a++)if(void 0!==arguments[a])return arguments[a]},defaultMessage:function(b,c){var d=this.findDefined(this.customMessage(b.name,c.method),this.customDataMessage(b,c.method),!this.settings.ignoreTitle&&b.title||void 0,a.validator.messages[c.method],"<strong>Warning: No message defined for "+b.name+"</strong>"),e=/\$?\{(\d+)\}/g;return"function"==typeof d?d=d.call(this,c.parameters,b):e.test(d)&&(d=a.validator.format(d.replace(e,"{$1}"),c.parameters)),d},formatAndAdd:function(a,b){var c=this.defaultMessage(a,b);this.errorList.push({message:c,element:a,method:b.method}),this.errorMap[a.name]=c,this.submitted[a.name]=c},addWrapper:function(a){return this.settings.wrapper&&(a=a.add(a.parent(this.settings.wrapper))),a},defaultShowErrors:function(){var a,b,c;for(a=0;this.errorList[a];a++)c=this.errorList[a],this.settings.highlight&&this.settings.highlight.call(this,c.element,this.settings.errorClass,this.settings.validClass),this.showLabel(c.element,c.message);if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(a=0;this.successList[a];a++)this.showLabel(this.successList[a]);if(this.settings.unhighlight)for(a=0,b=this.validElements();b[a];a++)this.settings.unhighlight.call(this,b[a],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return a(this.errorList).map(function(){return this.element})},showLabel:function(b,c){var d,e,f,g,h=this.errorsFor(b),i=this.idOrName(b),j=a(b).attr("aria-describedby");h.length?(h.removeClass(this.settings.validClass).addClass(this.settings.errorClass),h.html(c)):(h=a("<"+this.settings.errorElement+">").attr("id",i+"-error").addClass(this.settings.errorClass).html(c||""),d=h,this.settings.wrapper&&(d=h.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.length?this.labelContainer.append(d):this.settings.errorPlacement?this.settings.errorPlacement(d,a(b)):d.insertAfter(b),h.is("label")?h.attr("for",i):0===h.parents("label[for='"+this.escapeCssMeta(i)+"']").length&&(f=h.attr("id"),j?j.match(new RegExp("\\b"+this.escapeCssMeta(f)+"\\b"))||(j+=" "+f):j=f,a(b).attr("aria-describedby",j),e=this.groups[b.name],e&&(g=this,a.each(g.groups,function(b,c){c===e&&a("[name='"+g.escapeCssMeta(b)+"']",g.currentForm).attr("aria-describedby",h.attr("id"))})))),!c&&this.settings.success&&(h.text(""),"string"==typeof this.settings.success?h.addClass(this.settings.success):this.settings.success(h,b)),this.toShow=this.toShow.add(h)},errorsFor:function(b){var c=this.escapeCssMeta(this.idOrName(b)),d=a(b).attr("aria-describedby"),e="label[for='"+c+"'], label[for='"+c+"'] *";return d&&(e=e+", #"+this.escapeCssMeta(d).replace(/\s+/g,", #")),this.errors().filter(e)},escapeCssMeta:function(a){return a.replace(/([\\!"#$%&'()*+,./:;<=>?@\[\]^`{|}~])/g,"\\$1")},idOrName:function(a){return this.groups[a.name]||(this.checkable(a)?a.name:a.id||a.name)},validationTargetFor:function(b){return this.checkable(b)&&(b=this.findByName(b.name)),a(b).not(this.settings.ignore)[0]},checkable:function(a){return/radio|checkbox/i.test(a.type)},findByName:function(b){return a(this.currentForm).find("[name='"+this.escapeCssMeta(b)+"']")},getLength:function(b,c){switch(c.nodeName.toLowerCase()){case"select":return a("option:selected",c).length;case"input":if(this.checkable(c))return this.findByName(c.name).filter(":checked").length}return b.length},depend:function(a,b){return this.dependTypes[typeof a]?this.dependTypes[typeof a](a,b):!0},dependTypes:{"boolean":function(a){return a},string:function(b,c){return!!a(b,c.form).length},"function":function(a,b){return a(b)}},optional:function(b){var c=this.elementValue(b);return!a.validator.methods.required.call(this,c,b)&&"dependency-mismatch"},startRequest:function(b){this.pending[b.name]||(this.pendingRequest++,a(b).addClass(this.settings.pendingClass),this.pending[b.name]=!0)},stopRequest:function(b,c){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[b.name],a(b).removeClass(this.settings.pendingClass),c&&0===this.pendingRequest&&this.formSubmitted&&this.form()?(a(this.currentForm).submit(),this.formSubmitted=!1):!c&&0===this.pendingRequest&&this.formSubmitted&&(a(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(b,c){return a.data(b,"previousValue")||a.data(b,"previousValue",{old:null,valid:!0,message:this.defaultMessage(b,{method:c})})},destroy:function(){this.resetForm(),a(this.currentForm).off(".validate").removeData("validator").find(".validate-equalTo-blur").off(".validate-equalTo").removeClass("validate-equalTo-blur")}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(b,c){b.constructor===String?this.classRuleSettings[b]=c:a.extend(this.classRuleSettings,b)},classRules:function(b){var c={},d=a(b).attr("class");return d&&a.each(d.split(" "),function(){this in a.validator.classRuleSettings&&a.extend(c,a.validator.classRuleSettings[this])}),c},normalizeAttributeRule:function(a,b,c,d){/min|max|step/.test(c)&&(null===b||/number|range|text/.test(b))&&(d=Number(d),isNaN(d)&&(d=void 0)),d||0===d?a[c]=d:b===c&&"range"!==b&&(a[c]=!0)},attributeRules:function(b){var c,d,e={},f=a(b),g=b.getAttribute("type");for(c in a.validator.methods)"required"===c?(d=b.getAttribute(c),""===d&&(d=!0),d=!!d):d=f.attr(c),this.normalizeAttributeRule(e,g,c,d);return e.maxlength&&/-1|2147483647|524288/.test(e.maxlength)&&delete e.maxlength,e},dataRules:function(b){var c,d,e={},f=a(b),g=b.getAttribute("type");for(c in a.validator.methods)d=f.data("rule"+c.charAt(0).toUpperCase()+c.substring(1).toLowerCase()),this.normalizeAttributeRule(e,g,c,d);return e},staticRules:function(b){var c={},d=a.data(b.form,"validator");return d.settings.rules&&(c=a.validator.normalizeRule(d.settings.rules[b.name])||{}),c},normalizeRules:function(b,c){return a.each(b,function(d,e){if(e===!1)return void delete b[d];if(e.param||e.depends){var f=!0;switch(typeof e.depends){case"string":f=!!a(e.depends,c.form).length;break;case"function":f=e.depends.call(c,c)}f?b[d]=void 0!==e.param?e.param:!0:(a.data(c.form,"validator").resetElements(a(c)),delete b[d])}}),a.each(b,function(d,e){b[d]=a.isFunction(e)&&"normalizer"!==d?e(c):e}),a.each(["minlength","maxlength"],function(){b[this]&&(b[this]=Number(b[this]))}),a.each(["rangelength","range"],function(){var c;b[this]&&(a.isArray(b[this])?b[this]=[Number(b[this][0]),Number(b[this][1])]:"string"==typeof b[this]&&(c=b[this].replace(/[\[\]]/g,"").split(/[\s,]+/),b[this]=[Number(c[0]),Number(c[1])]))}),a.validator.autoCreateRanges&&(null!=b.min&&null!=b.max&&(b.range=[b.min,b.max],delete b.min,delete b.max),null!=b.minlength&&null!=b.maxlength&&(b.rangelength=[b.minlength,b.maxlength],delete b.minlength,delete b.maxlength)),b},normalizeRule:function(b){if("string"==typeof b){var c={};a.each(b.split(/\s/),function(){c[this]=!0}),b=c}return b},addMethod:function(b,c,d){a.validator.methods[b]=c,a.validator.messages[b]=void 0!==d?d:a.validator.messages[b],c.length<3&&a.validator.addClassRules(b,a.validator.normalizeRule(b))},methods:{required:function(b,c,d){if(!this.depend(d,c))return"dependency-mismatch";if("select"===c.nodeName.toLowerCase()){var e=a(c).val();return e&&e.length>0}return this.checkable(c)?this.getLength(b,c)>0:b.length>0},email:function(a,b){return this.optional(b)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(a)},url:function(a,b){return this.optional(b)||/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(a)},date:function(a,b){return this.optional(b)||!/Invalid|NaN/.test(new Date(a).toString())},dateISO:function(a,b){return this.optional(b)||/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(a)},number:function(a,b){return this.optional(b)||/^(?:-?\d+|-?\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(a)},digits:function(a,b){return this.optional(b)||/^\d+$/.test(a)},minlength:function(b,c,d){var e=a.isArray(b)?b.length:this.getLength(b,c);return this.optional(c)||e>=d},maxlength:function(b,c,d){var e=a.isArray(b)?b.length:this.getLength(b,c);return this.optional(c)||d>=e},rangelength:function(b,c,d){var e=a.isArray(b)?b.length:this.getLength(b,c);return this.optional(c)||e>=d[0]&&e<=d[1]},min:function(a,b,c){return this.optional(b)||a>=c},max:function(a,b,c){return this.optional(b)||c>=a},range:function(a,b,c){return this.optional(b)||a>=c[0]&&a<=c[1]},step:function(b,c,d){var e=a(c).attr("type"),f="Step attribute on input type "+e+" is not supported.",g=["text","number","range"],h=new RegExp("\\b"+e+"\\b"),i=e&&!h.test(g.join());if(i)throw new Error(f);return this.optional(c)||b%d===0},equalTo:function(b,c,d){var e=a(d);return this.settings.onfocusout&&e.not(".validate-equalTo-blur").length&&e.addClass("validate-equalTo-blur").on("blur.validate-equalTo",function(){a(c).valid()}),b===e.val()},remote:function(b,c,d,e){if(this.optional(c))return"dependency-mismatch";e="string"==typeof e&&e||"remote";var f,g,h,i=this.previousValue(c,e);return this.settings.messages[c.name]||(this.settings.messages[c.name]={}),i.originalMessage=i.originalMessage||this.settings.messages[c.name][e],this.settings.messages[c.name][e]=i.message,d="string"==typeof d&&{url:d}||d,h=a.param(a.extend({data:b},d.data)),i.old===h?i.valid:(i.old=h,f=this,this.startRequest(c),g={},g[c.name]=b,a.ajax(a.extend(!0,{mode:"abort",port:"validate"+c.name,dataType:"json",data:g,context:f.currentForm,success:function(a){var d,g,h,j=a===!0||"true"===a;f.settings.messages[c.name][e]=i.originalMessage,j?(h=f.formSubmitted,f.resetInternals(),f.toHide=f.errorsFor(c),f.formSubmitted=h,f.successList.push(c),f.invalid[c.name]=!1,f.showErrors()):(d={},g=a||f.defaultMessage(c,{method:e,parameters:b}),d[c.name]=i.message=g,f.invalid[c.name]=!0,f.showErrors(d)),i.valid=j,f.stopRequest(c,j)}},d)),"pending")}}});var b,c={};a.ajaxPrefilter?a.ajaxPrefilter(function(a,b,d){var e=a.port;"abort"===a.mode&&(c[e]&&c[e].abort(),c[e]=d)}):(b=a.ajax,a.ajax=function(d){var e=("mode"in d?d:a.ajaxSettings).mode,f=("port"in d?d:a.ajaxSettings).port;return"abort"===e?(c[f]&&c[f].abort(),c[f]=b.apply(this,arguments),c[f]):b.apply(this,arguments)})});}
window.convertflow=app.api;delete app.api;window.convertflow.app=app;window.convertflow.fonts={};function initialize(app){if(app.timed==true){console.time('Person load');console.time('CTA inject');}
if(app.live==true){app.ctas.locallystored()
if(app.helpers.getCookie(app.visitors.uid_cookie)==undefined){app.visitors.create();app.ctas.findSnippets();}else{var localperson=app.helpers.decompressAndGet(app.local_person)
if(app.visitors.canUseLocal(localperson)==false){app.visitors.get();}else{app.visitors.initialize(localperson);}}
app.visitors.trackingUIDs();app.visitors.trackSubmits()}else{var person={}
person['id']=null;person['name']=null;person['created_at']=null;person['updated_at']=null;person['email']=null;person['user_id']=null;person['owner_id']=null;person['phone']=null;person['city']=null;person['leadhook_id']=null;person['contactable_id']=null;person['contactable_type']=null;person['avatar_file_name']=null;person['avatar_content_type']=null;person['avatar_file_size']=null;person['avatar_updated_at']=null;person['avatar_url']=null;person['company_name']=null;person['company_title']=null;person['url']=null;person['state']=null;person['twitter_url']=null;person['facebook_url']=null;person['linkedin_url']=null;person['twitter_followers']=null;person['twitter_following']=null;person['lead_value']=null;person['customer_ltv']=null;person['twitter_handle']=null;person['last_name']=null;person['address']=null;person['zip_code']=null;person['country']=null;person['view']=null;person['website_id']=null;person['source_url']=null;person['company_id']=null;person['pref_id']=null;person['visitor_token']=null;person['flow_id']=null;person['stage_id']=null;person['extra']=null;person['broadcast_id']=null;person['goal_id']=null;person['opportunity_id']=null;person['recent_event']=null;person['bio']=null;person['referral_id']=null;person['person_id']=null;person['intercom_id']=null;person['variant_id']=null;person['drip_id']=null;person['data']=null;person['inf_id']=null;person['first_visit']=null;person['referral_source']=null;person['utm_source']=null;person['utm_medium']=null;person['utm_campaign']=null;person['utm_term']=null;person['utm_content']=null;person['privacy_consent']=null;person['marketing_consent']=null;person['ip_address']=null;person['queued_actions']=null;person['latest_score']=null;person['sms_consent']=null;person.visitor_token="51730cc1-e3ab-475f-9844-4193d9ff316d"
person.website_id=app.website.id
person.data={}
person.extra={}
window.convertflow.person=person;app.ctas.findSnippets();}}
function usejQuery(app){if(window.jQuery!==undefined){window.prevjQuery=window.jQuery;}
var scriptLoadHandler=function(){$cf=jQuery.noConflict(true);if(window.prevjQuery!==undefined){jQuery=window.prevjQuery}
initialize(app);}
if(window.jQuery===undefined||window.jQuery.ajax==undefined||window.jQuery.validator!==undefined||(jQuery.fn.jquery!==undefined&&parseInt(jQuery.fn.jquery.split('.')[0])<2)){var script_tag=document.createElement('script');script_tag.setAttribute("type","text/javascript");script_tag.setAttribute("src","https://ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js");if(script_tag.readyState){script_tag.onreadystatechange=function(){if(this.readyState=='complete'||this.readyState=='loaded'){scriptLoadHandler()}};}else{script_tag.onload=function(){scriptLoadHandler()}}
(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(script_tag);}else{$cf=window.jQuery;if(location.search.indexOf('cfTime=true')>-1){console.log('Existing jQuery is '+$cf.fn.jquery)}
initialize(app);}}
var bots="(googlebot\/|Googlebot-Mobile|bot|pingdom|Googlebot-Image|Google favicon|Mediapartners-Google|bingbot|slurp|java|wget|curl|Commons-HttpClient|Python-urllib|libwww|httpunit|nutch|phpcrawl|msnbot|jyxobot|FAST-WebCrawler|FAST Enterprise Crawler|biglotron|teoma|convera|seekbot|gigablast|exabot|ngbot|ia_archiver|GingerCrawler|webmon |httrack|webcrawler|grub.org|UsineNouvelleCrawler|antibot|netresearchserver|speedy|fluffy|bibnum.bnf|findlink|msrbot|panscient|yacybot|AISearchBot|IOI|ips-agent|tagoobot|MJ12bot|dotbot|woriobot|yanga|buzzbot|mlbot|yandexbot|purebot|Linguee Bot|Voyager|CyberPatrol|voilabot|baiduspider|citeseerxbot|spbot|twengabot|postrank|turnitinbot|scribdbot|page2rss|sitebot|linkdex|Adidxbot|blekkobot|ezooms|dotbot|Mail.RU_Bot|discobot|heritrix|findthatfile|europarchive.org|NerdByNature.Bot|sistrix crawler|ahrefsbot|Aboundex|domaincrawler|wbsearchbot|summify|ccbot|edisterbot|seznambot|ec2linkfinder|gslfbot|aihitbot|intelium_bot|facebookexternalhit|yeti|RetrevoPageAnalyzer|lb-spider|sogou|lssbot|careerbot|wotbox|wocbot|ichiro|DuckDuckBot|lssrocketcrawler|drupact|webcompanycrawler|acoonbot|openindexspider|gnam gnam spider|web-archive-net.com.bot|backlinkcrawler|coccoc|integromedb|content crawler spider|toplistbot|seokicks-robot|it2media-domain-crawler|ip-web-crawler.com|siteexplorer.info|elisabot|proximic|changedetection|blexbot|arabot|WeSEE:Search|niki-bot|CrystalSemanticsBot|rogerbot|360Spider|psbot|InterfaxScanBot|Lipperhey SEO Service|CC Metadata Scaper|g00g1e.net|GrapeshotCrawler|urlappendbot|brainobot|fr-crawler|binlar|SimpleCrawler|Livelapbot|Twitterbot|cXensebot|smtbot|bnf.fr_bot|A6-Indexer|ADmantX|Facebot|Twitterbot|OrangeBot|memorybot|AdvBot|MegaIndex|SemanticScholarBot|ltx71|nerdybot|xovibot|BUbiNG|Qwantify|archive.org_bot|Applebot|TweetmemeBot|crawler4j|findxbot|SemrushBot|yoozBot|lipperhey|y!j-asr|Domain Re-Animator Bot|AddThis)";var re=new RegExp(bots,'i');if(re.test(navigator.userAgent)==false||document.body.classList.contains('convertflow-page')){usejQuery(app)}})();}else{console.log('Uh oh! ConvertFlow script is already installed.')}